<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!--
      The Deriving a Domain Specific Language for purely functional 3D Graphics
 parameters will be replaced with the
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>Purely functional scene graphs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="content/style.css" />
    <script src="content/tips.js" type="text/javascript"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <div class="container">
        <div class="row" style="margin-top:30px">
            <div class="span1"></div>
            <div class="span10" id="main">
                <h1>Deriving a Domain Specific Language for purely functional 3D Graphics</h1>
<p>In this paper, we present a simple yet powerful Domain Specific Language
for working with three-dimensional scene data.
We start by specifying the domain types <a href="http://fsharpforfunandprofit.com/ddd/">(see DDD)</a> of a example problem, and extend the
domain model with functionality for rendering and interaction.</p>
<p>Our first example is a little drawing tool which allows users to draw polygons on a vertical plane
centered in the 3D scene.
Later, we will extend the program with functionality for picking and translating objects
by using a Maya-style 3D controller.</p>
<p>Note that this document is written as F# literate script, i.e. this document is both, the
paper and the implementation ;)</p>
<h2>Domain Driven Design</h2>
<p>Let us start with the domain model for polygons:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Base</span> <span class="c">// Aardvark.Base provides vector types</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="t">Polygon</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>Thus, a polygon is simple a immutable list of vectors (vertices). Next,
we need a way to model polygons which are not yet fully defined. A mouse click extends
these, and eventually they are finalized.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="t">OpenPolygon</span> <span class="o">=</span> {
    <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">finishedPoints</span>  <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span> <span class="c">// points already added to the polygon</span>
    <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="i">cursor</span>         <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 10)" onmouseover="showTip(event, 'fs9', 10)" class="t">Option</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span> <span class="c">(* the last point of the polygon which can still be modified. </span>
<span class="c">            Note that the last point of the polygon might be undefined (represented as None). *)</span>
}
</code></pre></td>
</tr>
</table>
<p>The Domain Model can be completed using a list of polygons in the scene, as well as one open polygon
the user is currently working on.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs10', 11)" onmouseover="showTip(event, 'fs10', 11)" class="t">DrawingModel</span> <span class="o">=</span> {
    <span onmouseout="hideTip(event, 'fs11', 12)" onmouseover="showTip(event, 'fs11', 12)" class="i">finished</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 13)" onmouseover="showTip(event, 'fs5', 13)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs4', 14)" onmouseover="showTip(event, 'fs4', 14)" class="t">Polygon</span><span class="o">&gt;</span>
    <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">working</span>  <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 16)" onmouseover="showTip(event, 'fs9', 16)" class="t">Option</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs6', 17)" onmouseover="showTip(event, 'fs6', 17)" class="t">OpenPolygon</span><span class="o">&gt;</span>
}
</code></pre></td>
</tr>
</table>
<h2>Creating a visual representation for our model</h2>
<p>The simplest way of specifying a visual representation for data is by specifying a function which
maps from data to graphics.
Since we aim for rendering our graphics using graphics hardware (OpenGL), we don't directly compute pixels for
the data, but we map our domain model to an explicit description of the scene, which we can render
efficiently. Aardvark uses the typical description of this sort, a scene graph with geometric primitives at the leaves.</p>
<p>Let us start with the type describing 3D entities in the scene:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="t">Primitive</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="p">Sphere</span>      <span class="k">of</span> <span class="i">center</span> <span class="o">:</span> <span class="i">V3d</span> <span class="o">*</span> <span class="i">radius</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="t">float</span>
    | <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="p">Cone</span>        <span class="k">of</span> <span class="i">center</span> <span class="o">:</span> <span class="i">V3d</span> <span class="o">*</span> <span class="i">dir</span> <span class="o">:</span> <span class="i">V3d</span> <span class="o">*</span> <span class="i">height</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs15', 22)" onmouseover="showTip(event, 'fs15', 22)" class="t">float</span> <span class="o">*</span> <span class="i">radius</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="t">float</span>
    | <span onmouseout="hideTip(event, 'fs17', 24)" onmouseover="showTip(event, 'fs17', 24)" class="p">Cylinder</span>    <span class="k">of</span> <span class="i">center</span> <span class="o">:</span> <span class="i">V3d</span> <span class="o">*</span> <span class="i">dir</span> <span class="o">:</span> <span class="i">V3d</span> <span class="o">*</span> <span class="i">height</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs15', 25)" onmouseover="showTip(event, 'fs15', 25)" class="t">float</span> <span class="o">*</span> <span class="i">radius</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="t">float</span>
    | <span onmouseout="hideTip(event, 'fs18', 27)" onmouseover="showTip(event, 'fs18', 27)" class="p">Quad</span>        <span class="k">of</span> <span class="i">Quad3d</span> 
</code></pre></td>
</tr>
</table>
<p>This type allows us to specify individual entities in a 3D scene.</p>
<p>Next let us extend the API to support many entities being packed together.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs19', 28)" onmouseover="showTip(event, 'fs19', 28)" class="t">Scene1</span> <span class="o">=</span> 
        | <span onmouseout="hideTip(event, 'fs20', 29)" onmouseover="showTip(event, 'fs20', 29)" class="p">Transform</span> <span class="k">of</span> <span class="i">Trafo3d</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs5', 30)" onmouseover="showTip(event, 'fs5', 30)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 31)" onmouseover="showTip(event, 'fs19', 31)" class="t">Scene1</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs21', 32)" onmouseover="showTip(event, 'fs21', 32)" class="p">Colored</span>   <span class="k">of</span> <span class="i">C4b</span>     <span class="o">*</span> <span onmouseout="hideTip(event, 'fs5', 33)" onmouseover="showTip(event, 'fs5', 33)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 34)" onmouseover="showTip(event, 'fs19', 34)" class="t">Scene1</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs22', 35)" onmouseover="showTip(event, 'fs22', 35)" class="p">Render</span>    <span class="k">of</span> <span onmouseout="hideTip(event, 'fs13', 36)" onmouseover="showTip(event, 'fs13', 36)" class="t">Primitive</span> 
        | <span onmouseout="hideTip(event, 'fs23', 37)" onmouseover="showTip(event, 'fs23', 37)" class="p">Group</span>     <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 38)" onmouseover="showTip(event, 'fs5', 38)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 39)" onmouseover="showTip(event, 'fs19', 39)" class="t">Scene1</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>This definition allows us to describe scenes.</p>
<p>An example:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 40)" onmouseover="showTip(event, 'fs24', 40)" class="i">scene</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs20', 41)" onmouseover="showTip(event, 'fs20', 41)" class="p">Transform</span> ( <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span>(<span class="n">10.0</span>,<span class="n">10.0</span>,<span class="n">10.0</span>), [
                  <span onmouseout="hideTip(event, 'fs22', 42)" onmouseover="showTip(event, 'fs22', 42)" class="p">Render</span> ( <span onmouseout="hideTip(event, 'fs14', 43)" onmouseover="showTip(event, 'fs14', 43)" class="p">Sphere</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>, <span class="n">1.0</span>))
                  <span onmouseout="hideTip(event, 'fs22', 44)" onmouseover="showTip(event, 'fs22', 44)" class="p">Render</span> ( <span onmouseout="hideTip(event, 'fs14', 45)" onmouseover="showTip(event, 'fs14', 45)" class="p">Sphere</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>, <span class="n">0.1</span>))
               ])
</code></pre></td>
</tr>
</table>
<p>Which represents the following scene:</p>
<p>[todo image]</p>
<p>Thus, a visual representation for our polygon-sketching scene can be implemented as follows:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// curried version of Colored in order to nicely compose</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 46)" onmouseover="showTip(event, 'fs25', 46)" class="f">colored1</span> <span onmouseout="hideTip(event, 'fs26', 47)" onmouseover="showTip(event, 'fs26', 47)" class="i">c</span> <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs21', 49)" onmouseover="showTip(event, 'fs21', 49)" class="p">Colored</span>(<span onmouseout="hideTip(event, 'fs26', 50)" onmouseover="showTip(event, 'fs26', 50)" class="i">c</span>,<span onmouseout="hideTip(event, 'fs27', 51)" onmouseover="showTip(event, 'fs27', 51)" class="i">xs</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 52)" onmouseover="showTip(event, 'fs28', 52)" class="f">transformed1</span> <span onmouseout="hideTip(event, 'fs29', 53)" onmouseover="showTip(event, 'fs29', 53)" class="i">t</span> <span onmouseout="hideTip(event, 'fs30', 54)" onmouseover="showTip(event, 'fs30', 54)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs20', 55)" onmouseover="showTip(event, 'fs20', 55)" class="p">Transform</span>(<span onmouseout="hideTip(event, 'fs29', 56)" onmouseover="showTip(event, 'fs29', 56)" class="i">t</span>,[<span onmouseout="hideTip(event, 'fs30', 57)" onmouseover="showTip(event, 'fs30', 57)" class="i">x</span>])

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 58)" onmouseover="showTip(event, 'fs31', 58)" class="f">view1</span> (<span onmouseout="hideTip(event, 'fs32', 59)" onmouseover="showTip(event, 'fs32', 59)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs10', 60)" onmouseover="showTip(event, 'fs10', 60)" class="t">DrawingModel</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs19', 61)" onmouseover="showTip(event, 'fs19', 61)" class="t">Scene1</span> <span class="o">=</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 62)" onmouseover="showTip(event, 'fs33', 62)" class="i">groundPlane</span> <span class="o">=</span>
        [ <span onmouseout="hideTip(event, 'fs18', 63)" onmouseover="showTip(event, 'fs18', 63)" class="p">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs22', 64)" onmouseover="showTip(event, 'fs22', 64)" class="p">Render</span> ] 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 65)" onmouseover="showTip(event, 'fs25', 65)" class="f">colored1</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Gray</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 66)" onmouseover="showTip(event, 'fs34', 66)" class="f">viewPolygon</span> (<span onmouseout="hideTip(event, 'fs35', 67)" onmouseover="showTip(event, 'fs35', 67)" class="i">p</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 68)" onmouseover="showTip(event, 'fs5', 68)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs19', 69)" onmouseover="showTip(event, 'fs19', 69)" class="t">Scene1</span> <span class="o">=</span> 
        [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs36', 70)" onmouseover="showTip(event, 'fs36', 70)" class="i">edge</span> <span class="k">in</span> <span class="i">Polygon3d</span>(<span onmouseout="hideTip(event, 'fs35', 71)" onmouseover="showTip(event, 'fs35', 71)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 72)" onmouseover="showTip(event, 'fs37', 72)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 73)" onmouseover="showTip(event, 'fs38', 73)" class="i">toSeq</span>)<span class="o">.</span><span class="i">EdgeLines</span> <span class="k">do</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 74)" onmouseover="showTip(event, 'fs39', 74)" class="i">v</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs36', 75)" onmouseover="showTip(event, 'fs36', 75)" class="i">edge</span><span class="o">.</span><span class="i">P1</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs36', 76)" onmouseover="showTip(event, 'fs36', 76)" class="i">edge</span><span class="o">.</span><span class="i">P0</span>
            <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs17', 77)" onmouseover="showTip(event, 'fs17', 77)" class="p">Cylinder</span>(<span onmouseout="hideTip(event, 'fs36', 78)" onmouseover="showTip(event, 'fs36', 78)" class="i">edge</span><span class="o">.</span><span class="i">P0</span>,<span onmouseout="hideTip(event, 'fs39', 79)" onmouseover="showTip(event, 'fs39', 79)" class="i">v</span><span class="o">.</span><span class="i">Normalized</span>,<span onmouseout="hideTip(event, 'fs39', 80)" onmouseover="showTip(event, 'fs39', 80)" class="i">v</span><span class="o">.</span><span class="i">Length</span>,<span class="n">0.03</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs22', 81)" onmouseover="showTip(event, 'fs22', 81)" class="p">Render</span>
        ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs23', 82)" onmouseover="showTip(event, 'fs23', 82)" class="p">Group</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 83)" onmouseover="showTip(event, 'fs40', 83)" class="i">openPolygon</span> <span class="o">=</span>   
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs32', 84)" onmouseover="showTip(event, 'fs32', 84)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 85)" onmouseover="showTip(event, 'fs12', 85)" class="i">working</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs41', 86)" onmouseover="showTip(event, 'fs41', 86)" class="p">None</span>   <span class="k">-&gt;</span> [] <span class="c">// no open polygon -&gt; just return empty list)</span>
            | <span onmouseout="hideTip(event, 'fs42', 87)" onmouseover="showTip(event, 'fs42', 87)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 88)" onmouseover="showTip(event, 'fs43', 88)" class="i">v</span> <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs34', 89)" onmouseover="showTip(event, 'fs34', 89)" class="f">viewPolygon</span> <span onmouseout="hideTip(event, 'fs43', 90)" onmouseover="showTip(event, 'fs43', 90)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 91)" onmouseover="showTip(event, 'fs7', 91)" class="i">finishedPoints</span>]

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 92)" onmouseover="showTip(event, 'fs44', 92)" class="i">cursor</span> <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs32', 93)" onmouseover="showTip(event, 'fs32', 93)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 94)" onmouseover="showTip(event, 'fs12', 94)" class="i">working</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs42', 95)" onmouseover="showTip(event, 'fs42', 95)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 96)" onmouseover="showTip(event, 'fs43', 96)" class="i">v</span> <span class="k">when</span> <span onmouseout="hideTip(event, 'fs9', 97)" onmouseover="showTip(event, 'fs9', 97)" class="t">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 98)" onmouseover="showTip(event, 'fs45', 98)" class="f">isSome</span> <span onmouseout="hideTip(event, 'fs43', 99)" onmouseover="showTip(event, 'fs43', 99)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 100)" onmouseover="showTip(event, 'fs8', 100)" class="i">cursor</span> <span class="k">-&gt;</span> 
                <span class="c">// if we have a last point (cursor)</span>
                [ [ <span onmouseout="hideTip(event, 'fs14', 101)" onmouseover="showTip(event, 'fs14', 101)" class="p">Sphere</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span class="n">0.1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs22', 102)" onmouseover="showTip(event, 'fs22', 102)" class="p">Render</span> ] 
                   <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 103)" onmouseover="showTip(event, 'fs25', 103)" class="f">colored1</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Red</span>
                   <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs28', 104)" onmouseover="showTip(event, 'fs28', 104)" class="f">transformed1</span> (<span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span>(<span onmouseout="hideTip(event, 'fs43', 105)" onmouseover="showTip(event, 'fs43', 105)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 106)" onmouseover="showTip(event, 'fs8', 106)" class="i">cursor</span><span class="o">.</span><span class="i">Value</span>))
                ]
            | _ <span class="k">-&gt;</span> [] <span class="c">// no working polygon or no cursor</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 107)" onmouseover="showTip(event, 'fs46', 107)" class="i">polygons</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs32', 108)" onmouseover="showTip(event, 'fs32', 108)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 109)" onmouseover="showTip(event, 'fs11', 109)" class="i">finished</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 110)" onmouseover="showTip(event, 'fs37', 110)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs47', 111)" onmouseover="showTip(event, 'fs47', 111)" class="f">map</span> <span onmouseout="hideTip(event, 'fs34', 112)" onmouseover="showTip(event, 'fs34', 112)" class="f">viewPolygon</span>

    <span onmouseout="hideTip(event, 'fs23', 113)" onmouseover="showTip(event, 'fs23', 113)" class="p">Group</span> [
        <span class="k">yield</span>  <span onmouseout="hideTip(event, 'fs33', 114)" onmouseover="showTip(event, 'fs33', 114)" class="i">groundPlane</span>
        <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs40', 115)" onmouseover="showTip(event, 'fs40', 115)" class="i">openPolygon</span>
        <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs44', 116)" onmouseover="showTip(event, 'fs44', 116)" class="i">cursor</span>
        <span class="k">yield!</span> <span onmouseout="hideTip(event, 'fs46', 117)" onmouseover="showTip(event, 'fs46', 117)" class="i">polygons</span>
    ]
</code></pre></td>
</tr>
</table>
<p>Altough the function is rather verbose F# (many let bindings can be inlined), it precisely captures
the semantics of the transformation.
Next, we would like to implement interaction techniques. The user usually wants to issue commands to the program and observe the resulting effects.</p>
<p>In order to model interactions cleanly, let us introduce a union type modeling all possible interactions.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs48', 118)" onmouseover="showTip(event, 'fs48', 118)" class="t">DrawCommand</span> <span class="o">=</span>
    | <span onmouseout="hideTip(event, 'fs49', 119)" onmouseover="showTip(event, 'fs49', 119)" class="p">ClosePolygon</span>
    | <span onmouseout="hideTip(event, 'fs50', 120)" onmouseover="showTip(event, 'fs50', 120)" class="p">AddPoint</span>   <span class="k">of</span> <span class="i">V3d</span>
    | <span onmouseout="hideTip(event, 'fs51', 121)" onmouseover="showTip(event, 'fs51', 121)" class="p">MoveCursor</span> <span class="k">of</span> <span class="i">V3d</span>
</code></pre></td>
</tr>
</table>
<p>Remember, our model is immutable. Therefore, adding a point to our model actually means computing a new model, which is the old model containing the new point.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 122)" onmouseover="showTip(event, 'fs52', 122)" class="f">updateDrawing</span> (<span onmouseout="hideTip(event, 'fs32', 123)" onmouseover="showTip(event, 'fs32', 123)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs10', 124)" onmouseover="showTip(event, 'fs10', 124)" class="t">DrawingModel</span>) (<span onmouseout="hideTip(event, 'fs53', 125)" onmouseover="showTip(event, 'fs53', 125)" class="i">cmd</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs48', 126)" onmouseover="showTip(event, 'fs48', 126)" class="t">DrawCommand</span>) <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs53', 127)" onmouseover="showTip(event, 'fs53', 127)" class="i">cmd</span> <span class="k">with</span>
        | <span onmouseout="hideTip(event, 'fs50', 128)" onmouseover="showTip(event, 'fs50', 128)" class="p">AddPoint</span> <span onmouseout="hideTip(event, 'fs54', 129)" onmouseover="showTip(event, 'fs54', 129)" class="i">p</span> <span class="k">-&gt;</span> <span class="c">// we want to add a point to our drawing model</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs32', 130)" onmouseover="showTip(event, 'fs32', 130)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 131)" onmouseover="showTip(event, 'fs12', 131)" class="i">working</span> <span class="k">with</span> <span class="c">// do we have a polygon we could add to point to?</span>
                | <span onmouseout="hideTip(event, 'fs42', 132)" onmouseover="showTip(event, 'fs42', 132)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 133)" onmouseover="showTip(event, 'fs43', 133)" class="i">v</span> <span class="k">-&gt;</span> <span class="c">// yes we have, create a new OpenPolygon with our new point added and update the model</span>
                    { <span onmouseout="hideTip(event, 'fs32', 134)" onmouseover="showTip(event, 'fs32', 134)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 135)" onmouseover="showTip(event, 'fs42', 135)" class="p">Some</span> { <span onmouseout="hideTip(event, 'fs43', 136)" onmouseover="showTip(event, 'fs43', 136)" class="i">v</span> <span class="k">with</span> <span class="i">finishedPoints</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs54', 137)" onmouseover="showTip(event, 'fs54', 137)" class="i">p</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs43', 138)" onmouseover="showTip(event, 'fs43', 138)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 139)" onmouseover="showTip(event, 'fs7', 139)" class="i">finishedPoints</span> }}
                | <span onmouseout="hideTip(event, 'fs41', 140)" onmouseover="showTip(event, 'fs41', 140)" class="p">None</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs32', 141)" onmouseover="showTip(event, 'fs32', 141)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 142)" onmouseover="showTip(event, 'fs42', 142)" class="p">Some</span> { <span class="i">finishedPoints</span> <span class="o">=</span> [ <span onmouseout="hideTip(event, 'fs54', 143)" onmouseover="showTip(event, 'fs54', 143)" class="i">p</span> ]; <span class="i">cursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 144)" onmouseover="showTip(event, 'fs41', 144)" class="p">None</span>;  }}
        | <span onmouseout="hideTip(event, 'fs49', 145)" onmouseover="showTip(event, 'fs49', 145)" class="p">ClosePolygon</span> <span class="k">-&gt;</span> 
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs32', 146)" onmouseover="showTip(event, 'fs32', 146)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 147)" onmouseover="showTip(event, 'fs12', 147)" class="i">working</span> <span class="k">with</span>
                | <span onmouseout="hideTip(event, 'fs41', 148)" onmouseover="showTip(event, 'fs41', 148)" class="p">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs32', 149)" onmouseover="showTip(event, 'fs32', 149)" class="i">m</span> <span class="c">// we have no polygon to close -&gt; identity. the updated model is the old model</span>
                | <span onmouseout="hideTip(event, 'fs42', 150)" onmouseover="showTip(event, 'fs42', 150)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs55', 151)" onmouseover="showTip(event, 'fs55', 151)" class="i">p</span> <span class="k">-&gt;</span> 
                    { <span onmouseout="hideTip(event, 'fs32', 152)" onmouseover="showTip(event, 'fs32', 152)" class="i">m</span> <span class="k">with</span> 
                        <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 153)" onmouseover="showTip(event, 'fs41', 153)" class="p">None</span> <span class="c">// close a polygon. there is no more open polygon ...</span>
                        <span class="i">finished</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs55', 154)" onmouseover="showTip(event, 'fs55', 154)" class="i">p</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 155)" onmouseover="showTip(event, 'fs7', 155)" class="i">finishedPoints</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs32', 156)" onmouseover="showTip(event, 'fs32', 156)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 157)" onmouseover="showTip(event, 'fs11', 157)" class="i">finished</span> <span class="c">// ... and the formerly opened polygon is now part of the finished polygons</span>
                    }
        | <span onmouseout="hideTip(event, 'fs51', 158)" onmouseover="showTip(event, 'fs51', 158)" class="p">MoveCursor</span> <span onmouseout="hideTip(event, 'fs54', 159)" onmouseover="showTip(event, 'fs54', 159)" class="i">p</span> <span class="k">-&gt;</span> <span class="c">// the last point of the current working polygon follows the mouse cursor</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs32', 160)" onmouseover="showTip(event, 'fs32', 160)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 161)" onmouseover="showTip(event, 'fs12', 161)" class="i">working</span> <span class="k">with</span> <span class="c">// check if we have a working polygon</span>
                | <span onmouseout="hideTip(event, 'fs41', 162)" onmouseover="showTip(event, 'fs41', 162)" class="p">None</span> <span class="k">-&gt;</span> 
                    <span class="c">// start a new open polygon with our current cursor set to mouse position</span>
                    { <span onmouseout="hideTip(event, 'fs32', 163)" onmouseover="showTip(event, 'fs32', 163)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 164)" onmouseover="showTip(event, 'fs42', 164)" class="p">Some</span> { <span class="i">finishedPoints</span> <span class="o">=</span> []; <span class="i">cursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 165)" onmouseover="showTip(event, 'fs42', 165)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs54', 166)" onmouseover="showTip(event, 'fs54', 166)" class="i">p</span> }}
                | <span onmouseout="hideTip(event, 'fs42', 167)" onmouseover="showTip(event, 'fs42', 167)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 168)" onmouseover="showTip(event, 'fs43', 168)" class="i">v</span> <span class="k">-&gt;</span> 
                    <span class="c">// override current cursor position</span>
                    { <span onmouseout="hideTip(event, 'fs32', 169)" onmouseover="showTip(event, 'fs32', 169)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 170)" onmouseover="showTip(event, 'fs42', 170)" class="p">Some</span> { <span onmouseout="hideTip(event, 'fs43', 171)" onmouseover="showTip(event, 'fs43', 171)" class="i">v</span> <span class="k">with</span> <span class="i">cursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 172)" onmouseover="showTip(event, 'fs42', 172)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs54', 173)" onmouseover="showTip(event, 'fs54', 173)" class="i">p</span> }}
</code></pre></td>
</tr>
</table>
<p>Again, the function precisely captures the semantics of our update commands.
Who generates these update commands?</p>
<p>ClosePolygon, for example, could be associated with a mouse click. This means that mouse clicks
must produce 3D positions. But a mouse click doesn't usually produce anything, so what can we do?
This is exactly the point where our clean API seems to get messy.</p>
<p>One common approach here is to define a picking manager which handles mouse events
and translates the events to domain specific data (such as 3D positions). However, the scope and responsibilities
of such a manager are often difficult to define, and an implementation using mutable/global state becomes chaotic.</p>
<p>In this work, we take a different approach inspired by the <a href="elm">Elm Architecture</a>.
The key insight is to perform operations exactly at the points where
all necessary information is at hand, or can be computed easily. Since we
already defined a DSL for specifying 3D scenes, the obvious choice is to
resolve our commands there! This leads to a clean seperation of concerns and encapsulation of state.</p>
<p>Let us take the expression which effectively creates the drawable 3D plane in our scene:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 174)" onmouseover="showTip(event, 'fs56', 174)" class="i">groundPlane</span> <span class="o">=</span>
    [ <span onmouseout="hideTip(event, 'fs18', 175)" onmouseover="showTip(event, 'fs18', 175)" class="p">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs22', 176)" onmouseover="showTip(event, 'fs22', 176)" class="p">Render</span> ] 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs25', 177)" onmouseover="showTip(event, 'fs25', 177)" class="f">colored1</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Gray</span>
</code></pre></td>
</tr>
</table>
<p>We have the domain model at hand, as well as specfic information such as 3D coordinates. In order to express pick operations here, we need to enrich our Scene representation with
pick operations.</p>
<p>Let us first define an API for specifying picks.
For our example, we need to handle clicks and mouse moves.
Since we want to work with 3D data, our events should be equipped with 3D coordinates:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 178)" onmouseover="showTip(event, 'fs2', 178)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 179)" onmouseover="showTip(event, 'fs57', 179)" class="i">Application</span> <span class="c">// Aardvark.Application provides helpers for working with user inputs</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs58', 180)" onmouseover="showTip(event, 'fs58', 180)" class="t">MouseEvent</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs59', 181)" onmouseover="showTip(event, 'fs59', 181)" class="p">Move</span> <span class="k">of</span> <span class="i">V3d</span> 
    | <span onmouseout="hideTip(event, 'fs60', 182)" onmouseover="showTip(event, 'fs60', 182)" class="p">Down</span> <span class="k">of</span> <span class="i">MouseButtons</span> <span class="o">*</span> <span class="i">V3d</span>
</code></pre></td>
</tr>
</table>
<p>Let us now define a type which describes the reaction of a mouse event in a generic manner. This means that
the produced command message is a type argument for our function type.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs61', 183)" onmouseover="showTip(event, 'fs61', 183)" class="t">PickOperation</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs58', 184)" onmouseover="showTip(event, 'fs58', 184)" class="t">MouseEvent</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs9', 185)" onmouseover="showTip(event, 'fs9', 185)" class="t">Option</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>This abstraction here leads the way to specifying message-agnostic 3D scenes.
As a consequence, our scene type now carries a type argument representing the type of message which
can be produced by the scene itself.</p>
<p>Additionally we equip our render constructor with the capability of producing pick commands.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// scene produces messages of type &#39;msg</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs62', 186)" onmouseover="showTip(event, 'fs62', 186)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span> <span class="o">=</span> 
        | <span onmouseout="hideTip(event, 'fs63', 187)" onmouseover="showTip(event, 'fs63', 187)" class="p">Transform</span> <span class="k">of</span> <span class="i">Trafo3d</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs64', 188)" onmouseover="showTip(event, 'fs64', 188)" class="t">seq</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs62', 189)" onmouseover="showTip(event, 'fs62', 189)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs65', 190)" onmouseover="showTip(event, 'fs65', 190)" class="p">Colored</span>   <span class="k">of</span> <span class="i">C4b</span>     <span class="o">*</span> <span onmouseout="hideTip(event, 'fs64', 191)" onmouseover="showTip(event, 'fs64', 191)" class="t">seq</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs62', 192)" onmouseover="showTip(event, 'fs62', 192)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs66', 193)" onmouseover="showTip(event, 'fs66', 193)" class="p">Render</span>    <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 194)" onmouseover="showTip(event, 'fs5', 194)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs61', 195)" onmouseover="showTip(event, 'fs61', 195)" class="t">PickOperation</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs13', 196)" onmouseover="showTip(event, 'fs13', 196)" class="t">Primitive</span> <span class="c">// new bits in here</span>
        | <span onmouseout="hideTip(event, 'fs67', 197)" onmouseover="showTip(event, 'fs67', 197)" class="p">Group</span>     <span class="k">of</span> <span onmouseout="hideTip(event, 'fs64', 198)" onmouseover="showTip(event, 'fs64', 198)" class="t">seq</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs62', 199)" onmouseover="showTip(event, 'fs62', 199)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>Let us define functions which provide curried constructions of our message type. This comes in handy soon:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 200)" onmouseover="showTip(event, 'fs68', 200)" class="f">transform</span> <span onmouseout="hideTip(event, 'fs29', 201)" onmouseover="showTip(event, 'fs29', 201)" class="i">t</span> <span onmouseout="hideTip(event, 'fs69', 202)" onmouseover="showTip(event, 'fs69', 202)" class="i">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs63', 203)" onmouseover="showTip(event, 'fs63', 203)" class="p">Transform</span>(<span onmouseout="hideTip(event, 'fs29', 204)" onmouseover="showTip(event, 'fs29', 204)" class="i">t</span>,<span onmouseout="hideTip(event, 'fs69', 205)" onmouseover="showTip(event, 'fs69', 205)" class="i">xs</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 206)" onmouseover="showTip(event, 'fs70', 206)" class="f">transform&#39;</span> <span onmouseout="hideTip(event, 'fs29', 207)" onmouseover="showTip(event, 'fs29', 207)" class="i">t</span> <span onmouseout="hideTip(event, 'fs71', 208)" onmouseover="showTip(event, 'fs71', 208)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs63', 209)" onmouseover="showTip(event, 'fs63', 209)" class="p">Transform</span>(<span onmouseout="hideTip(event, 'fs29', 210)" onmouseover="showTip(event, 'fs29', 210)" class="i">t</span>,[<span onmouseout="hideTip(event, 'fs71', 211)" onmouseover="showTip(event, 'fs71', 211)" class="i">x</span>])
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs72', 212)" onmouseover="showTip(event, 'fs72', 212)" class="f">translate</span> <span onmouseout="hideTip(event, 'fs73', 213)" onmouseover="showTip(event, 'fs73', 213)" class="i">x</span> <span onmouseout="hideTip(event, 'fs74', 214)" onmouseover="showTip(event, 'fs74', 214)" class="i">y</span> <span onmouseout="hideTip(event, 'fs75', 215)" onmouseover="showTip(event, 'fs75', 215)" class="i">z</span> <span onmouseout="hideTip(event, 'fs69', 216)" onmouseover="showTip(event, 'fs69', 216)" class="i">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs63', 217)" onmouseover="showTip(event, 'fs63', 217)" class="p">Transform</span>(<span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span>(<span onmouseout="hideTip(event, 'fs73', 218)" onmouseover="showTip(event, 'fs73', 218)" class="i">x</span>,<span onmouseout="hideTip(event, 'fs74', 219)" onmouseover="showTip(event, 'fs74', 219)" class="i">y</span>,<span onmouseout="hideTip(event, 'fs75', 220)" onmouseover="showTip(event, 'fs75', 220)" class="i">z</span>),<span onmouseout="hideTip(event, 'fs69', 221)" onmouseover="showTip(event, 'fs69', 221)" class="i">xs</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 222)" onmouseover="showTip(event, 'fs76', 222)" class="f">colored</span> <span onmouseout="hideTip(event, 'fs26', 223)" onmouseover="showTip(event, 'fs26', 223)" class="i">c</span> <span onmouseout="hideTip(event, 'fs69', 224)" onmouseover="showTip(event, 'fs69', 224)" class="i">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs65', 225)" onmouseover="showTip(event, 'fs65', 225)" class="p">Colored</span>(<span onmouseout="hideTip(event, 'fs26', 226)" onmouseover="showTip(event, 'fs26', 226)" class="i">c</span>,<span onmouseout="hideTip(event, 'fs69', 227)" onmouseover="showTip(event, 'fs69', 227)" class="i">xs</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs77', 228)" onmouseover="showTip(event, 'fs77', 228)" class="f">render</span> <span onmouseout="hideTip(event, 'fs78', 229)" onmouseover="showTip(event, 'fs78', 229)" class="i">picks</span> <span onmouseout="hideTip(event, 'fs79', 230)" onmouseover="showTip(event, 'fs79', 230)" class="i">primitive</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs66', 231)" onmouseover="showTip(event, 'fs66', 231)" class="p">Render</span>(<span onmouseout="hideTip(event, 'fs78', 232)" onmouseover="showTip(event, 'fs78', 232)" class="i">picks</span>,<span onmouseout="hideTip(event, 'fs79', 233)" onmouseover="showTip(event, 'fs79', 233)" class="i">primitive</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 234)" onmouseover="showTip(event, 'fs80', 234)" class="f">group</span> <span onmouseout="hideTip(event, 'fs69', 235)" onmouseover="showTip(event, 'fs69', 235)" class="i">xs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs67', 236)" onmouseover="showTip(event, 'fs67', 236)" class="p">Group</span> <span onmouseout="hideTip(event, 'fs69', 237)" onmouseover="showTip(event, 'fs69', 237)" class="i">xs</span>
</code></pre></td>
</tr>
</table>
<p>We can check our design by implementing a visual representation of our drawing plane and let us associate
a pick operation to it.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs81', 238)" onmouseover="showTip(event, 'fs81', 238)" class="i">drawGroundPlane</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 239)" onmouseover="showTip(event, 'fs18', 239)" class="p">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 240)" onmouseover="showTip(event, 'fs77', 240)" class="f">render</span> [ 
                <span class="c">// Pick operations for moving the cursor.</span>
                <span class="c">// if the ground plane is hit by a mouse move event, construct the MoveCursor command</span>
                (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs82', 241)" onmouseover="showTip(event, 'fs82', 241)" class="i">evt</span> <span class="k">-&gt;</span> 
                    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs82', 242)" onmouseover="showTip(event, 'fs82', 242)" class="i">evt</span> <span class="k">with</span>
                        | <span onmouseout="hideTip(event, 'fs59', 243)" onmouseover="showTip(event, 'fs59', 243)" class="p">Move</span> <span onmouseout="hideTip(event, 'fs54', 244)" onmouseover="showTip(event, 'fs54', 244)" class="i">p</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs42', 245)" onmouseover="showTip(event, 'fs42', 245)" class="p">Some</span> (<span onmouseout="hideTip(event, 'fs51', 246)" onmouseover="showTip(event, 'fs51', 246)" class="p">MoveCursor</span> <span onmouseout="hideTip(event, 'fs54', 247)" onmouseover="showTip(event, 'fs54', 247)" class="i">p</span>)
                        | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs41', 248)" onmouseover="showTip(event, 'fs41', 248)" class="p">None</span>
                )
                (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs82', 249)" onmouseover="showTip(event, 'fs82', 249)" class="i">evt</span> <span class="k">-&gt;</span> 
                    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs82', 250)" onmouseover="showTip(event, 'fs82', 250)" class="i">evt</span> <span class="k">with</span>
                        | <span onmouseout="hideTip(event, 'fs60', 251)" onmouseover="showTip(event, 'fs60', 251)" class="i">Down</span>(<span class="i">MouseButtons</span><span class="o">.</span><span class="i">Left</span>,<span class="i">p</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs42', 252)" onmouseover="showTip(event, 'fs42', 252)" class="i">Some</span> (<span onmouseout="hideTip(event, 'fs50', 253)" onmouseover="showTip(event, 'fs50', 253)" class="i">AddPoint</span> <span class="i">p</span>)
                        | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs41', 254)" onmouseover="showTip(event, 'fs41', 254)" class="i">None</span>
                )
                (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs82', 255)" onmouseover="showTip(event, 'fs82', 255)" class="i">evt</span> <span class="k">-&gt;</span> 
                    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs82', 256)" onmouseover="showTip(event, 'fs82', 256)" class="i">evt</span> <span class="k">with</span>
                        | <span onmouseout="hideTip(event, 'fs60', 257)" onmouseover="showTip(event, 'fs60', 257)" class="i">Down</span>(<span class="i">MouseButtons</span><span class="o">.</span><span class="i">Right</span>,_) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs42', 258)" onmouseover="showTip(event, 'fs42', 258)" class="i">Some</span> <span onmouseout="hideTip(event, 'fs49', 259)" onmouseover="showTip(event, 'fs49', 259)" class="i">ClosePolygon</span>
                        | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs41', 260)" onmouseover="showTip(event, 'fs41', 260)" class="i">None</span>)
        ]
</code></pre></td>
</tr>
</table>
<p>The above code is a pure expression, i.e. no side effects are involved. The value simply stores first class functions.
When provided with a world space pick point, and the description of a mouse event, they produce a command.
Although rather nice, the code is still repetitive.</p>
<p>Some helpers will make the function look nicer.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// some predicates which take in a mouseEvent and check whether the mouse event is interesting</span>
<span class="k">module</span> <span onmouseout="hideTip(event, 'fs83', 261)" onmouseover="showTip(event, 'fs83', 261)" class="t">Event</span> <span class="o">=</span>
    <span class="c">// &quot;function&quot; is the combined lambda/match syntax</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs84', 262)" onmouseover="showTip(event, 'fs84', 262)" class="f">move</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs58', 263)" onmouseover="showTip(event, 'fs58', 263)" class="t">MouseEvent</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs85', 264)" onmouseover="showTip(event, 'fs85', 264)" class="t">bool</span> <span class="o">=</span> <span class="k">function</span> <span onmouseout="hideTip(event, 'fs59', 265)" onmouseover="showTip(event, 'fs59', 265)" class="p">Move</span> _ <span class="k">-&gt;</span> <span class="k">true</span> | _ <span class="k">-&gt;</span> <span class="k">false</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs86', 266)" onmouseover="showTip(event, 'fs86', 266)" class="f">down</span> <span class="o">=</span> <span class="k">function</span> <span onmouseout="hideTip(event, 'fs60', 267)" onmouseover="showTip(event, 'fs60', 267)" class="p">Down</span> _ <span class="k">-&gt;</span> <span class="k">true</span> | _ <span class="k">-&gt;</span> <span class="k">false</span>       
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs87', 268)" onmouseover="showTip(event, 'fs87', 268)" class="f">down&#39;</span> <span onmouseout="hideTip(event, 'fs54', 269)" onmouseover="showTip(event, 'fs54', 269)" class="i">p</span> <span class="o">=</span> <span class="k">function</span> <span onmouseout="hideTip(event, 'fs60', 270)" onmouseover="showTip(event, 'fs60', 270)" class="p">Down</span>(<span onmouseout="hideTip(event, 'fs88', 271)" onmouseover="showTip(event, 'fs88', 271)" class="i">p&#39;</span>,_) <span class="k">when</span> <span onmouseout="hideTip(event, 'fs54', 272)" onmouseover="showTip(event, 'fs54', 272)" class="i">p</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs88', 273)" onmouseover="showTip(event, 'fs88', 273)" class="i">p&#39;</span> <span class="k">-&gt;</span> <span class="k">true</span> | _ <span class="k">-&gt;</span> <span class="k">false</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs89', 274)" onmouseover="showTip(event, 'fs89', 274)" class="f">leftDown</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs87', 275)" onmouseover="showTip(event, 'fs87', 275)" class="f">down&#39;</span> <span class="i">MouseButtons</span><span class="o">.</span><span class="i">Left</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 276)" onmouseover="showTip(event, 'fs90', 276)" class="f">rightDown</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs87', 277)" onmouseover="showTip(event, 'fs87', 277)" class="f">down&#39;</span> <span class="i">MouseButtons</span><span class="o">.</span><span class="i">Right</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs91', 278)" onmouseover="showTip(event, 'fs91', 278)" class="f">position</span> <span class="o">=</span> <span class="k">function</span> <span onmouseout="hideTip(event, 'fs59', 279)" onmouseover="showTip(event, 'fs59', 279)" class="p">Move</span> <span onmouseout="hideTip(event, 'fs92', 280)" onmouseover="showTip(event, 'fs92', 280)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs92', 281)" onmouseover="showTip(event, 'fs92', 281)" class="i">s</span> | <span onmouseout="hideTip(event, 'fs60', 282)" onmouseover="showTip(event, 'fs60', 282)" class="p">Down</span>(_, <span onmouseout="hideTip(event, 'fs92', 283)" onmouseover="showTip(event, 'fs92', 283)" class="i">s</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs92', 284)" onmouseover="showTip(event, 'fs92', 284)" class="i">s</span>

<span class="c">// Look back on the repetitive code. </span>
<span class="c">// One can see that all PickOperations perform some filtering/matching on the</span>
<span class="c">// observed input. </span>

<span class="c">// This pattern can be catpured by a higher order function such as:</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 285)" onmouseover="showTip(event, 'fs93', 285)" class="f">on</span> (<span onmouseout="hideTip(event, 'fs94', 286)" onmouseover="showTip(event, 'fs94', 286)" class="f">p</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs58', 287)" onmouseover="showTip(event, 'fs58', 287)" class="t">MouseEvent</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs85', 288)" onmouseover="showTip(event, 'fs85', 288)" class="t">bool</span>) (<span onmouseout="hideTip(event, 'fs95', 289)" onmouseover="showTip(event, 'fs95', 289)" class="f">r</span> <span class="o">:</span> <span class="i">V3d</span> <span class="k">-&gt;</span> <span class="o">&#39;</span><span class="i">msg</span>) (<span onmouseout="hideTip(event, 'fs96', 290)" onmouseover="showTip(event, 'fs96', 290)" class="i">k</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs58', 291)" onmouseover="showTip(event, 'fs58', 291)" class="t">MouseEvent</span>) <span class="o">=</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs94', 292)" onmouseover="showTip(event, 'fs94', 292)" class="f">p</span> <span onmouseout="hideTip(event, 'fs96', 293)" onmouseover="showTip(event, 'fs96', 293)" class="i">k</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs42', 294)" onmouseover="showTip(event, 'fs42', 294)" class="p">Some</span> (<span onmouseout="hideTip(event, 'fs95', 295)" onmouseover="showTip(event, 'fs95', 295)" class="f">r</span> (<span onmouseout="hideTip(event, 'fs97', 296)" onmouseover="showTip(event, 'fs97', 296)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs91', 297)" onmouseover="showTip(event, 'fs91', 297)" class="f">position</span> <span onmouseout="hideTip(event, 'fs96', 298)" onmouseover="showTip(event, 'fs96', 298)" class="i">k</span>)) <span class="k">else</span> <span onmouseout="hideTip(event, 'fs41', 299)" onmouseover="showTip(event, 'fs41', 299)" class="p">None</span>
</code></pre></td>
</tr>
</table>
<p>Applied to our original drawGroundPlane, the code duplication disappears:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs98', 300)" onmouseover="showTip(event, 'fs98', 300)" class="i">drawGroundPlane2</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 301)" onmouseover="showTip(event, 'fs18', 301)" class="p">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 302)" onmouseover="showTip(event, 'fs77', 302)" class="f">render</span> [ 
                <span onmouseout="hideTip(event, 'fs93', 303)" onmouseover="showTip(event, 'fs93', 303)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 304)" onmouseover="showTip(event, 'fs97', 304)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 305)" onmouseover="showTip(event, 'fs84', 305)" class="f">move</span>      (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs54', 306)" onmouseover="showTip(event, 'fs54', 306)" class="i">p</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs51', 307)" onmouseover="showTip(event, 'fs51', 307)" class="p">MoveCursor</span> <span onmouseout="hideTip(event, 'fs54', 308)" onmouseover="showTip(event, 'fs54', 308)" class="i">p</span>)            
                <span onmouseout="hideTip(event, 'fs93', 309)" onmouseover="showTip(event, 'fs93', 309)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 310)" onmouseover="showTip(event, 'fs97', 310)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 311)" onmouseover="showTip(event, 'fs89', 311)" class="f">leftDown</span>  (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs54', 312)" onmouseover="showTip(event, 'fs54', 312)" class="i">p</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs50', 313)" onmouseover="showTip(event, 'fs50', 313)" class="p">AddPoint</span> <span onmouseout="hideTip(event, 'fs54', 314)" onmouseover="showTip(event, 'fs54', 314)" class="i">p</span>)
                <span onmouseout="hideTip(event, 'fs93', 315)" onmouseover="showTip(event, 'fs93', 315)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 316)" onmouseover="showTip(event, 'fs97', 316)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 317)" onmouseover="showTip(event, 'fs90', 317)" class="f">rightDown</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs49', 318)" onmouseover="showTip(event, 'fs49', 318)" class="p">ClosePolygon</span>) 
           ]
</code></pre></td>
</tr>
</table>
<p>Eta reduced:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs99', 319)" onmouseover="showTip(event, 'fs99', 319)" class="i">drawGroundPlane3</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs18', 320)" onmouseover="showTip(event, 'fs18', 320)" class="p">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) 
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 321)" onmouseover="showTip(event, 'fs77', 321)" class="f">render</span> [ 
                <span onmouseout="hideTip(event, 'fs93', 322)" onmouseover="showTip(event, 'fs93', 322)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 323)" onmouseover="showTip(event, 'fs97', 323)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 324)" onmouseover="showTip(event, 'fs84', 324)" class="f">move</span>      <span onmouseout="hideTip(event, 'fs51', 325)" onmouseover="showTip(event, 'fs51', 325)" class="p">MoveCursor</span>            
                <span onmouseout="hideTip(event, 'fs93', 326)" onmouseover="showTip(event, 'fs93', 326)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 327)" onmouseover="showTip(event, 'fs97', 327)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 328)" onmouseover="showTip(event, 'fs89', 328)" class="f">leftDown</span>  <span onmouseout="hideTip(event, 'fs50', 329)" onmouseover="showTip(event, 'fs50', 329)" class="p">AddPoint</span> 
                <span onmouseout="hideTip(event, 'fs93', 330)" onmouseover="showTip(event, 'fs93', 330)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 331)" onmouseover="showTip(event, 'fs97', 331)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 332)" onmouseover="showTip(event, 'fs90', 332)" class="f">rightDown</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs49', 333)" onmouseover="showTip(event, 'fs49', 333)" class="p">ClosePolygon</span>) 
           ]
</code></pre></td>
</tr>
</table>
<p>Since moving cursors, adding points and closing polygons are the only operations in our example,
our implementation is complete.</p>
<h2>Our final DSL</h2>
<p>Next we define a type which captures two functions and a domain model:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs100', 334)" onmouseover="showTip(event, 'fs100', 334)" class="t">App</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">model</span>,<span class="o">&#39;</span><span class="i">msg</span>,<span class="o">&#39;</span><span class="i">view</span><span class="o">&gt;</span> <span class="o">=</span>
    {
        <span onmouseout="hideTip(event, 'fs101', 335)" onmouseover="showTip(event, 'fs101', 335)" class="i">initial</span>   <span class="o">:</span> <span class="o">&#39;</span><span class="i">model</span>
        <span onmouseout="hideTip(event, 'fs102', 336)" onmouseover="showTip(event, 'fs102', 336)" class="i">update</span>    <span class="o">:</span> <span class="o">&#39;</span><span class="i">model</span>   <span class="k">-&gt;</span> <span class="o">&#39;</span><span class="i">msg</span> <span class="k">-&gt;</span> <span class="o">&#39;</span><span class="i">model</span>
        <span onmouseout="hideTip(event, 'fs103', 337)" onmouseover="showTip(event, 'fs103', 337)" class="i">view</span>      <span class="o">:</span> <span class="o">&#39;</span><span class="i">model</span>   <span class="k">-&gt;</span> <span class="o">&#39;</span><span onmouseout="hideTip(event, 'fs103', 338)" onmouseover="showTip(event, 'fs103', 338)" class="i">view</span>
    }
</code></pre></td>
</tr>
</table>
<p>In that context, we always work with views of the type Scene<'msg>. Therefore this type alias makes sense:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs104', 339)" onmouseover="showTip(event, 'fs104', 339)" class="t">ThreeDApp</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">model</span>,<span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs100', 340)" onmouseover="showTip(event, 'fs100', 340)" class="t">App</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">model</span>,<span class="o">&#39;</span><span class="i">msg</span>,<span onmouseout="hideTip(event, 'fs62', 341)" onmouseover="showTip(event, 'fs62', 341)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>We refactor the app instance for our polygon-sketching example, including the view function, a bit:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">Pick</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs105', 342)" onmouseover="showTip(event, 'fs105', 342)" class="i">ignore</span> <span class="o">=</span> [] <span class="c">// empty list of pick operations shorthand</span>


<span class="k">let</span> <span onmouseout="hideTip(event, 'fs106', 343)" onmouseover="showTip(event, 'fs106', 343)" class="f">viewDrawing</span> (<span onmouseout="hideTip(event, 'fs32', 344)" onmouseover="showTip(event, 'fs32', 344)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs10', 345)" onmouseover="showTip(event, 'fs10', 345)" class="t">DrawingModel</span>) <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs107', 346)" onmouseover="showTip(event, 'fs107', 346)" class="f">viewPolygon</span> (<span onmouseout="hideTip(event, 'fs35', 347)" onmouseover="showTip(event, 'fs35', 347)" class="i">p</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 348)" onmouseover="showTip(event, 'fs5', 348)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>) <span class="o">=</span>
        [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs36', 349)" onmouseover="showTip(event, 'fs36', 349)" class="i">edge</span> <span class="k">in</span> <span class="i">Polygon3d</span>(<span onmouseout="hideTip(event, 'fs35', 350)" onmouseover="showTip(event, 'fs35', 350)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 351)" onmouseover="showTip(event, 'fs37', 351)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 352)" onmouseover="showTip(event, 'fs38', 352)" class="i">toSeq</span>)<span class="o">.</span><span class="i">EdgeLines</span> <span class="k">do</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 353)" onmouseover="showTip(event, 'fs39', 353)" class="i">v</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs36', 354)" onmouseover="showTip(event, 'fs36', 354)" class="i">edge</span><span class="o">.</span><span class="i">P1</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs36', 355)" onmouseover="showTip(event, 'fs36', 355)" class="i">edge</span><span class="o">.</span><span class="i">P0</span>
            <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs17', 356)" onmouseover="showTip(event, 'fs17', 356)" class="p">Cylinder</span>(<span onmouseout="hideTip(event, 'fs36', 357)" onmouseover="showTip(event, 'fs36', 357)" class="i">edge</span><span class="o">.</span><span class="i">P0</span>,<span onmouseout="hideTip(event, 'fs39', 358)" onmouseover="showTip(event, 'fs39', 358)" class="i">v</span><span class="o">.</span><span class="i">Normalized</span>,<span onmouseout="hideTip(event, 'fs39', 359)" onmouseover="showTip(event, 'fs39', 359)" class="i">v</span><span class="o">.</span><span class="i">Length</span>,<span class="n">0.03</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 360)" onmouseover="showTip(event, 'fs77', 360)" class="f">render</span> <span onmouseout="hideTip(event, 'fs108', 361)" onmouseover="showTip(event, 'fs108', 361)" class="t">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs105', 362)" onmouseover="showTip(event, 'fs105', 362)" class="i">ignore</span> 
        ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs80', 363)" onmouseover="showTip(event, 'fs80', 363)" class="f">group</span>

    <span onmouseout="hideTip(event, 'fs80', 364)" onmouseover="showTip(event, 'fs80', 364)" class="f">group</span> [
        <span class="k">yield</span> [ <span onmouseout="hideTip(event, 'fs18', 365)" onmouseover="showTip(event, 'fs18', 365)" class="p">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) 
                    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 366)" onmouseover="showTip(event, 'fs77', 366)" class="f">render</span> [ 
                            <span onmouseout="hideTip(event, 'fs93', 367)" onmouseover="showTip(event, 'fs93', 367)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 368)" onmouseover="showTip(event, 'fs97', 368)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 369)" onmouseover="showTip(event, 'fs84', 369)" class="f">move</span> <span onmouseout="hideTip(event, 'fs51', 370)" onmouseover="showTip(event, 'fs51', 370)" class="p">MoveCursor</span>
                            <span onmouseout="hideTip(event, 'fs93', 371)" onmouseover="showTip(event, 'fs93', 371)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 372)" onmouseover="showTip(event, 'fs97', 372)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs89', 373)" onmouseover="showTip(event, 'fs89', 373)" class="f">leftDown</span>  <span onmouseout="hideTip(event, 'fs50', 374)" onmouseover="showTip(event, 'fs50', 374)" class="p">AddPoint</span> 
                            <span onmouseout="hideTip(event, 'fs93', 375)" onmouseover="showTip(event, 'fs93', 375)" class="f">on</span> <span onmouseout="hideTip(event, 'fs97', 376)" onmouseover="showTip(event, 'fs97', 376)" class="t">Event</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs90', 377)" onmouseover="showTip(event, 'fs90', 377)" class="f">rightDown</span> (<span class="i">constF</span> <span onmouseout="hideTip(event, 'fs49', 378)" onmouseover="showTip(event, 'fs49', 378)" class="i">ClosePolygon</span>) <span class="c">// constF == fun a -&gt; fun _ -&gt; a</span>
                        ] 
                ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs76', 379)" onmouseover="showTip(event, 'fs76', 379)" class="f">colored</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Gray</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs32', 380)" onmouseover="showTip(event, 'fs32', 380)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 381)" onmouseover="showTip(event, 'fs12', 381)" class="i">working</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs42', 382)" onmouseover="showTip(event, 'fs42', 382)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 383)" onmouseover="showTip(event, 'fs43', 383)" class="i">v</span> <span class="k">when</span> <span onmouseout="hideTip(event, 'fs43', 384)" onmouseover="showTip(event, 'fs43', 384)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 385)" onmouseover="showTip(event, 'fs8', 385)" class="i">cursor</span><span class="o">.</span><span class="i">IsSome</span> <span class="k">-&gt;</span> 
                <span class="k">yield</span> 
                    [ <span onmouseout="hideTip(event, 'fs14', 386)" onmouseover="showTip(event, 'fs14', 386)" class="p">Sphere</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span class="n">0.1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 387)" onmouseover="showTip(event, 'fs77', 387)" class="f">render</span> <span onmouseout="hideTip(event, 'fs108', 388)" onmouseover="showTip(event, 'fs108', 388)" class="t">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs105', 389)" onmouseover="showTip(event, 'fs105', 389)" class="i">ignore</span> ] 
                        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs76', 390)" onmouseover="showTip(event, 'fs76', 390)" class="f">colored</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Red</span>
                        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs70', 391)" onmouseover="showTip(event, 'fs70', 391)" class="f">transform&#39;</span> (<span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span>(<span onmouseout="hideTip(event, 'fs43', 392)" onmouseover="showTip(event, 'fs43', 392)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 393)" onmouseover="showTip(event, 'fs8', 393)" class="i">cursor</span><span class="o">.</span><span class="i">Value</span>))
                <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs107', 394)" onmouseover="showTip(event, 'fs107', 394)" class="f">viewPolygon</span> (<span onmouseout="hideTip(event, 'fs43', 395)" onmouseover="showTip(event, 'fs43', 395)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 396)" onmouseover="showTip(event, 'fs8', 396)" class="i">cursor</span><span class="o">.</span><span class="i">Value</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs43', 397)" onmouseover="showTip(event, 'fs43', 397)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 398)" onmouseover="showTip(event, 'fs7', 398)" class="i">finishedPoints</span>)
            | _ <span class="k">-&gt;</span> ()
        <span class="k">for</span> <span onmouseout="hideTip(event, 'fs109', 399)" onmouseover="showTip(event, 'fs109', 399)" class="i">p</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs32', 400)" onmouseover="showTip(event, 'fs32', 400)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 401)" onmouseover="showTip(event, 'fs11', 401)" class="i">finished</span> <span class="k">do</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs107', 402)" onmouseover="showTip(event, 'fs107', 402)" class="f">viewPolygon</span> <span onmouseout="hideTip(event, 'fs109', 403)" onmouseover="showTip(event, 'fs109', 403)" class="i">p</span>
    ]

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 404)" onmouseover="showTip(event, 'fs110', 404)" class="i">drawingApp</span> <span class="o">=</span> { 
    <span class="i">initial</span> <span class="o">=</span> { <span class="i">finished</span> <span class="o">=</span> []; <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 405)" onmouseover="showTip(event, 'fs41', 405)" class="p">None</span> }
    <span class="i">update</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs52', 406)" onmouseover="showTip(event, 'fs52', 406)" class="f">updateDrawing</span>
    <span class="i">view</span>    <span class="o">=</span> <span onmouseout="hideTip(event, 'fs106', 407)" onmouseover="showTip(event, 'fs106', 407)" class="f">viewDrawing</span>
}
</code></pre></td>
</tr>
</table>
<p>It's no accident. Our final formulation matches the formulation of Elm applications!</p>
<p>In other words, we just reinvented the core part of the Elm Architecture!</p>
<h2>An implementation for our API using the aardvark rendering engine.</h2>
<h3>Proof of Concept: Rendering values of type Scene</h3>
<p>We want to render the scene using the Aardvark rendering engine.</p>
<p>To achieve this, there are several possibilities:
<em> Manually compute Render Objects for our scene.
</em> Create a Scene Graph which describes our scene in rendering terms.</p>
<p>In this work we chose the latter. Please note that the implementation is far from optimal, but serves as a simple
base that we can optimize subsequently.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp">[&lt;<span onmouseout="hideTip(event, 'fs111', 408)" onmouseover="showTip(event, 'fs111', 408)" class="t">AutoOpen</span>&gt;]
<span class="k">module</span> <span class="t">ConvertToSceneGraph</span> <span class="o">=</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 409)" onmouseover="showTip(event, 'fs2', 409)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 410)" onmouseover="showTip(event, 'fs112', 410)" class="i">SceneGraph</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs113', 411)" onmouseover="showTip(event, 'fs113', 411)" class="t">State</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs114', 412)" onmouseover="showTip(event, 'fs114', 412)" class="i">trafo</span> <span class="o">:</span> <span class="i">Trafo3d</span>; <span onmouseout="hideTip(event, 'fs115', 413)" onmouseover="showTip(event, 'fs115', 413)" class="i">color</span> <span class="o">:</span> <span class="i">C4b</span> }

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs116', 414)" onmouseover="showTip(event, 'fs116', 414)" class="f">toSg</span> (<span onmouseout="hideTip(event, 'fs117', 415)" onmouseover="showTip(event, 'fs117', 415)" class="i">scene</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs62', 416)" onmouseover="showTip(event, 'fs62', 416)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>) <span class="o">:</span> <span class="i">ISg</span> <span class="o">=</span> 
        <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs118', 417)" onmouseover="showTip(event, 'fs118', 417)" class="f">toSg</span> (<span onmouseout="hideTip(event, 'fs119', 418)" onmouseover="showTip(event, 'fs119', 418)" class="i">s</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs113', 419)" onmouseover="showTip(event, 'fs113', 419)" class="t">State</span>) (<span onmouseout="hideTip(event, 'fs117', 420)" onmouseover="showTip(event, 'fs117', 420)" class="i">scene</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs62', 421)" onmouseover="showTip(event, 'fs62', 421)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>) <span class="o">=</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs117', 422)" onmouseover="showTip(event, 'fs117', 422)" class="i">scene</span> <span class="k">with</span>
                | <span onmouseout="hideTip(event, 'fs63', 423)" onmouseover="showTip(event, 'fs63', 423)" class="p">Transform</span>(<span onmouseout="hideTip(event, 'fs120', 424)" onmouseover="showTip(event, 'fs120', 424)" class="i">t</span>,<span onmouseout="hideTip(event, 'fs121', 425)" onmouseover="showTip(event, 'fs121', 425)" class="i">children</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs121', 426)" onmouseover="showTip(event, 'fs121', 426)" class="i">children</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 427)" onmouseover="showTip(event, 'fs122', 427)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 428)" onmouseover="showTip(event, 'fs123', 428)" class="f">map</span> ( <span onmouseout="hideTip(event, 'fs118', 429)" onmouseover="showTip(event, 'fs118', 429)" class="f">toSg</span> { <span onmouseout="hideTip(event, 'fs119', 430)" onmouseover="showTip(event, 'fs119', 430)" class="i">s</span> <span class="k">with</span> <span class="i">trafo</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs119', 431)" onmouseover="showTip(event, 'fs119', 431)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 432)" onmouseover="showTip(event, 'fs114', 432)" class="i">trafo</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs120', 433)" onmouseover="showTip(event, 'fs120', 433)" class="i">t</span> } ) <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">group&#39;</span>
                | <span onmouseout="hideTip(event, 'fs65', 434)" onmouseover="showTip(event, 'fs65', 434)" class="p">Colored</span>(<span onmouseout="hideTip(event, 'fs124', 435)" onmouseover="showTip(event, 'fs124', 435)" class="i">c</span>,<span onmouseout="hideTip(event, 'fs121', 436)" onmouseover="showTip(event, 'fs121', 436)" class="i">children</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs121', 437)" onmouseover="showTip(event, 'fs121', 437)" class="i">children</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 438)" onmouseover="showTip(event, 'fs122', 438)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 439)" onmouseover="showTip(event, 'fs123', 439)" class="f">map</span> ( <span onmouseout="hideTip(event, 'fs118', 440)" onmouseover="showTip(event, 'fs118', 440)" class="f">toSg</span> { <span onmouseout="hideTip(event, 'fs119', 441)" onmouseover="showTip(event, 'fs119', 441)" class="i">s</span> <span class="k">with</span> <span class="i">color</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs124', 442)" onmouseover="showTip(event, 'fs124', 442)" class="i">c</span> } ) <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">group&#39;</span>
                | <span onmouseout="hideTip(event, 'fs66', 443)" onmouseover="showTip(event, 'fs66', 443)" class="p">Render</span> (_, <span onmouseout="hideTip(event, 'fs16', 444)" onmouseover="showTip(event, 'fs16', 444)" class="p">Cone</span>(<span onmouseout="hideTip(event, 'fs125', 445)" onmouseover="showTip(event, 'fs125', 445)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs126', 446)" onmouseover="showTip(event, 'fs126', 446)" class="i">dir</span>,<span onmouseout="hideTip(event, 'fs127', 447)" onmouseover="showTip(event, 'fs127', 447)" class="i">height</span>,<span onmouseout="hideTip(event, 'fs128', 448)" onmouseover="showTip(event, 'fs128', 448)" class="i">radius</span>)) <span class="k">-&gt;</span> 
                    <span class="i">IndexedGeometryPrimitives</span><span class="o">.</span><span class="i">solidCone</span> <span onmouseout="hideTip(event, 'fs125', 449)" onmouseover="showTip(event, 'fs125', 449)" class="i">center</span> <span onmouseout="hideTip(event, 'fs126', 450)" onmouseover="showTip(event, 'fs126', 450)" class="i">dir</span> <span onmouseout="hideTip(event, 'fs127', 451)" onmouseover="showTip(event, 'fs127', 451)" class="i">height</span> <span onmouseout="hideTip(event, 'fs128', 452)" onmouseover="showTip(event, 'fs128', 452)" class="i">radius</span> <span class="n">10</span> <span onmouseout="hideTip(event, 'fs119', 453)" onmouseover="showTip(event, 'fs119', 453)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs115', 454)" onmouseover="showTip(event, 'fs115', 454)" class="i">color</span> 
                    <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">ofIndexedGeometry</span> <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 455)" onmouseover="showTip(event, 'fs68', 455)" class="i">transform</span> <span onmouseout="hideTip(event, 'fs119', 456)" onmouseover="showTip(event, 'fs119', 456)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 457)" onmouseover="showTip(event, 'fs114', 457)" class="i">trafo</span>
                | <span onmouseout="hideTip(event, 'fs66', 458)" onmouseover="showTip(event, 'fs66', 458)" class="p">Render</span> (_, <span onmouseout="hideTip(event, 'fs17', 459)" onmouseover="showTip(event, 'fs17', 459)" class="p">Cylinder</span>(<span onmouseout="hideTip(event, 'fs125', 460)" onmouseover="showTip(event, 'fs125', 460)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs126', 461)" onmouseover="showTip(event, 'fs126', 461)" class="i">dir</span>,<span onmouseout="hideTip(event, 'fs127', 462)" onmouseover="showTip(event, 'fs127', 462)" class="i">height</span>,<span onmouseout="hideTip(event, 'fs128', 463)" onmouseover="showTip(event, 'fs128', 463)" class="i">radius</span>)) <span class="k">-&gt;</span> 
                    <span class="i">IndexedGeometryPrimitives</span><span class="o">.</span><span class="i">solidCylinder</span> <span onmouseout="hideTip(event, 'fs125', 464)" onmouseover="showTip(event, 'fs125', 464)" class="i">center</span> <span onmouseout="hideTip(event, 'fs126', 465)" onmouseover="showTip(event, 'fs126', 465)" class="i">dir</span> <span onmouseout="hideTip(event, 'fs127', 466)" onmouseover="showTip(event, 'fs127', 466)" class="i">height</span> <span onmouseout="hideTip(event, 'fs128', 467)" onmouseover="showTip(event, 'fs128', 467)" class="i">radius</span> <span onmouseout="hideTip(event, 'fs128', 468)" onmouseover="showTip(event, 'fs128', 468)" class="i">radius</span> <span class="n">10</span> <span onmouseout="hideTip(event, 'fs119', 469)" onmouseover="showTip(event, 'fs119', 469)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs115', 470)" onmouseover="showTip(event, 'fs115', 470)" class="i">color</span> 
                    <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">ofIndexedGeometry</span> <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 471)" onmouseover="showTip(event, 'fs68', 471)" class="i">transform</span> <span onmouseout="hideTip(event, 'fs119', 472)" onmouseover="showTip(event, 'fs119', 472)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 473)" onmouseover="showTip(event, 'fs114', 473)" class="i">trafo</span>
                | <span onmouseout="hideTip(event, 'fs66', 474)" onmouseover="showTip(event, 'fs66', 474)" class="p">Render</span> (_, <span onmouseout="hideTip(event, 'fs14', 475)" onmouseover="showTip(event, 'fs14', 475)" class="p">Sphere</span>(<span onmouseout="hideTip(event, 'fs125', 476)" onmouseover="showTip(event, 'fs125', 476)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs128', 477)" onmouseover="showTip(event, 'fs128', 477)" class="i">radius</span>)) <span class="k">-&gt;</span>
                    <span class="i">IndexedGeometryPrimitives</span><span class="o">.</span><span class="i">solidSubdivisionSphere</span> (<span class="i">Sphere3d</span>(<span onmouseout="hideTip(event, 'fs125', 478)" onmouseover="showTip(event, 'fs125', 478)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs128', 479)" onmouseover="showTip(event, 'fs128', 479)" class="i">radius</span>)) <span class="n">5</span> <span onmouseout="hideTip(event, 'fs119', 480)" onmouseover="showTip(event, 'fs119', 480)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs115', 481)" onmouseover="showTip(event, 'fs115', 481)" class="i">color</span> 
                    <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">ofIndexedGeometry</span> <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 482)" onmouseover="showTip(event, 'fs68', 482)" class="i">transform</span> <span onmouseout="hideTip(event, 'fs119', 483)" onmouseover="showTip(event, 'fs119', 483)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 484)" onmouseover="showTip(event, 'fs114', 484)" class="i">trafo</span>
                | <span onmouseout="hideTip(event, 'fs66', 485)" onmouseover="showTip(event, 'fs66', 485)" class="p">Render</span>(_, <span onmouseout="hideTip(event, 'fs18', 486)" onmouseover="showTip(event, 'fs18', 486)" class="p">Quad</span>(<span onmouseout="hideTip(event, 'fs54', 487)" onmouseover="showTip(event, 'fs54', 487)" class="i">p</span>)) <span class="k">-&gt;</span>
                    <span class="i">IndexedGeometry</span>(
                            <span class="i">IndexedGeometryMode</span><span class="o">.</span><span class="i">TriangleList</span>, [| <span class="n">0</span>; <span class="n">1</span>; <span class="n">2</span>; <span class="n">0</span>; <span class="n">2</span>; <span class="n">3</span> |], 
                            <span class="i">SymDict</span><span class="o">.</span><span class="i">ofList</span> [
                                <span class="i">DefaultSemantic</span><span class="o">.</span><span class="i">Positions</span>, <span onmouseout="hideTip(event, 'fs54', 488)" onmouseover="showTip(event, 'fs54', 488)" class="i">p</span><span class="o">.</span><span class="i">Points</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 489)" onmouseover="showTip(event, 'fs122', 489)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 490)" onmouseover="showTip(event, 'fs123', 490)" class="i">map</span> <span class="i">V3f</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 491)" onmouseover="showTip(event, 'fs122', 491)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs129', 492)" onmouseover="showTip(event, 'fs129', 492)" class="i">toArray</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs130', 493)" onmouseover="showTip(event, 'fs130', 493)" class="i">Array</span>; 
                                <span class="i">DefaultSemantic</span><span class="o">.</span><span class="i">Colors</span>,  <span onmouseout="hideTip(event, 'fs130', 494)" onmouseover="showTip(event, 'fs130', 494)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs131', 495)" onmouseover="showTip(event, 'fs131', 495)" class="i">replicate</span> <span class="n">4</span> <span onmouseout="hideTip(event, 'fs119', 496)" onmouseover="showTip(event, 'fs119', 496)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs115', 497)" onmouseover="showTip(event, 'fs115', 497)" class="i">color</span>  <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs1', 498)" onmouseover="showTip(event, 'fs1', 498)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs130', 499)" onmouseover="showTip(event, 'fs130', 499)" class="i">Array</span>; 
                                <span class="i">DefaultSemantic</span><span class="o">.</span><span class="i">Normals</span>, <span onmouseout="hideTip(event, 'fs130', 500)" onmouseover="showTip(event, 'fs130', 500)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs131', 501)" onmouseover="showTip(event, 'fs131', 501)" class="i">replicate</span> <span class="n">4</span> (<span onmouseout="hideTip(event, 'fs54', 502)" onmouseover="showTip(event, 'fs54', 502)" class="i">p</span><span class="o">.</span><span class="i">Edge03</span><span class="o">.</span><span class="i">Cross</span>(<span onmouseout="hideTip(event, 'fs54', 503)" onmouseover="showTip(event, 'fs54', 503)" class="i">p</span><span class="o">.</span><span class="i">P2</span><span class="o">-</span><span onmouseout="hideTip(event, 'fs54', 504)" onmouseover="showTip(event, 'fs54', 504)" class="i">p</span><span class="o">.</span><span class="i">P0</span>))<span class="o">.</span><span class="i">Normalized</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs1', 505)" onmouseover="showTip(event, 'fs1', 505)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs130', 506)" onmouseover="showTip(event, 'fs130', 506)" class="i">Array</span>
                            ], <span class="i">SymDict</span><span class="o">.</span><span class="i">empty</span>)  <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">ofIndexedGeometry</span> <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 507)" onmouseover="showTip(event, 'fs68', 507)" class="i">transform</span> <span onmouseout="hideTip(event, 'fs119', 508)" onmouseover="showTip(event, 'fs119', 508)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 509)" onmouseover="showTip(event, 'fs114', 509)" class="i">trafo</span>
                | <span onmouseout="hideTip(event, 'fs67', 510)" onmouseover="showTip(event, 'fs67', 510)" class="p">Group</span> <span onmouseout="hideTip(event, 'fs132', 511)" onmouseover="showTip(event, 'fs132', 511)" class="i">xs</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs132', 512)" onmouseover="showTip(event, 'fs132', 512)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 513)" onmouseover="showTip(event, 'fs122', 513)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 514)" onmouseover="showTip(event, 'fs123', 514)" class="f">map</span> ( <span onmouseout="hideTip(event, 'fs118', 515)" onmouseover="showTip(event, 'fs118', 515)" class="f">toSg</span> <span onmouseout="hideTip(event, 'fs119', 516)" onmouseover="showTip(event, 'fs119', 516)" class="i">s</span>) <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">group&#39;</span>

        <span onmouseout="hideTip(event, 'fs118', 517)" onmouseover="showTip(event, 'fs118', 517)" class="f">toSg</span> { <span class="i">trafo</span> <span class="o">=</span> <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Identity</span>; <span class="i">color</span> <span class="o">=</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> } <span onmouseout="hideTip(event, 'fs117', 518)" onmouseover="showTip(event, 'fs117', 518)" class="i">scene</span>
</code></pre></td>
</tr>
</table>
<p>The function toSg is a mapping from our scene representation to the Aardvark.Rendering Scene Graph.</p>
<p>Now we can render scenes. Next, we implement a simple picking scheme which computes command messages
out of mouse clicks:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">Picking</span> <span class="o">=</span>
    <span class="c">// implement ray - object intersections for all renderable primitives:</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs133', 519)" onmouseover="showTip(event, 'fs133', 519)" class="f">hitPrimitive</span> (<span onmouseout="hideTip(event, 'fs134', 520)" onmouseover="showTip(event, 'fs134', 520)" class="i">p</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs13', 521)" onmouseover="showTip(event, 'fs13', 521)" class="t">Primitive</span>) (<span onmouseout="hideTip(event, 'fs135', 522)" onmouseover="showTip(event, 'fs135', 522)" class="i">trafo</span> <span class="o">:</span> <span class="i">Trafo3d</span>) (<span onmouseout="hideTip(event, 'fs136', 523)" onmouseover="showTip(event, 'fs136', 523)" class="i">ray</span> <span class="o">:</span> <span class="i">Ray3d</span>) <span onmouseout="hideTip(event, 'fs137', 524)" onmouseover="showTip(event, 'fs137', 524)" class="i">action</span> <span class="o">=</span>
        <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs138', 525)" onmouseover="showTip(event, 'fs138', 525)" class="v">ha</span> <span class="o">=</span> <span class="i">RayHit3d</span><span class="o">.</span><span class="i">MaxRange</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs134', 526)" onmouseover="showTip(event, 'fs134', 526)" class="i">p</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs14', 527)" onmouseover="showTip(event, 'fs14', 527)" class="p">Sphere</span>(<span onmouseout="hideTip(event, 'fs125', 528)" onmouseover="showTip(event, 'fs125', 528)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs128', 529)" onmouseover="showTip(event, 'fs128', 529)" class="i">radius</span>)<span class="k">-&gt;</span> 
                <span class="k">let</span> <span onmouseout="hideTip(event, 'fs139', 530)" onmouseover="showTip(event, 'fs139', 530)" class="i">transformed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs135', 531)" onmouseover="showTip(event, 'fs135', 531)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span>(<span onmouseout="hideTip(event, 'fs125', 532)" onmouseover="showTip(event, 'fs125', 532)" class="i">center</span>)
                <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs138', 533)" onmouseover="showTip(event, 'fs138', 533)" class="v">ha</span> <span class="o">=</span> <span class="i">RayHit3d</span><span class="o">.</span><span class="i">MaxRange</span>
                <span class="k">if</span> <span onmouseout="hideTip(event, 'fs136', 534)" onmouseover="showTip(event, 'fs136', 534)" class="i">ray</span><span class="o">.</span><span class="i">HitsSphere</span>(<span onmouseout="hideTip(event, 'fs139', 535)" onmouseover="showTip(event, 'fs139', 535)" class="i">transformed</span>,<span onmouseout="hideTip(event, 'fs128', 536)" onmouseover="showTip(event, 'fs128', 536)" class="i">radius</span>,<span class="n">0.0</span>,<span onmouseout="hideTip(event, 'fs140', 537)" onmouseover="showTip(event, 'fs140', 537)" class="i">Double</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs141', 538)" onmouseover="showTip(event, 'fs141', 538)" class="i">PositiveInfinity</span>, <span class="o">&amp;</span><span onmouseout="hideTip(event, 'fs138', 539)" onmouseover="showTip(event, 'fs138', 539)" class="i">ha</span>) <span class="k">then</span>
                    [<span onmouseout="hideTip(event, 'fs138', 540)" onmouseover="showTip(event, 'fs138', 540)" class="v">ha</span><span class="o">.</span><span class="i">T</span>, <span onmouseout="hideTip(event, 'fs137', 541)" onmouseover="showTip(event, 'fs137', 541)" class="i">action</span>]
                <span class="k">else</span> []
            | <span onmouseout="hideTip(event, 'fs16', 542)" onmouseover="showTip(event, 'fs16', 542)" class="p">Cone</span>(<span onmouseout="hideTip(event, 'fs125', 543)" onmouseover="showTip(event, 'fs125', 543)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs126', 544)" onmouseover="showTip(event, 'fs126', 544)" class="i">dir</span>,<span onmouseout="hideTip(event, 'fs127', 545)" onmouseover="showTip(event, 'fs127', 545)" class="i">height</span>,<span onmouseout="hideTip(event, 'fs128', 546)" onmouseover="showTip(event, 'fs128', 546)" class="i">radius</span>) | <span onmouseout="hideTip(event, 'fs17', 547)" onmouseover="showTip(event, 'fs17', 547)" class="p">Cylinder</span>(<span class="i">center</span>,<span class="i">dir</span>,<span class="i">height</span>,<span onmouseout="hideTip(event, 'fs128', 548)" onmouseover="showTip(event, 'fs128', 548)" class="i">radius</span>) <span class="k">-&gt;</span> 
                <span class="k">let</span> <span onmouseout="hideTip(event, 'fs142', 549)" onmouseover="showTip(event, 'fs142', 549)" class="i">cylinder</span> <span class="o">=</span> <span class="i">Cylinder3d</span>(<span onmouseout="hideTip(event, 'fs135', 550)" onmouseover="showTip(event, 'fs135', 550)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span> <span onmouseout="hideTip(event, 'fs125', 551)" onmouseover="showTip(event, 'fs125', 551)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs135', 552)" onmouseover="showTip(event, 'fs135', 552)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span> (<span onmouseout="hideTip(event, 'fs125', 553)" onmouseover="showTip(event, 'fs125', 553)" class="i">center</span><span class="o">+</span><span onmouseout="hideTip(event, 'fs126', 554)" onmouseover="showTip(event, 'fs126', 554)" class="i">dir</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs127', 555)" onmouseover="showTip(event, 'fs127', 555)" class="i">height</span>),<span onmouseout="hideTip(event, 'fs128', 556)" onmouseover="showTip(event, 'fs128', 556)" class="i">radius</span>)
                <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs138', 557)" onmouseover="showTip(event, 'fs138', 557)" class="v">ha</span> <span class="o">=</span> <span class="i">RayHit3d</span><span class="o">.</span><span class="i">MaxRange</span>
                <span class="k">if</span> <span onmouseout="hideTip(event, 'fs136', 558)" onmouseover="showTip(event, 'fs136', 558)" class="i">ray</span><span class="o">.</span><span class="i">Hits</span>(<span onmouseout="hideTip(event, 'fs142', 559)" onmouseover="showTip(event, 'fs142', 559)" class="i">cylinder</span>,<span class="n">0.0</span>,<span onmouseout="hideTip(event, 'fs140', 560)" onmouseover="showTip(event, 'fs140', 560)" class="i">Double</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs143', 561)" onmouseover="showTip(event, 'fs143', 561)" class="i">MaxValue</span>,<span class="o">&amp;</span><span onmouseout="hideTip(event, 'fs138', 562)" onmouseover="showTip(event, 'fs138', 562)" class="i">ha</span>) <span class="k">then</span>
                    [<span onmouseout="hideTip(event, 'fs138', 563)" onmouseover="showTip(event, 'fs138', 563)" class="v">ha</span><span class="o">.</span><span class="i">T</span>, <span onmouseout="hideTip(event, 'fs137', 564)" onmouseover="showTip(event, 'fs137', 564)" class="i">action</span>]
                <span class="k">else</span> []
            | <span onmouseout="hideTip(event, 'fs18', 565)" onmouseover="showTip(event, 'fs18', 565)" class="p">Quad</span> <span onmouseout="hideTip(event, 'fs144', 566)" onmouseover="showTip(event, 'fs144', 566)" class="i">q</span> <span class="k">-&gt;</span> 
                <span class="k">let</span> <span onmouseout="hideTip(event, 'fs139', 567)" onmouseover="showTip(event, 'fs139', 567)" class="i">transformed</span> <span class="o">=</span> <span class="i">Quad3d</span>(<span onmouseout="hideTip(event, 'fs144', 568)" onmouseover="showTip(event, 'fs144', 568)" class="i">q</span><span class="o">.</span><span class="i">Points</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 569)" onmouseover="showTip(event, 'fs122', 569)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs123', 570)" onmouseover="showTip(event, 'fs123', 570)" class="i">map</span> <span onmouseout="hideTip(event, 'fs135', 571)" onmouseover="showTip(event, 'fs135', 571)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span>)
                <span class="k">if</span> <span onmouseout="hideTip(event, 'fs136', 572)" onmouseover="showTip(event, 'fs136', 572)" class="i">ray</span><span class="o">.</span><span class="i">HitsPlane</span>(<span class="i">Plane3d</span><span class="o">.</span><span class="i">ZPlane</span>,<span class="n">0.0</span>,<span onmouseout="hideTip(event, 'fs140', 573)" onmouseover="showTip(event, 'fs140', 573)" class="i">Double</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs143', 574)" onmouseover="showTip(event, 'fs143', 574)" class="i">MaxValue</span>,<span class="o">&amp;</span><span onmouseout="hideTip(event, 'fs138', 575)" onmouseover="showTip(event, 'fs138', 575)" class="i">ha</span>) <span class="k">then</span> [<span onmouseout="hideTip(event, 'fs138', 576)" onmouseover="showTip(event, 'fs138', 576)" class="v">ha</span><span class="o">.</span><span class="i">T</span>, <span onmouseout="hideTip(event, 'fs137', 577)" onmouseover="showTip(event, 'fs137', 577)" class="i">action</span>]
                <span class="k">else</span> []

    <span class="c">// given a ray and a scene -&gt; perform a PickOperation.</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs145', 578)" onmouseover="showTip(event, 'fs145', 578)" class="f">pick</span> (<span onmouseout="hideTip(event, 'fs146', 579)" onmouseover="showTip(event, 'fs146', 579)" class="i">r</span> <span class="o">:</span> <span class="i">Ray3d</span>) (<span onmouseout="hideTip(event, 'fs147', 580)" onmouseover="showTip(event, 'fs147', 580)" class="i">s</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs62', 581)" onmouseover="showTip(event, 'fs62', 581)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>)  <span class="o">=</span>
        <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs148', 582)" onmouseover="showTip(event, 'fs148', 582)" class="f">go</span> (<span onmouseout="hideTip(event, 'fs149', 583)" onmouseover="showTip(event, 'fs149', 583)" class="i">state</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs113', 584)" onmouseover="showTip(event, 'fs113', 584)" class="t">State</span>) <span onmouseout="hideTip(event, 'fs150', 585)" onmouseover="showTip(event, 'fs150', 585)" class="i">s</span> <span class="o">=</span> 
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs150', 586)" onmouseover="showTip(event, 'fs150', 586)" class="i">s</span> <span class="k">with</span>    
                <span class="c">// collect pick operations for all children</span>
                | <span onmouseout="hideTip(event, 'fs67', 587)" onmouseover="showTip(event, 'fs67', 587)" class="p">Group</span> <span onmouseout="hideTip(event, 'fs69', 588)" onmouseover="showTip(event, 'fs69', 588)" class="i">xs</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs69', 589)" onmouseover="showTip(event, 'fs69', 589)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 590)" onmouseover="showTip(event, 'fs122', 590)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs151', 591)" onmouseover="showTip(event, 'fs151', 591)" class="f">toList</span> <span class="o">|&gt;</span>  <span onmouseout="hideTip(event, 'fs37', 592)" onmouseover="showTip(event, 'fs37', 592)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs152', 593)" onmouseover="showTip(event, 'fs152', 593)" class="f">collect</span> (<span onmouseout="hideTip(event, 'fs148', 594)" onmouseover="showTip(event, 'fs148', 594)" class="f">go</span> <span onmouseout="hideTip(event, 'fs149', 595)" onmouseover="showTip(event, 'fs149', 595)" class="i">state</span>)
                | <span onmouseout="hideTip(event, 'fs63', 596)" onmouseover="showTip(event, 'fs63', 596)" class="p">Transform</span>(<span onmouseout="hideTip(event, 'fs120', 597)" onmouseover="showTip(event, 'fs120', 597)" class="i">t</span>,<span onmouseout="hideTip(event, 'fs69', 598)" onmouseover="showTip(event, 'fs69', 598)" class="i">xs</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs69', 599)" onmouseover="showTip(event, 'fs69', 599)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 600)" onmouseover="showTip(event, 'fs122', 600)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs151', 601)" onmouseover="showTip(event, 'fs151', 601)" class="f">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 602)" onmouseover="showTip(event, 'fs37', 602)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs152', 603)" onmouseover="showTip(event, 'fs152', 603)" class="f">collect</span> (<span onmouseout="hideTip(event, 'fs148', 604)" onmouseover="showTip(event, 'fs148', 604)" class="f">go</span> { <span onmouseout="hideTip(event, 'fs149', 605)" onmouseover="showTip(event, 'fs149', 605)" class="i">state</span> <span class="k">with</span> <span class="i">trafo</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs149', 606)" onmouseover="showTip(event, 'fs149', 606)" class="i">state</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 607)" onmouseover="showTip(event, 'fs114', 607)" class="i">trafo</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs120', 608)" onmouseover="showTip(event, 'fs120', 608)" class="i">t</span> })
                | <span onmouseout="hideTip(event, 'fs65', 609)" onmouseover="showTip(event, 'fs65', 609)" class="p">Colored</span>(_,<span onmouseout="hideTip(event, 'fs69', 610)" onmouseover="showTip(event, 'fs69', 610)" class="i">xs</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs69', 611)" onmouseover="showTip(event, 'fs69', 611)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 612)" onmouseover="showTip(event, 'fs122', 612)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs151', 613)" onmouseover="showTip(event, 'fs151', 613)" class="f">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 614)" onmouseover="showTip(event, 'fs37', 614)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs152', 615)" onmouseover="showTip(event, 'fs152', 615)" class="f">collect</span> (<span onmouseout="hideTip(event, 'fs148', 616)" onmouseover="showTip(event, 'fs148', 616)" class="f">go</span> <span onmouseout="hideTip(event, 'fs149', 617)" onmouseover="showTip(event, 'fs149', 617)" class="i">state</span>)
                | <span onmouseout="hideTip(event, 'fs66', 618)" onmouseover="showTip(event, 'fs66', 618)" class="p">Render</span>(<span onmouseout="hideTip(event, 'fs153', 619)" onmouseover="showTip(event, 'fs153', 619)" class="i">action</span>,<span onmouseout="hideTip(event, 'fs134', 620)" onmouseover="showTip(event, 'fs134', 620)" class="i">p</span>) <span class="k">-&gt;</span> 
                    <span class="c">// do the actual work</span>
                    <span onmouseout="hideTip(event, 'fs133', 621)" onmouseover="showTip(event, 'fs133', 621)" class="f">hitPrimitive</span> <span onmouseout="hideTip(event, 'fs134', 622)" onmouseover="showTip(event, 'fs134', 622)" class="i">p</span> <span onmouseout="hideTip(event, 'fs149', 623)" onmouseover="showTip(event, 'fs149', 623)" class="i">state</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs114', 624)" onmouseover="showTip(event, 'fs114', 624)" class="i">trafo</span> <span onmouseout="hideTip(event, 'fs146', 625)" onmouseover="showTip(event, 'fs146', 625)" class="i">r</span> <span onmouseout="hideTip(event, 'fs153', 626)" onmouseover="showTip(event, 'fs153', 626)" class="i">action</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs147', 627)" onmouseover="showTip(event, 'fs147', 627)" class="i">s</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs148', 628)" onmouseover="showTip(event, 'fs148', 628)" class="f">go</span> { <span class="i">trafo</span> <span class="o">=</span> <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Identity</span>; <span class="i">color</span> <span class="o">=</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> } <span class="k">with</span>
            | [] <span class="k">-&gt;</span> []
            | <span onmouseout="hideTip(event, 'fs154', 629)" onmouseover="showTip(event, 'fs154', 629)" class="i">xs</span> <span class="k">-&gt;</span> 
                <span class="c">// sort PickOperations by camera distance</span>
                <span onmouseout="hideTip(event, 'fs154', 630)" onmouseover="showTip(event, 'fs154', 630)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 631)" onmouseover="showTip(event, 'fs37', 631)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs155', 632)" onmouseover="showTip(event, 'fs155', 632)" class="f">filter</span> (<span onmouseout="hideTip(event, 'fs156', 633)" onmouseover="showTip(event, 'fs156', 633)" class="f">not</span> <span class="o">&lt;&lt;</span> <span onmouseout="hideTip(event, 'fs37', 634)" onmouseover="showTip(event, 'fs37', 634)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs157', 635)" onmouseover="showTip(event, 'fs157', 635)" class="f">isEmpty</span> <span class="o">&lt;&lt;</span> <span onmouseout="hideTip(event, 'fs158', 636)" onmouseover="showTip(event, 'fs158', 636)" class="f">snd</span>) <span class="o">|&gt;</span>  <span onmouseout="hideTip(event, 'fs37', 637)" onmouseover="showTip(event, 'fs37', 637)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs159', 638)" onmouseover="showTip(event, 'fs159', 638)" class="f">sortBy</span> <span onmouseout="hideTip(event, 'fs160', 639)" onmouseover="showTip(event, 'fs160', 639)" class="f">fst</span> 
</code></pre></td>
</tr>
</table>
<p>Up to now, all presented functions are pure! For running the application, however, we need one single (!) side effecting function.</p>
<p>In Aardvark.Rendering Scene Graphs are compiled into an IRenderTask. This is then assigned to an IRenderControl, which displays the result.</p>
<p>The following code runs the evaluation of Elm-style program logic (the "Elm loop"), and attaches the 3D app to a IRenderControl.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 640)" onmouseover="showTip(event, 'fs2', 640)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 641)" onmouseover="showTip(event, 'fs3', 641)" class="i">Base</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs161', 642)" onmouseover="showTip(event, 'fs161', 642)" class="i">Incremental</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 643)" onmouseover="showTip(event, 'fs2', 643)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 644)" onmouseover="showTip(event, 'fs112', 644)" class="i">SceneGraph</span>

<span class="c">// note: this function contains side effects. we just left the functional programming world!</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs162', 645)" onmouseover="showTip(event, 'fs162', 645)" class="f">createApp</span> (<span onmouseout="hideTip(event, 'fs163', 646)" onmouseover="showTip(event, 'fs163', 646)" class="i">ctrl</span> <span class="o">:</span> <span class="i">IRenderControl</span>) (<span onmouseout="hideTip(event, 'fs164', 647)" onmouseover="showTip(event, 'fs164', 647)" class="i">camera</span> <span class="o">:</span> <span class="i">IMod</span><span class="o">&lt;</span><span class="i">Camera</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs165', 648)" onmouseover="showTip(event, 'fs165', 648)" class="i">app</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs100', 649)" onmouseover="showTip(event, 'fs100', 649)" class="t">App</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">model</span>,<span class="o">&#39;</span><span class="i">msg</span>, <span onmouseout="hideTip(event, 'fs62', 650)" onmouseover="showTip(event, 'fs62', 650)" class="t">Scene</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>) <span class="o">=</span> 

    <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs166', 651)" onmouseover="showTip(event, 'fs166', 651)" class="v">model</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs165', 652)" onmouseover="showTip(event, 'fs165', 652)" class="i">app</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 653)" onmouseover="showTip(event, 'fs101', 653)" class="i">initial</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs167', 654)" onmouseover="showTip(event, 'fs167', 654)" class="i">view</span> <span class="o">=</span> <span class="i">Mod</span><span class="o">.</span><span class="i">init</span> (<span onmouseout="hideTip(event, 'fs165', 655)" onmouseover="showTip(event, 'fs165', 655)" class="i">app</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs168', 656)" onmouseover="showTip(event, 'fs168', 656)" class="i">view</span> <span onmouseout="hideTip(event, 'fs166', 657)" onmouseover="showTip(event, 'fs166', 657)" class="i">model</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs169', 658)" onmouseover="showTip(event, 'fs169', 658)" class="i">sceneGraph</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs167', 659)" onmouseover="showTip(event, 'fs167', 659)" class="i">view</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">map</span> <span onmouseout="hideTip(event, 'fs170', 660)" onmouseover="showTip(event, 'fs170', 660)" class="i">ConvertToSceneGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs116', 661)" onmouseover="showTip(event, 'fs116', 661)" class="i">toSg</span> <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">dynamic</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs171', 662)" onmouseover="showTip(event, 'fs171', 662)" class="f">updateScene</span> (<span onmouseout="hideTip(event, 'fs172', 663)" onmouseover="showTip(event, 'fs172', 663)" class="i">m</span> <span class="o">:</span> <span class="o">&#39;</span><span onmouseout="hideTip(event, 'fs166', 664)" onmouseover="showTip(event, 'fs166', 664)" class="i">model</span>)  <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs173', 665)" onmouseover="showTip(event, 'fs173', 665)" class="i">newView</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs165', 666)" onmouseover="showTip(event, 'fs165', 666)" class="i">app</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs168', 667)" onmouseover="showTip(event, 'fs168', 667)" class="i">view</span> <span onmouseout="hideTip(event, 'fs172', 668)" onmouseover="showTip(event, 'fs172', 668)" class="i">m</span>
        <span class="i">transact</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> 
            <span onmouseout="hideTip(event, 'fs167', 669)" onmouseover="showTip(event, 'fs167', 669)" class="i">view</span><span class="o">.</span><span class="i">Value</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs173', 670)" onmouseover="showTip(event, 'fs173', 670)" class="i">newView</span>
        )

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs174', 671)" onmouseover="showTip(event, 'fs174', 671)" class="f">handleMouseEvent</span> (<span onmouseout="hideTip(event, 'fs175', 672)" onmouseover="showTip(event, 'fs175', 672)" class="f">createEvent</span> <span class="o">:</span> <span class="i">V3d</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs58', 673)" onmouseover="showTip(event, 'fs58', 673)" class="t">MouseEvent</span>) <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs136', 674)" onmouseover="showTip(event, 'fs136', 674)" class="i">ray</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs163', 675)" onmouseover="showTip(event, 'fs163', 675)" class="i">ctrl</span><span class="o">.</span><span class="i">Mouse</span><span class="o">.</span><span class="i">Position</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">force</span>  <span class="o">|&gt;</span> <span class="i">Camera</span><span class="o">.</span><span class="i">pickRay</span> (<span onmouseout="hideTip(event, 'fs164', 676)" onmouseover="showTip(event, 'fs164', 676)" class="i">camera</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">force</span>) 
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs176', 677)" onmouseover="showTip(event, 'fs176', 677)" class="t">Picking</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs145', 678)" onmouseover="showTip(event, 'fs145', 678)" class="f">pick</span> <span onmouseout="hideTip(event, 'fs136', 679)" onmouseover="showTip(event, 'fs136', 679)" class="i">ray</span> <span onmouseout="hideTip(event, 'fs167', 680)" onmouseover="showTip(event, 'fs167', 680)" class="i">view</span><span class="o">.</span><span class="i">Value</span> <span class="k">with</span>
            | [] <span class="k">-&gt;</span> ()
            | (<span onmouseout="hideTip(event, 'fs177', 681)" onmouseover="showTip(event, 'fs177', 681)" class="i">d</span>,<span onmouseout="hideTip(event, 'fs178', 682)" onmouseover="showTip(event, 'fs178', 682)" class="i">f</span>)<span class="o">::</span>_ <span class="k">-&gt;</span> 
                <span class="k">for</span> <span onmouseout="hideTip(event, 'fs179', 683)" onmouseover="showTip(event, 'fs179', 683)" class="f">msg</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs178', 684)" onmouseover="showTip(event, 'fs178', 684)" class="i">f</span> <span class="k">do</span>
                    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs179', 685)" onmouseover="showTip(event, 'fs179', 685)" class="f">msg</span> (<span onmouseout="hideTip(event, 'fs175', 686)" onmouseover="showTip(event, 'fs175', 686)" class="f">createEvent</span> (<span onmouseout="hideTip(event, 'fs136', 687)" onmouseover="showTip(event, 'fs136', 687)" class="i">ray</span><span class="o">.</span><span class="i">GetPointOnRay</span> <span onmouseout="hideTip(event, 'fs177', 688)" onmouseover="showTip(event, 'fs177', 688)" class="i">d</span>)) <span class="k">with</span>
                        | <span onmouseout="hideTip(event, 'fs42', 689)" onmouseover="showTip(event, 'fs42', 689)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs180', 690)" onmouseover="showTip(event, 'fs180', 690)" class="i">r</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs166', 691)" onmouseover="showTip(event, 'fs166', 691)" class="v">model</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs165', 692)" onmouseover="showTip(event, 'fs165', 692)" class="i">app</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs102', 693)" onmouseover="showTip(event, 'fs102', 693)" class="i">update</span> <span onmouseout="hideTip(event, 'fs166', 694)" onmouseover="showTip(event, 'fs166', 694)" class="v">model</span> <span onmouseout="hideTip(event, 'fs180', 695)" onmouseover="showTip(event, 'fs180', 695)" class="i">r</span>
                        | _ <span class="k">-&gt;</span> ()
        <span onmouseout="hideTip(event, 'fs171', 696)" onmouseover="showTip(event, 'fs171', 696)" class="f">updateScene</span> <span onmouseout="hideTip(event, 'fs166', 697)" onmouseover="showTip(event, 'fs166', 697)" class="v">model</span> 

    <span onmouseout="hideTip(event, 'fs163', 698)" onmouseover="showTip(event, 'fs163', 698)" class="i">ctrl</span><span class="o">.</span><span class="i">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 699)" onmouseover="showTip(event, 'fs59', 699)" class="i">Move</span><span class="o">.</span><span class="i">Values</span><span class="o">.</span><span class="i">Add</span>(<span class="k">fun</span> _<span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs174', 700)" onmouseover="showTip(event, 'fs174', 700)" class="i">handleMouseEvent</span> <span onmouseout="hideTip(event, 'fs58', 701)" onmouseover="showTip(event, 'fs58', 701)" class="i">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 702)" onmouseover="showTip(event, 'fs59', 702)" class="i">Move</span>) 
    <span onmouseout="hideTip(event, 'fs163', 703)" onmouseover="showTip(event, 'fs163', 703)" class="i">ctrl</span><span class="o">.</span><span class="i">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 704)" onmouseover="showTip(event, 'fs60', 704)" class="i">Down</span><span class="o">.</span><span class="i">Values</span><span class="o">.</span><span class="i">Add</span>(<span class="k">fun</span> <span class="i">p</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs174', 705)" onmouseover="showTip(event, 'fs174', 705)" class="i">handleMouseEvent</span> ((<span class="i">curry</span> <span onmouseout="hideTip(event, 'fs58', 706)" onmouseover="showTip(event, 'fs58', 706)" class="i">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 707)" onmouseover="showTip(event, 'fs60', 707)" class="i">Down</span>) <span class="i">p</span>))
	
    <span onmouseout="hideTip(event, 'fs169', 708)" onmouseover="showTip(event, 'fs169', 708)" class="i">sceneGraph</span>
</code></pre></td>
</tr>
</table>
<p>This concludes our first implementation. Let us try to run our app:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 709)" onmouseover="showTip(event, 'fs2', 709)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 710)" onmouseover="showTip(event, 'fs3', 710)" class="i">Base</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs181', 711)" onmouseover="showTip(event, 'fs181', 711)" class="i">Rendering</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 712)" onmouseover="showTip(event, 'fs2', 712)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs57', 713)" onmouseover="showTip(event, 'fs57', 713)" class="i">Application</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs182', 714)" onmouseover="showTip(event, 'fs182', 714)" class="i">WinForms</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs183', 715)" onmouseover="showTip(event, 'fs183', 715)" class="i">app</span> <span class="o">=</span> <span class="k">new</span> <span class="i">OpenGlApplication</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs184', 716)" onmouseover="showTip(event, 'fs184', 716)" class="i">win</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs183', 717)" onmouseover="showTip(event, 'fs183', 717)" class="i">app</span><span class="o">.</span><span class="i">CreateSimpleRenderWindow</span>()

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs185', 718)" onmouseover="showTip(event, 'fs185', 718)" class="i">frustum</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs184', 719)" onmouseover="showTip(event, 'fs184', 719)" class="i">win</span><span class="o">.</span><span class="i">Sizes</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">map</span> (<span class="k">fun</span> <span class="i">s</span> <span class="k">-&gt;</span> <span class="i">Frustum</span><span class="o">.</span><span class="i">perspective</span> <span class="n">60.0</span> <span class="n">0.1</span> <span class="n">10.0</span> (<span onmouseout="hideTip(event, 'fs15', 720)" onmouseover="showTip(event, 'fs15', 720)" class="i">float</span> <span class="i">s</span><span class="o">.</span><span class="i">X</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs15', 721)" onmouseover="showTip(event, 'fs15', 721)" class="i">float</span> <span class="i">s</span><span class="o">.</span><span class="i">Y</span>))
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs186', 722)" onmouseover="showTip(event, 'fs186', 722)" class="i">cameraView</span> <span class="o">=</span> <span class="i">CameraView</span><span class="o">.</span><span class="i">lookAt</span> (<span class="i">V3d</span><span class="o">.</span><span class="i">III</span><span class="o">*</span><span class="n">3.0</span>) <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs187', 723)" onmouseover="showTip(event, 'fs187', 723)" class="i">camera</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs185', 724)" onmouseover="showTip(event, 'fs185', 724)" class="i">frustum</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">map</span> (<span class="k">fun</span> <span class="i">f</span> <span class="k">-&gt;</span> <span class="i">Camera</span><span class="o">.</span><span class="i">create</span> <span onmouseout="hideTip(event, 'fs186', 725)" onmouseover="showTip(event, 'fs186', 725)" class="i">cameraView</span> <span class="i">f</span>) 

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs188', 726)" onmouseover="showTip(event, 'fs188', 726)" class="i">sg</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs162', 727)" onmouseover="showTip(event, 'fs162', 727)" class="f">createApp</span> <span onmouseout="hideTip(event, 'fs184', 728)" onmouseover="showTip(event, 'fs184', 728)" class="i">win</span> <span onmouseout="hideTip(event, 'fs187', 729)" onmouseover="showTip(event, 'fs187', 729)" class="i">camera</span> <span onmouseout="hideTip(event, 'fs110', 730)" onmouseover="showTip(event, 'fs110', 730)" class="i">drawingApp</span>

<span onmouseout="hideTip(event, 'fs184', 731)" onmouseover="showTip(event, 'fs184', 731)" class="i">win</span><span class="o">.</span><span class="i">RenderTask</span> <span class="o">&lt;-</span> 
    <span onmouseout="hideTip(event, 'fs184', 732)" onmouseover="showTip(event, 'fs184', 732)" class="i">win</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs189', 733)" onmouseover="showTip(event, 'fs189', 733)" class="i">Runtime</span><span class="o">.</span><span class="i">CompileRender</span>(<span onmouseout="hideTip(event, 'fs184', 734)" onmouseover="showTip(event, 'fs184', 734)" class="i">win</span><span class="o">.</span><span class="i">FramebufferSignature</span>,
        <span onmouseout="hideTip(event, 'fs188', 735)" onmouseover="showTip(event, 'fs188', 735)" class="i">sg</span> 
         <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span class="i">effect</span> [<span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">trafo</span> <span class="o">|&gt;</span> <span class="i">toEffect</span>; <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">simpleLighting</span> <span class="o">|&gt;</span> <span class="i">toEffect</span>]
    )

<span onmouseout="hideTip(event, 'fs184', 736)" onmouseover="showTip(event, 'fs184', 736)" class="i">win</span><span class="o">.</span><span class="i">Run</span>()
</code></pre></td>
</tr>
</table>
<h2>Comparison to Related Work and Analysis of the Approach</h2>
<p>In interactive graphics applications, the common approach is to map the domain model into some domain specific representation.
Whenever a user input and the associated interactions lead to changes in the model, those changes need to be applied
to the application state and the graphics representation (e.g. the scene graph).
This approach puts the burden of synchronizing application state and graphics state on the application programmer, as found by
<a href="https://www.cg.tuwien.ac.at/courses/RendEng/RendEng-2015-11-16-paper1.pdf">Tobler 2011</a>.</p>
<p>Where does the synchronization code go? There are basically two approaches:</p>
<ul>
<li>Move all state including domain logic into the scene representation</li>
<li>Store deep references into the graphics representation and modify them on change</li>
</ul>
<p>In Tobler's work, a semantic scene graph serves as model, and a rendering scene graph (view), including rendering state, is generated on the fly while traversing the semantic graph. Since the semantic scene graph serves as domain model description language, all domain modelling needs do be done directly in the semantic scene graph.</p>
<p>However versatile, domain logic which is not easily implemented as graph traversal poses difficulties.</p>
<p>In particular, cross cutting concerns (e.g. game objects need to modify other game objects far away in the graph) result in a lot of graph searching for the appropriate nodes. When optimizing away this search effort, the scene representation approach gradually converges toward the reference-keeping approach. Graphics entities, or global state, increasingly keep references on modifiable cells in order to be able to update those immediately.</p>
<p>The main subject of our design pattern is to not use any graphics specific state at all. The graphics representation is entirely recomputed after each domain model modification instead. This completely eliminates the need to track state in the graphics representation, but the trivial implementation is very inefficent.</p>
<p>Can this model be implemented efficiently?</p>
<h2>Towards an efficient implementation</h2>
<p>Let us summarize how our Elm-style polygon-sketching application performs updates. First, we apply the view function to the initial model, producing a value of type <code>Scene&lt;_&gt;</code>. Next, we use a subscription on potential mouse events, which, when fired, traverses the scene and collects all potential <code>PickOperations</code>. Each pick operation potentially yields a message, which is fed into the update function, which recomputes the model.</p>
<p>Feeding back this model to our view function ties the knot. We receive our final interaction loop.</p>
<p>Let us investigate the involved functions and their runtime behavior:</p>
<ul>
<li><code>view</code> is linear in the size of the model (independent of the real change).</li>
<li>in the worst case, each <code>update</code> message touches every single entity in the model, resulting in linear runtime. In that case, the change really is of that size, i.e. a mutable update has <code>O(n)</code> as well.  In practise however, operations often affect a single value deeply nested in the immutable structure, resulting in logarithmic runtime and memory cost. Accordingly, for updating immutable domain models we achieve <code>log(n)</code> blowup compared to a mutable implementation.</li>
</ul>
<p>Update cannot be optimized in the purely functional case.</p>
<p>Looking at the view function, however, we identify that the function is repeatedly invoked with an almost identical input.</p>
<h3>Incremental Evaluation helps they said</h3>
<p>Incremental evaluation, as used in Aardvark, can be used to incrementalize purely functional algorithms.
Conforming to the provided API, all inputs need to be wrapped into ModRef<_> cells.  Given a set of modifiable input cells, functions can be implemented by utilizing combinator functions, such as Mod.map or the <code>adaptive</code> Computation Expression. These functions become agnostic to input value changes:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Adaptively compute scene for input value of type cursor</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs190', 737)" onmouseover="showTip(event, 'fs190', 737)" class="f">cursorGeometry</span> (<span onmouseout="hideTip(event, 'fs191', 738)" onmouseover="showTip(event, 'fs191', 738)" class="i">hasCursor</span> <span class="o">:</span> <span class="i">IMod</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs9', 739)" onmouseover="showTip(event, 'fs9', 739)" class="i">Option</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span><span class="o">&gt;</span>) <span class="o">:</span> <span class="i">IMod</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs5', 740)" onmouseover="showTip(event, 'fs5', 740)" class="i">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs62', 741)" onmouseover="showTip(event, 'fs62', 741)" class="i">Scene</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs48', 742)" onmouseover="showTip(event, 'fs48', 742)" class="i">DrawCommand</span><span class="o">&gt;</span><span class="o">&gt;</span><span class="o">&gt;</span> <span class="o">=</span> 
    <span class="i">adaptive</span> {
            <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs191', 743)" onmouseover="showTip(event, 'fs191', 743)" class="i">hasCursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs191', 744)" onmouseover="showTip(event, 'fs191', 744)" class="i">hasCursor</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs191', 745)" onmouseover="showTip(event, 'fs191', 745)" class="i">hasCursor</span> <span class="k">with</span>    
                | <span onmouseout="hideTip(event, 'fs41', 746)" onmouseover="showTip(event, 'fs41', 746)" class="i">None</span> <span class="k">-&gt;</span> <span class="k">return</span> []
                | <span onmouseout="hideTip(event, 'fs42', 747)" onmouseover="showTip(event, 'fs42', 747)" class="i">Some</span> <span class="i">c</span> <span class="k">-&gt;</span> 
                   <span class="k">return</span> [[ <span onmouseout="hideTip(event, 'fs14', 748)" onmouseover="showTip(event, 'fs14', 748)" class="i">Sphere</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span class="n">0.1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs77', 749)" onmouseover="showTip(event, 'fs77', 749)" class="i">render</span> <span onmouseout="hideTip(event, 'fs108', 750)" onmouseover="showTip(event, 'fs108', 750)" class="i">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs105', 751)" onmouseover="showTip(event, 'fs105', 751)" class="i">ignore</span> ] 
                            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs76', 752)" onmouseover="showTip(event, 'fs76', 752)" class="i">colored</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Red</span>
                            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs70', 753)" onmouseover="showTip(event, 'fs70', 753)" class="i">transform&#39;</span> (<span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span>(<span class="i">c</span>))]
    }

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs192', 754)" onmouseover="showTip(event, 'fs192', 754)" class="i">hasCursor</span> <span class="o">=</span> <span class="i">Mod</span><span class="o">.</span><span class="i">init</span> <span onmouseout="hideTip(event, 'fs41', 755)" onmouseover="showTip(event, 'fs41', 755)" class="i">None</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs193', 756)" onmouseover="showTip(event, 'fs193', 756)" class="i">adaptiveScene</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs190', 757)" onmouseover="showTip(event, 'fs190', 757)" class="f">cursorGeometry</span> <span onmouseout="hideTip(event, 'fs192', 758)" onmouseover="showTip(event, 'fs192', 758)" class="i">hasCursor</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs194', 759)" onmouseover="showTip(event, 'fs194', 759)" class="i">sceneWithDisabledCursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs193', 760)" onmouseover="showTip(event, 'fs193', 760)" class="i">adaptiveScene</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">force</span> <span class="c">// compute scene with current input state</span>
<span class="i">transact</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs192', 761)" onmouseover="showTip(event, 'fs192', 761)" class="i">hasCursor</span><span class="o">.</span><span class="i">Value</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs42', 762)" onmouseover="showTip(event, 'fs42', 762)" class="i">Some</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span>) <span class="c">// change input state to have a cursor</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs195', 763)" onmouseover="showTip(event, 'fs195', 763)" class="i">sceneWithCursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs193', 764)" onmouseover="showTip(event, 'fs193', 764)" class="i">adaptiveScene</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">force</span> <span class="c">// compute scene with current input state</span>
</code></pre></td>
</tr>
</table>
<p>From a high level perspective, our incremental system has the following features:</p>
<ul>
<li>Inputs can be defined as modifiable cells</li>
<li>Purely functional algorithms can be formulated on top of such modifiable cells</li>
<li>The outpus of the algorithm can be computed by using Mod.force</li>
<li>The inputs can be changed by using transact. Subsequent calls to Mod.force will return a value consistent with the current input values.</li>
</ul>
<p>Thus, incremental evaluation does NOT provide us with a solution to our view function efficiency problem. We are working with purely functional input data. The entire domain model is new after a modification, meaning that our inputs alone will never be modified without everything else. This makes incremental evaluation infeasible.</p>
<p>As we discovered in practise, incremental evaluation can greatly speed up rendering performance. However, from an engineering point of view, programs quickly become large and interactions between various value changes complex (comparable to callback hell).</p>
<p>In order to utilize incremental evaluation, we need to map our purely functional model to a modifiable one. This allows us to perform updates as specific, targeted changes, which in turn can be used by the incremental evaluation system.</p>
<p>Mapping immutable values to mutable data sounds plausible. But where should this conversion occur?</p>
<p>While fablish and web frameworks use immutable data until the final rendering phase, we chose to map immutable values to mutable data prior to scene description generation. The rationale behind this is:</p>
<ul>
<li>The domain model is relatively small compared to a scene description. Working with a mutable scene description is more efficient.</li>
<li>Typically, domain models are built on simple datatypes consisting of records and similar things. These might be easier to work with than general purpose scene descriptions.</li>
</ul>
<h3>Unpersisting data structures</h3>
<p>Consider the transition of a record from immtuable to modifiable:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Immutable data we would like to work on</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs196', 765)" onmouseover="showTip(event, 'fs196', 765)" class="t">ImmutableData1</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs197', 766)" onmouseover="showTip(event, 'fs197', 766)" class="i">value</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs198', 767)" onmouseover="showTip(event, 'fs198', 767)" class="t">int</span> }
<span class="c">// Modifiable data the rendering system would like to work on</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs199', 768)" onmouseover="showTip(event, 'fs199', 768)" class="t">MutableData1</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs200', 769)" onmouseover="showTip(event, 'fs200', 769)" class="i">mvalue</span> <span class="o">:</span> <span class="i">IModRef</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs198', 770)" onmouseover="showTip(event, 'fs198', 770)" class="i">int</span><span class="o">&gt;</span> }
</code></pre></td>
</tr>
</table>
<p>ImmutableData1 and MutableData1 are structurally equal, with all leaf fields wrapped into modifiable cells.  //what? please rephrase.</p>
<p>How can we implement a procedure that applies immutable data changes into the mutable variant as update?</p>
<p>When immutable changes are detected, updates must be performed onto the according mutable fields. For records containing primitive values, the procedure boils down to traversing the data structure and applying new values to their mutable counterparts.</p>
<p>The problem arises with set data structures. In order to associate old entries in the mutable
data with new values in the immutable set, some artificial references need to be introduced.</p>
<p>In this setup we propose to use integer values wrapped in a container class:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">IDs</span> <span class="o">=</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 771)" onmouseover="showTip(event, 'fs1', 771)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs201', 772)" onmouseover="showTip(event, 'fs201', 772)" class="i">Threading</span> <span class="c">// for Interlocked.Increment</span>

    [&lt;<span onmouseout="hideTip(event, 'fs202', 773)" onmouseover="showTip(event, 'fs202', 773)" class="t">AllowNullLiteral</span>&gt;]
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs203', 774)" onmouseover="showTip(event, 'fs203', 774)" class="f">Id</span>() <span class="o">=</span>
        <span class="k">static</span> <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs204', 775)" onmouseover="showTip(event, 'fs204', 775)" class="v">current</span> <span class="o">=</span> <span class="n">0</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs205', 776)" onmouseover="showTip(event, 'fs205', 776)" class="i">id</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs206', 777)" onmouseover="showTip(event, 'fs206', 777)" class="t">Interlocked</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs207', 778)" onmouseover="showTip(event, 'fs207', 778)" class="f">Increment</span>(<span class="o">&amp;</span><span onmouseout="hideTip(event, 'fs204', 779)" onmouseover="showTip(event, 'fs204', 779)" class="v">current</span>)
        <span class="k">static</span> <span class="k">member</span> <span onmouseout="hideTip(event, 'fs208', 780)" onmouseover="showTip(event, 'fs208', 780)" class="i">New</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs203', 781)" onmouseover="showTip(event, 'fs203', 781)" class="t">Id</span>()
        <span class="k">override</span> <span onmouseout="hideTip(event, 'fs209', 782)" onmouseover="showTip(event, 'fs209', 782)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs210', 783)" onmouseover="showTip(event, 'fs210', 783)" class="f">ToString</span>() <span class="o">=</span> <span onmouseout="hideTip(event, 'fs211', 784)" onmouseover="showTip(event, 'fs211', 784)" class="f">sprintf</span> <span class="s">&quot;Id </span><span class="pf">%d</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs205', 785)" onmouseover="showTip(event, 'fs205', 785)" class="i">id</span>
</code></pre></td>
</tr>
</table>
<p>Let us now derive immutable and mutable models for our polygon-sketching app:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs212', 786)" onmouseover="showTip(event, 'fs212', 786)" class="t">OpenPolygon2</span> <span class="o">=</span> {    
    <span onmouseout="hideTip(event, 'fs213', 787)" onmouseover="showTip(event, 'fs213', 787)" class="i">finishedPolys</span>  <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 788)" onmouseover="showTip(event, 'fs5', 788)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span> 
    <span onmouseout="hideTip(event, 'fs214', 789)" onmouseover="showTip(event, 'fs214', 789)" class="i">cursor</span>         <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 790)" onmouseover="showTip(event, 'fs9', 790)" class="t">Option</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span> 
} 

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs215', 791)" onmouseover="showTip(event, 'fs215', 791)" class="t">DrawingModel2</span> <span class="o">=</span> {
    <span onmouseout="hideTip(event, 'fs216', 792)" onmouseover="showTip(event, 'fs216', 792)" class="i">id</span> <span class="o">:</span> <span class="i">Id</span>
    <span onmouseout="hideTip(event, 'fs217', 793)" onmouseover="showTip(event, 'fs217', 793)" class="i">finished</span> <span class="o">:</span> <span class="i">pset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs4', 794)" onmouseover="showTip(event, 'fs4', 794)" class="i">Polygon</span><span class="o">&gt;</span>
    <span onmouseout="hideTip(event, 'fs218', 795)" onmouseover="showTip(event, 'fs218', 795)" class="i">working</span>  <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 796)" onmouseover="showTip(event, 'fs9', 796)" class="t">Option</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs6', 797)" onmouseover="showTip(event, 'fs6', 797)" class="t">OpenPolygon</span><span class="o">&gt;</span>
} 

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs219', 798)" onmouseover="showTip(event, 'fs219', 798)" class="t">MDrawingModel2</span> <span class="o">=</span> {
    <span onmouseout="hideTip(event, 'fs220', 799)" onmouseover="showTip(event, 'fs220', 799)" class="i">original</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs215', 800)" onmouseover="showTip(event, 'fs215', 800)" class="t">DrawingModel2</span>
    <span onmouseout="hideTip(event, 'fs221', 801)" onmouseover="showTip(event, 'fs221', 801)" class="i">finished</span> <span class="o">:</span> <span class="i">cset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs4', 802)" onmouseover="showTip(event, 'fs4', 802)" class="i">Polygon</span><span class="o">&gt;</span> 
    <span onmouseout="hideTip(event, 'fs222', 803)" onmouseover="showTip(event, 'fs222', 803)" class="i">working</span>  <span class="o">:</span> <span class="i">ModRef</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs9', 804)" onmouseover="showTip(event, 'fs9', 804)" class="i">Option</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs6', 805)" onmouseover="showTip(event, 'fs6', 805)" class="i">OpenPolygon</span><span class="o">&gt;</span><span class="o">&gt;</span>
}

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs223', 806)" onmouseover="showTip(event, 'fs223', 806)" class="f">unpersist</span> (<span onmouseout="hideTip(event, 'fs224', 807)" onmouseover="showTip(event, 'fs224', 807)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs215', 808)" onmouseover="showTip(event, 'fs215', 808)" class="t">DrawingModel2</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs219', 809)" onmouseover="showTip(event, 'fs219', 809)" class="t">MDrawingModel2</span> <span class="o">=</span>
    {
        <span class="i">original</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs224', 810)" onmouseover="showTip(event, 'fs224', 810)" class="i">m</span>
        <span class="i">finished</span> <span class="o">=</span> <span class="i">CSet</span><span class="o">.</span><span class="i">ofSeq</span> <span onmouseout="hideTip(event, 'fs224', 811)" onmouseover="showTip(event, 'fs224', 811)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs217', 812)" onmouseover="showTip(event, 'fs217', 812)" class="i">finished</span>
        <span class="i">working</span> <span class="o">=</span> <span class="i">Mod</span><span class="o">.</span><span class="i">init</span> <span onmouseout="hideTip(event, 'fs224', 813)" onmouseover="showTip(event, 'fs224', 813)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs218', 814)" onmouseover="showTip(event, 'fs218', 814)" class="i">working</span>
    }

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs225', 815)" onmouseover="showTip(event, 'fs225', 815)" class="f">apply</span> (<span onmouseout="hideTip(event, 'fs226', 816)" onmouseover="showTip(event, 'fs226', 816)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs219', 817)" onmouseover="showTip(event, 'fs219', 817)" class="t">MDrawingModel2</span>) (<span onmouseout="hideTip(event, 'fs227', 818)" onmouseover="showTip(event, 'fs227', 818)" class="i">newModel</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs215', 819)" onmouseover="showTip(event, 'fs215', 819)" class="t">DrawingModel2</span>) <span class="o">=</span>
    <span class="i">transact</span> (<span class="k">fun</span> _ <span class="k">-&gt;</span> 
        <span class="k">let</span> <span class="i">added</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs227', 820)" onmouseover="showTip(event, 'fs227', 820)" class="i">newModel</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs217', 821)" onmouseover="showTip(event, 'fs217', 821)" class="i">finished</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 822)" onmouseover="showTip(event, 'fs122', 822)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs228', 823)" onmouseover="showTip(event, 'fs228', 823)" class="i">filter</span> (<span onmouseout="hideTip(event, 'fs156', 824)" onmouseover="showTip(event, 'fs156', 824)" class="i">not</span> <span class="o">&lt;&lt;</span> <span onmouseout="hideTip(event, 'fs226', 825)" onmouseover="showTip(event, 'fs226', 825)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs221', 826)" onmouseover="showTip(event, 'fs221', 826)" class="i">finished</span><span class="o">.</span><span class="i">Contains</span>)
        <span class="k">let</span> <span class="i">removed</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs226', 827)" onmouseover="showTip(event, 'fs226', 827)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs221', 828)" onmouseover="showTip(event, 'fs221', 828)" class="i">finished</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs122', 829)" onmouseover="showTip(event, 'fs122', 829)" class="i">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs228', 830)" onmouseover="showTip(event, 'fs228', 830)" class="i">filter</span>  (<span onmouseout="hideTip(event, 'fs156', 831)" onmouseover="showTip(event, 'fs156', 831)" class="i">not</span> <span class="o">&lt;&lt;</span> <span onmouseout="hideTip(event, 'fs227', 832)" onmouseover="showTip(event, 'fs227', 832)" class="i">newModel</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs217', 833)" onmouseover="showTip(event, 'fs217', 833)" class="i">finished</span><span class="o">.</span><span class="i">Contains</span>)
        <span class="k">for</span> <span class="i">add</span> <span class="k">in</span> <span class="i">added</span> <span class="k">do</span> <span onmouseout="hideTip(event, 'fs226', 834)" onmouseover="showTip(event, 'fs226', 834)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs221', 835)" onmouseover="showTip(event, 'fs221', 835)" class="i">finished</span><span class="o">.</span><span class="i">Add</span> <span class="i">add</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs229', 836)" onmouseover="showTip(event, 'fs229', 836)" class="i">ignore</span>
        <span class="k">for</span> <span class="i">rem</span> <span class="k">in</span> <span class="i">removed</span> <span class="k">do</span> <span onmouseout="hideTip(event, 'fs226', 837)" onmouseover="showTip(event, 'fs226', 837)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs221', 838)" onmouseover="showTip(event, 'fs221', 838)" class="i">finished</span><span class="o">.</span><span class="i">Remove</span> <span class="i">rem</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs229', 839)" onmouseover="showTip(event, 'fs229', 839)" class="i">ignore</span>
        <span class="c">//...</span>
        ()
    )
</code></pre></td>
</tr>
</table>
<p>Such a transformation seems to be rather mechanical. It can be formalized into the following procedure:</p>
<ul>
<li>Equip each immutable domain type with an identifier (to be used for nested changes in sets)</li>
<li>
For each domain type, create an associated mutable version. It contains one extra field which points to the immutable structure, and:
<ul>
<li>for each field which is a domain type, use the mutable variant of the domain type in the mutable version of the parent structure</li>
<li>for each primitive field, create a field which wraps the original value in a Mod</li>
<li>for each field of type set or list, generate a data structure which tracks immutable references and allows to efficiently merge an immutable representation of the set/list into the mutable version</li>
</ul>
</li>
</ul>
<p>This translation sheme can be implemented as compiler plugin. For the sake of completeness we present the compilation result for our drawing model (We use the <code>DomainType</code> attribute as a hint for the plugin to handle this type as domain type):</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
<span class="l">50: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// original user written model</span>
<span class="k">module</span> <span class="t">SimpleDrawingApp</span> <span class="o">=</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs230', 840)" onmouseover="showTip(event, 'fs230', 840)" class="t">Polygon</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 841)" onmouseover="showTip(event, 'fs5', 841)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs231', 842)" onmouseover="showTip(event, 'fs231', 842)" class="t">OpenPolygon</span> <span class="o">=</span> {
        <span onmouseout="hideTip(event, 'fs8', 843)" onmouseover="showTip(event, 'fs8', 843)" class="i">cursor</span>         <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 844)" onmouseover="showTip(event, 'fs9', 844)" class="t">Option</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>
        <span onmouseout="hideTip(event, 'fs7', 845)" onmouseover="showTip(event, 'fs7', 845)" class="i">finishedPoints</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 846)" onmouseover="showTip(event, 'fs5', 846)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>
    }
    
    [&lt;<span class="i">DomainType</span>&gt;]
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs232', 847)" onmouseover="showTip(event, 'fs232', 847)" class="t">Model</span> <span class="o">=</span> {
        <span onmouseout="hideTip(event, 'fs233', 848)" onmouseover="showTip(event, 'fs233', 848)" class="i">finished</span> <span class="o">:</span> <span class="i">pset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs230', 849)" onmouseover="showTip(event, 'fs230', 849)" class="i">Polygon</span><span class="o">&gt;</span>
        <span onmouseout="hideTip(event, 'fs234', 850)" onmouseover="showTip(event, 'fs234', 850)" class="i">working</span>  <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 851)" onmouseover="showTip(event, 'fs9', 851)" class="t">Option</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs231', 852)" onmouseover="showTip(event, 'fs231', 852)" class="t">OpenPolygon</span><span class="o">&gt;</span>
    }

<span class="c">// under-the-hoood compiled variant for the domain model</span>
<span class="k">module</span> <span class="t">SimpleDrawingAppGenerated</span> <span class="o">=</span> 
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs235', 853)" onmouseover="showTip(event, 'fs235', 853)" class="t">Polygon</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 854)" onmouseover="showTip(event, 'fs5', 854)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>
    
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs236', 855)" onmouseover="showTip(event, 'fs236', 855)" class="t">OpenPolygon</span> <span class="o">=</span>  
        { <span onmouseout="hideTip(event, 'fs8', 856)" onmouseover="showTip(event, 'fs8', 856)" class="i">cursor</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 857)" onmouseover="showTip(event, 'fs9', 857)" class="t">Option</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>
          <span onmouseout="hideTip(event, 'fs7', 858)" onmouseover="showTip(event, 'fs7', 858)" class="i">finishedPoints</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 859)" onmouseover="showTip(event, 'fs5', 859)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span> }
    
    [&lt;<span class="i">DomainType</span>&gt;]
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs237', 860)" onmouseover="showTip(event, 'fs237', 860)" class="t">Model</span> <span class="o">=</span> 
        { <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs238', 861)" onmouseover="showTip(event, 'fs238', 861)" class="v">_id</span> <span class="o">:</span> <span class="i">Id</span>
          <span onmouseout="hideTip(event, 'fs233', 862)" onmouseover="showTip(event, 'fs233', 862)" class="i">finished</span> <span class="o">:</span> <span class="i">pset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs235', 863)" onmouseover="showTip(event, 'fs235', 863)" class="i">Polygon</span><span class="o">&gt;</span>
          <span onmouseout="hideTip(event, 'fs234', 864)" onmouseover="showTip(event, 'fs234', 864)" class="i">working</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 865)" onmouseover="showTip(event, 'fs9', 865)" class="t">Option</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs236', 866)" onmouseover="showTip(event, 'fs236', 866)" class="t">OpenPolygon</span><span class="o">&gt;</span> }
        
        <span class="k">member</span> <span onmouseout="hideTip(event, 'fs239', 867)" onmouseover="showTip(event, 'fs239', 867)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs240', 868)" onmouseover="showTip(event, 'fs240', 868)" class="f">ToMod</span>(<span onmouseout="hideTip(event, 'fs241', 869)" onmouseover="showTip(event, 'fs241', 869)" class="i">reuseCache</span> <span class="o">:</span> <span class="i">ReuseCache</span>) <span class="o">=</span> 
            {   <span class="v">_original</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs239', 870)" onmouseover="showTip(event, 'fs239', 870)" class="i">x</span>
                <span class="i">mfinished</span> <span class="o">=</span> <span class="i">ResetSet</span>(<span onmouseout="hideTip(event, 'fs239', 871)" onmouseover="showTip(event, 'fs239', 871)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs233', 872)" onmouseover="showTip(event, 'fs233', 872)" class="i">finished</span>)
                <span class="i">mworking</span> <span class="o">=</span> <span class="i">Mod</span><span class="o">.</span><span class="i">init</span> (<span onmouseout="hideTip(event, 'fs239', 873)" onmouseover="showTip(event, 'fs239', 873)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs234', 874)" onmouseover="showTip(event, 'fs234', 874)" class="i">working</span>) }
        
        <span class="k">interface</span> <span class="i">IUnique</span> <span class="k">with</span>
            
            <span class="k">member</span> <span onmouseout="hideTip(event, 'fs239', 875)" onmouseover="showTip(event, 'fs239', 875)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs242', 876)" onmouseover="showTip(event, 'fs242', 876)" class="i">Id</span> 
                <span class="k">with</span> <span class="i">get</span> () <span class="o">=</span> <span onmouseout="hideTip(event, 'fs239', 877)" onmouseover="showTip(event, 'fs239', 877)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs238', 878)" onmouseover="showTip(event, 'fs238', 878)" class="v">_id</span>
                <span class="k">and</span> <span onmouseout="hideTip(event, 'fs243', 879)" onmouseover="showTip(event, 'fs243', 879)" class="i">set</span> <span onmouseout="hideTip(event, 'fs244', 880)" onmouseover="showTip(event, 'fs244', 880)" class="i">v</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs239', 881)" onmouseover="showTip(event, 'fs239', 881)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs238', 882)" onmouseover="showTip(event, 'fs238', 882)" class="v">_id</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs244', 883)" onmouseover="showTip(event, 'fs244', 883)" class="i">v</span>
    
    <span class="k">and</span> [&lt;<span class="i">DomainType</span>&gt;] <span onmouseout="hideTip(event, 'fs245', 884)" onmouseover="showTip(event, 'fs245', 884)" class="t">MModel</span> <span class="o">=</span> 
        { <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs246', 885)" onmouseover="showTip(event, 'fs246', 885)" class="v">_original</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs237', 886)" onmouseover="showTip(event, 'fs237', 886)" class="t">Model</span>
          <span onmouseout="hideTip(event, 'fs247', 887)" onmouseover="showTip(event, 'fs247', 887)" class="i">mfinished</span> <span class="o">:</span> <span class="i">ResetSet</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs235', 888)" onmouseover="showTip(event, 'fs235', 888)" class="i">Polygon</span><span class="o">&gt;</span>
          <span onmouseout="hideTip(event, 'fs248', 889)" onmouseover="showTip(event, 'fs248', 889)" class="i">mworking</span> <span class="o">:</span> <span class="i">ModRef</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs9', 890)" onmouseover="showTip(event, 'fs9', 890)" class="i">Option</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs236', 891)" onmouseover="showTip(event, 'fs236', 891)" class="i">OpenPolygon</span><span class="o">&gt;</span><span class="o">&gt;</span> }
        <span class="k">member</span> <span onmouseout="hideTip(event, 'fs249', 892)" onmouseover="showTip(event, 'fs249', 892)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs250', 893)" onmouseover="showTip(event, 'fs250', 893)" class="f">Apply</span>(<span onmouseout="hideTip(event, 'fs251', 894)" onmouseover="showTip(event, 'fs251', 894)" class="i">arg0</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs237', 895)" onmouseover="showTip(event, 'fs237', 895)" class="t">Model</span>, <span onmouseout="hideTip(event, 'fs241', 896)" onmouseover="showTip(event, 'fs241', 896)" class="i">reuseCache</span> <span class="o">:</span> <span class="i">ReuseCache</span>) <span class="o">=</span> 
            <span class="k">if</span> <span onmouseout="hideTip(event, 'fs156', 897)" onmouseover="showTip(event, 'fs156', 897)" class="f">not</span> (<span onmouseout="hideTip(event, 'fs1', 898)" onmouseover="showTip(event, 'fs1', 898)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs252', 899)" onmouseover="showTip(event, 'fs252', 899)" class="t">Object</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs253', 900)" onmouseover="showTip(event, 'fs253', 900)" class="f">ReferenceEquals</span>(<span onmouseout="hideTip(event, 'fs251', 901)" onmouseover="showTip(event, 'fs251', 901)" class="i">arg0</span>, <span onmouseout="hideTip(event, 'fs249', 902)" onmouseover="showTip(event, 'fs249', 902)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs246', 903)" onmouseover="showTip(event, 'fs246', 903)" class="v">_original</span>)) <span class="k">then</span> 
                <span onmouseout="hideTip(event, 'fs249', 904)" onmouseover="showTip(event, 'fs249', 904)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs246', 905)" onmouseover="showTip(event, 'fs246', 905)" class="v">_original</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs251', 906)" onmouseover="showTip(event, 'fs251', 906)" class="i">arg0</span>
                <span onmouseout="hideTip(event, 'fs249', 907)" onmouseover="showTip(event, 'fs249', 907)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs247', 908)" onmouseover="showTip(event, 'fs247', 908)" class="i">mfinished</span><span class="o">.</span><span class="i">Update</span>(<span onmouseout="hideTip(event, 'fs251', 909)" onmouseover="showTip(event, 'fs251', 909)" class="i">arg0</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs233', 910)" onmouseover="showTip(event, 'fs233', 910)" class="i">finished</span>)
                <span onmouseout="hideTip(event, 'fs249', 911)" onmouseover="showTip(event, 'fs249', 911)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs248', 912)" onmouseover="showTip(event, 'fs248', 912)" class="i">mworking</span><span class="o">.</span><span class="i">Value</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs251', 913)" onmouseover="showTip(event, 'fs251', 913)" class="i">arg0</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs234', 914)" onmouseover="showTip(event, 'fs234', 914)" class="i">working</span>
</code></pre></td>
</tr>
</table>
<p>The mutable model allows us to implement an incremental variant of the view function.</p>
<p>Our immutable scene representation, as-is, cannot express inner changes efficiently.
As an example, consider the constructor for scene transformations:
<code>val Transform : Trafo3d * seq&lt;Scene1&gt; -&gt; Scene&lt;'msg&gt;</code>
In order to efficiently handle trafo changes, the following signature is required:
<code>val Transform : IMod&lt;Trafo3d&gt; * aset&lt;Scene1&gt; -&gt; Scene&lt;'msg&gt;&gt;</code>
An incremental version of the scene data type can be derived by replacing all immutable values with their modifiable counterparts:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs254', 915)" onmouseover="showTip(event, 'fs254', 915)" class="t">Scene2</span> <span class="o">=</span> 
        | <span onmouseout="hideTip(event, 'fs255', 916)" onmouseover="showTip(event, 'fs255', 916)" class="p">Transform</span> <span class="k">of</span> <span class="i">IMod</span><span class="o">&lt;</span><span class="i">Trafo3d</span><span class="o">&gt;</span> <span class="o">*</span> <span class="i">aset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs254', 917)" onmouseover="showTip(event, 'fs254', 917)" class="i">Scene2</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs256', 918)" onmouseover="showTip(event, 'fs256', 918)" class="p">Colored</span>   <span class="k">of</span> <span class="i">IMod</span><span class="o">&lt;</span><span class="i">C4b</span><span class="o">&gt;</span>     <span class="o">*</span> <span class="i">aset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 919)" onmouseover="showTip(event, 'fs19', 919)" class="i">Scene1</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs257', 920)" onmouseover="showTip(event, 'fs257', 920)" class="p">Render</span>    <span class="k">of</span> <span onmouseout="hideTip(event, 'fs13', 921)" onmouseover="showTip(event, 'fs13', 921)" class="t">Primitive</span> 
        | <span onmouseout="hideTip(event, 'fs258', 922)" onmouseover="showTip(event, 'fs258', 922)" class="p">Group</span>     <span class="k">of</span> <span class="i">aset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 923)" onmouseover="showTip(event, 'fs19', 923)" class="i">Scene1</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>In our implementation, we chose a different representation.</p>
<p>Instead of using a discriminated union, we prefer to use the extensible (regarding data types) OOP approach found in Aardvark.Rendering. We can directly integrate with the Aardvark Scene Graph this way:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">AdaptiveScene</span> <span class="o">=</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 924)" onmouseover="showTip(event, 'fs2', 924)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 925)" onmouseover="showTip(event, 'fs112', 925)" class="i">SceneGraph</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs259', 926)" onmouseover="showTip(event, 'fs259', 926)" class="t">ISg</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">inherit</span> <span onmouseout="hideTip(event, 'fs259', 927)" onmouseover="showTip(event, 'fs259', 927)" class="t">ISg</span> <span class="c">// ISg comes from Aardvark.SceneGraph</span>


    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs260', 928)" onmouseover="showTip(event, 'fs260', 928)" class="t">Group</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs261', 929)" onmouseover="showTip(event, 'fs261', 929)" class="i">xs</span> <span class="o">:</span> <span class="i">aset</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs259', 930)" onmouseover="showTip(event, 'fs259', 930)" class="i">ISg</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>) <span class="o">=</span>
        <span class="k">interface</span> <span onmouseout="hideTip(event, 'fs259', 931)" onmouseover="showTip(event, 'fs259', 931)" class="t">ISg</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>
        <span class="k">interface</span> <span class="i">IGroup</span> <span class="k">with</span>
            <span class="k">member</span> <span onmouseout="hideTip(event, 'fs262', 932)" onmouseover="showTip(event, 'fs262', 932)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs263', 933)" onmouseover="showTip(event, 'fs263', 933)" class="i">Children</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs261', 934)" onmouseover="showTip(event, 'fs261', 934)" class="i">xs</span> <span class="o">|&gt;</span> <span class="i">ASet</span><span class="o">.</span><span class="i">map</span> (<span class="k">fun</span> <span class="i">a</span> <span class="k">-&gt;</span> <span class="i">a</span> <span class="o">:&gt;</span> <span onmouseout="hideTip(event, 'fs259', 935)" onmouseover="showTip(event, 'fs259', 935)" class="i">ISg</span>)
        <span class="k">member</span> <span onmouseout="hideTip(event, 'fs262', 936)" onmouseover="showTip(event, 'fs262', 936)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs264', 937)" onmouseover="showTip(event, 'fs264', 937)" class="i">Children</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs261', 938)" onmouseover="showTip(event, 'fs261', 938)" class="i">xs</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs265', 939)" onmouseover="showTip(event, 'fs265', 939)" class="t">Render</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs266', 940)" onmouseover="showTip(event, 'fs266', 940)" class="i">xs</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs13', 941)" onmouseover="showTip(event, 'fs13', 941)" class="t">Primitive</span>) <span class="o">=</span>
        <span class="k">interface</span> <span onmouseout="hideTip(event, 'fs259', 942)" onmouseover="showTip(event, 'fs259', 942)" class="t">ISg</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>
        <span class="k">member</span> <span onmouseout="hideTip(event, 'fs267', 943)" onmouseover="showTip(event, 'fs267', 943)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs268', 944)" onmouseover="showTip(event, 'fs268', 944)" class="i">Primitive</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs266', 945)" onmouseover="showTip(event, 'fs266', 945)" class="i">xs</span>

    <span class="c">//...</span>
</code></pre></td>
</tr>
</table>
<p>The Aardvark Scene Graph implementation is based on Attribute Grammars. We can extend the Aardvark Scene Graph by defining additional Ag-rules for our types dynamically. We augment our type <code>ISg&lt;'msg&gt;</code> with semantic functions such as:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">AgExtension</span> <span class="o">=</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 946)" onmouseover="showTip(event, 'fs2', 946)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 947)" onmouseover="showTip(event, 'fs3', 947)" class="i">Base</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs269', 948)" onmouseover="showTip(event, 'fs269', 948)" class="i">Ag</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 949)" onmouseover="showTip(event, 'fs2', 949)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs112', 950)" onmouseover="showTip(event, 'fs112', 950)" class="i">SceneGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs270', 951)" onmouseover="showTip(event, 'fs270', 951)" class="i">Semantics</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs271', 952)" onmouseover="showTip(event, 'fs271', 952)" class="i">AdaptiveScene</span>

    [&lt;<span onmouseout="hideTip(event, 'fs272', 953)" onmouseover="showTip(event, 'fs272', 953)" class="t">Semantic</span>&gt;]
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs273', 954)" onmouseover="showTip(event, 'fs273', 954)" class="t">LeafSemantics</span>() <span class="o">=</span>
        <span class="k">member</span> <span onmouseout="hideTip(event, 'fs274', 955)" onmouseover="showTip(event, 'fs274', 955)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs275', 956)" onmouseover="showTip(event, 'fs275', 956)" class="f">RenderObjects</span>(<span onmouseout="hideTip(event, 'fs276', 957)" onmouseover="showTip(event, 'fs276', 957)" class="i">l</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs265', 958)" onmouseover="showTip(event, 'fs265', 958)" class="t">Render</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>) <span class="o">=</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs276', 959)" onmouseover="showTip(event, 'fs276', 959)" class="i">l</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs277', 960)" onmouseover="showTip(event, 'fs277', 960)" class="i">Primitive</span> <span class="k">with</span>
                | <span onmouseout="hideTip(event, 'fs14', 961)" onmouseover="showTip(event, 'fs14', 961)" class="p">Sphere</span>(<span onmouseout="hideTip(event, 'fs125', 962)" onmouseover="showTip(event, 'fs125', 962)" class="i">center</span>,<span onmouseout="hideTip(event, 'fs128', 963)" onmouseover="showTip(event, 'fs128', 963)" class="i">radius</span>) <span class="k">-&gt;</span> 
                    <span class="i">Sg</span><span class="o">.</span><span class="i">sphere</span> <span class="n">5</span> (<span onmouseout="hideTip(event, 'fs276', 964)" onmouseover="showTip(event, 'fs276', 964)" class="i">l</span><span class="o">?</span><span class="i">InhColor</span>) (<span class="i">Mod</span><span class="o">.</span><span class="i">constant</span> <span onmouseout="hideTip(event, 'fs128', 965)" onmouseover="showTip(event, 'fs128', 965)" class="i">radius</span>) <span class="o">|&gt;</span> <span class="i">Sg</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs68', 966)" onmouseover="showTip(event, 'fs68', 966)" class="i">transform</span> (<span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span> <span onmouseout="hideTip(event, 'fs125', 967)" onmouseover="showTip(event, 'fs125', 967)" class="i">center</span>)
                    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs272', 968)" onmouseover="showTip(event, 'fs272', 968)" class="t">Semantic</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs278', 969)" onmouseover="showTip(event, 'fs278', 969)" class="f">renderObjects</span>
                | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs279', 970)" onmouseover="showTip(event, 'fs279', 970)" class="f">failwith</span> <span class="s">&quot;...&quot;</span>
</code></pre></td>
</tr>
</table>
<p>This translates our ISg<'msg> into Aardvark ISg nodes whenever their RenderObjects semantic is requested.</p>
<p>The complete implementation of the scene graph nodes can be found <a href="here">here</a>.</p>
<h3>An efficient version of the drawing application</h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
<span class="l">50: </span>
<span class="l">51: </span>
<span class="l">52: </span>
<span class="l">53: </span>
<span class="l">54: </span>
<span class="l">55: </span>
<span class="l">56: </span>
<span class="l">57: </span>
<span class="l">58: </span>
<span class="l">59: </span>
<span class="l">60: </span>
<span class="l">61: </span>
<span class="l">62: </span>
<span class="l">63: </span>
<span class="l">64: </span>
<span class="l">65: </span>
<span class="l">66: </span>
<span class="l">67: </span>
<span class="l">68: </span>
<span class="l">69: </span>
<span class="l">70: </span>
<span class="l">71: </span>
<span class="l">72: </span>
<span class="l">73: </span>
<span class="l">74: </span>
<span class="l">75: </span>
<span class="l">76: </span>
<span class="l">77: </span>
<span class="l">78: </span>
<span class="l">79: </span>
<span class="l">80: </span>
<span class="l">81: </span>
<span class="l">82: </span>
<span class="l">83: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">FinalDrawingApp</span> <span class="o">=</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 971)" onmouseover="showTip(event, 'fs2', 971)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs280', 972)" onmouseover="showTip(event, 'fs280', 972)" class="i">ImmutableSceneGraph</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 973)" onmouseover="showTip(event, 'fs2', 973)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs281', 974)" onmouseover="showTip(event, 'fs281', 974)" class="i">Elmish</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs282', 975)" onmouseover="showTip(event, 'fs282', 975)" class="i">Primitives</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs283', 976)" onmouseover="showTip(event, 'fs283', 976)" class="i">SimpleDrawingAppGenerated</span>


    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs284', 977)" onmouseover="showTip(event, 'fs284', 977)" class="t">Action</span> <span class="o">=</span>
        | <span onmouseout="hideTip(event, 'fs285', 978)" onmouseover="showTip(event, 'fs285', 978)" class="p">ClosePolygon</span>
        | <span onmouseout="hideTip(event, 'fs286', 979)" onmouseover="showTip(event, 'fs286', 979)" class="p">AddPoint</span>   <span class="k">of</span> <span class="i">V3d</span>
        | <span onmouseout="hideTip(event, 'fs287', 980)" onmouseover="showTip(event, 'fs287', 980)" class="p">MoveCursor</span> <span class="k">of</span> <span class="i">V3d</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs288', 981)" onmouseover="showTip(event, 'fs288', 981)" class="f">update</span> <span onmouseout="hideTip(event, 'fs289', 982)" onmouseover="showTip(event, 'fs289', 982)" class="i">e</span> (<span onmouseout="hideTip(event, 'fs290', 983)" onmouseover="showTip(event, 'fs290', 983)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs237', 984)" onmouseover="showTip(event, 'fs237', 984)" class="t">Model</span>) (<span onmouseout="hideTip(event, 'fs291', 985)" onmouseover="showTip(event, 'fs291', 985)" class="i">cmd</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs284', 986)" onmouseover="showTip(event, 'fs284', 986)" class="t">Action</span>) <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs291', 987)" onmouseover="showTip(event, 'fs291', 987)" class="i">cmd</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs285', 988)" onmouseover="showTip(event, 'fs285', 988)" class="p">ClosePolygon</span> <span class="k">-&gt;</span> 
                <span class="k">match</span> <span onmouseout="hideTip(event, 'fs290', 989)" onmouseover="showTip(event, 'fs290', 989)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs234', 990)" onmouseover="showTip(event, 'fs234', 990)" class="i">working</span> <span class="k">with</span>
                    | <span onmouseout="hideTip(event, 'fs41', 991)" onmouseover="showTip(event, 'fs41', 991)" class="p">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs290', 992)" onmouseover="showTip(event, 'fs290', 992)" class="i">m</span>
                    | <span onmouseout="hideTip(event, 'fs42', 993)" onmouseover="showTip(event, 'fs42', 993)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs55', 994)" onmouseover="showTip(event, 'fs55', 994)" class="i">p</span> <span class="k">-&gt;</span> 
                        { <span onmouseout="hideTip(event, 'fs290', 995)" onmouseover="showTip(event, 'fs290', 995)" class="i">m</span> <span class="k">with</span> 
                            <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 996)" onmouseover="showTip(event, 'fs41', 996)" class="p">None</span> 
                            <span class="i">finished</span> <span class="o">=</span> <span class="i">PSet</span><span class="o">.</span><span class="i">add</span> <span onmouseout="hideTip(event, 'fs55', 997)" onmouseover="showTip(event, 'fs55', 997)" class="i">p</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 998)" onmouseover="showTip(event, 'fs7', 998)" class="i">finishedPoints</span> <span onmouseout="hideTip(event, 'fs290', 999)" onmouseover="showTip(event, 'fs290', 999)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs233', 1000)" onmouseover="showTip(event, 'fs233', 1000)" class="i">finished</span>
                        }
            | <span onmouseout="hideTip(event, 'fs286', 1001)" onmouseover="showTip(event, 'fs286', 1001)" class="p">AddPoint</span> <span onmouseout="hideTip(event, 'fs54', 1002)" onmouseover="showTip(event, 'fs54', 1002)" class="i">p</span> <span class="k">-&gt;</span>
                <span class="k">match</span> <span onmouseout="hideTip(event, 'fs290', 1003)" onmouseover="showTip(event, 'fs290', 1003)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs234', 1004)" onmouseover="showTip(event, 'fs234', 1004)" class="i">working</span> <span class="k">with</span>
                    | <span onmouseout="hideTip(event, 'fs41', 1005)" onmouseover="showTip(event, 'fs41', 1005)" class="p">None</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs290', 1006)" onmouseover="showTip(event, 'fs290', 1006)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1007)" onmouseover="showTip(event, 'fs42', 1007)" class="p">Some</span> { <span class="i">finishedPoints</span> <span class="o">=</span> [ <span onmouseout="hideTip(event, 'fs54', 1008)" onmouseover="showTip(event, 'fs54', 1008)" class="i">p</span> ]; <span class="i">cursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 1009)" onmouseover="showTip(event, 'fs41', 1009)" class="p">None</span>;  }}
                    | <span onmouseout="hideTip(event, 'fs42', 1010)" onmouseover="showTip(event, 'fs42', 1010)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 1011)" onmouseover="showTip(event, 'fs43', 1011)" class="i">v</span> <span class="k">-&gt;</span> 
                        { <span onmouseout="hideTip(event, 'fs290', 1012)" onmouseover="showTip(event, 'fs290', 1012)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1013)" onmouseover="showTip(event, 'fs42', 1013)" class="p">Some</span> { <span onmouseout="hideTip(event, 'fs43', 1014)" onmouseover="showTip(event, 'fs43', 1014)" class="i">v</span> <span class="k">with</span> <span class="i">finishedPoints</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs54', 1015)" onmouseover="showTip(event, 'fs54', 1015)" class="i">p</span> <span class="o">::</span> <span onmouseout="hideTip(event, 'fs43', 1016)" onmouseover="showTip(event, 'fs43', 1016)" class="i">v</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 1017)" onmouseover="showTip(event, 'fs7', 1017)" class="i">finishedPoints</span> }}
            | <span onmouseout="hideTip(event, 'fs287', 1018)" onmouseover="showTip(event, 'fs287', 1018)" class="p">MoveCursor</span> <span onmouseout="hideTip(event, 'fs54', 1019)" onmouseover="showTip(event, 'fs54', 1019)" class="i">p</span> <span class="k">-&gt;</span>
                <span class="k">match</span> <span onmouseout="hideTip(event, 'fs290', 1020)" onmouseover="showTip(event, 'fs290', 1020)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs234', 1021)" onmouseover="showTip(event, 'fs234', 1021)" class="i">working</span> <span class="k">with</span>
                    | <span onmouseout="hideTip(event, 'fs41', 1022)" onmouseover="showTip(event, 'fs41', 1022)" class="p">None</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs290', 1023)" onmouseover="showTip(event, 'fs290', 1023)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1024)" onmouseover="showTip(event, 'fs42', 1024)" class="p">Some</span> { <span class="i">finishedPoints</span> <span class="o">=</span> []; <span class="i">cursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1025)" onmouseover="showTip(event, 'fs42', 1025)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs54', 1026)" onmouseover="showTip(event, 'fs54', 1026)" class="i">p</span> }}
                    | <span onmouseout="hideTip(event, 'fs42', 1027)" onmouseover="showTip(event, 'fs42', 1027)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs43', 1028)" onmouseover="showTip(event, 'fs43', 1028)" class="i">v</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs290', 1029)" onmouseover="showTip(event, 'fs290', 1029)" class="i">m</span> <span class="k">with</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1030)" onmouseover="showTip(event, 'fs42', 1030)" class="p">Some</span> { <span onmouseout="hideTip(event, 'fs43', 1031)" onmouseover="showTip(event, 'fs43', 1031)" class="i">v</span> <span class="k">with</span> <span class="i">cursor</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1032)" onmouseover="showTip(event, 'fs42', 1032)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs54', 1033)" onmouseover="showTip(event, 'fs54', 1033)" class="i">p</span> }}


    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs292', 1034)" onmouseover="showTip(event, 'fs292', 1034)" class="f">viewPolygon</span> (<span onmouseout="hideTip(event, 'fs35', 1035)" onmouseover="showTip(event, 'fs35', 1035)" class="i">p</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 1036)" onmouseover="showTip(event, 'fs5', 1036)" class="t">list</span><span class="o">&lt;</span><span class="i">V3d</span><span class="o">&gt;</span>) <span class="o">=</span>
        [ <span class="k">for</span> <span onmouseout="hideTip(event, 'fs293', 1037)" onmouseover="showTip(event, 'fs293', 1037)" class="i">edge</span> <span class="k">in</span> <span class="i">Polygon3d</span>(<span onmouseout="hideTip(event, 'fs35', 1038)" onmouseover="showTip(event, 'fs35', 1038)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs294', 1039)" onmouseover="showTip(event, 'fs294', 1039)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 1040)" onmouseover="showTip(event, 'fs38', 1040)" class="i">toSeq</span>)<span class="o">.</span><span class="i">EdgeLines</span> <span class="k">do</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs295', 1041)" onmouseover="showTip(event, 'fs295', 1041)" class="i">v</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs293', 1042)" onmouseover="showTip(event, 'fs293', 1042)" class="i">edge</span><span class="o">.</span><span class="i">P1</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs293', 1043)" onmouseover="showTip(event, 'fs293', 1043)" class="i">edge</span><span class="o">.</span><span class="i">P0</span>
            <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs282', 1044)" onmouseover="showTip(event, 'fs282', 1044)" class="t">Primitives</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs296', 1045)" onmouseover="showTip(event, 'fs296', 1045)" class="f">cylinder</span> <span onmouseout="hideTip(event, 'fs293', 1046)" onmouseover="showTip(event, 'fs293', 1046)" class="i">edge</span><span class="o">.</span><span class="i">P0</span> <span onmouseout="hideTip(event, 'fs295', 1047)" onmouseover="showTip(event, 'fs295', 1047)" class="i">v</span><span class="o">.</span><span class="i">Normalized</span> <span onmouseout="hideTip(event, 'fs295', 1048)" onmouseover="showTip(event, 'fs295', 1048)" class="i">v</span><span class="o">.</span><span class="i">Length</span> <span class="n">0.03</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1049)" onmouseover="showTip(event, 'fs297', 1049)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs298', 1050)" onmouseover="showTip(event, 'fs298', 1050)" class="f">render</span> <span onmouseout="hideTip(event, 'fs299', 1051)" onmouseover="showTip(event, 'fs299', 1051)" class="t">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs300', 1052)" onmouseover="showTip(event, 'fs300', 1052)" class="i">ignore</span> 
        ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1053)" onmouseover="showTip(event, 'fs297', 1053)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs301', 1054)" onmouseover="showTip(event, 'fs301', 1054)" class="f">group</span>


    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs302', 1055)" onmouseover="showTip(event, 'fs302', 1055)" class="f">view</span> (<span onmouseout="hideTip(event, 'fs303', 1056)" onmouseover="showTip(event, 'fs303', 1056)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs245', 1057)" onmouseover="showTip(event, 'fs245', 1057)" class="t">MModel</span>) <span class="o">=</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs304', 1058)" onmouseover="showTip(event, 'fs304', 1058)" class="i">t</span> <span class="o">=</span>
           <span class="i">aset</span> {
                <span class="k">yield</span> [ <span onmouseout="hideTip(event, 'fs305', 1059)" onmouseover="showTip(event, 'fs305', 1059)" class="i">Quad</span> (<span class="i">Quad3d</span> [| <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="o">-</span><span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>); <span class="i">V3d</span>(<span class="o">-</span><span class="n">1</span>,<span class="n">1</span>,<span class="n">0</span>) |]) 
                            <span class="o">|&gt;</span>  <span onmouseout="hideTip(event, 'fs297', 1060)" onmouseover="showTip(event, 'fs297', 1060)" class="i">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs298', 1061)" onmouseover="showTip(event, 'fs298', 1061)" class="i">render</span> [ 
                                 <span onmouseout="hideTip(event, 'fs306', 1062)" onmouseover="showTip(event, 'fs306', 1062)" class="i">on</span> <span onmouseout="hideTip(event, 'fs307', 1063)" onmouseover="showTip(event, 'fs307', 1063)" class="i">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1064)" onmouseover="showTip(event, 'fs308', 1064)" class="i">move</span> <span onmouseout="hideTip(event, 'fs287', 1065)" onmouseover="showTip(event, 'fs287', 1065)" class="i">MoveCursor</span>
                                 <span onmouseout="hideTip(event, 'fs306', 1066)" onmouseover="showTip(event, 'fs306', 1066)" class="i">on</span> (<span onmouseout="hideTip(event, 'fs307', 1067)" onmouseover="showTip(event, 'fs307', 1067)" class="i">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs309', 1068)" onmouseover="showTip(event, 'fs309', 1068)" class="i">down&#39;</span> <span class="i">MouseButtons</span><span class="o">.</span><span class="i">Left</span>)  <span onmouseout="hideTip(event, 'fs286', 1069)" onmouseover="showTip(event, 'fs286', 1069)" class="i">AddPoint</span> 
                                 <span onmouseout="hideTip(event, 'fs306', 1070)" onmouseover="showTip(event, 'fs306', 1070)" class="i">on</span> (<span onmouseout="hideTip(event, 'fs307', 1071)" onmouseover="showTip(event, 'fs307', 1071)" class="i">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs309', 1072)" onmouseover="showTip(event, 'fs309', 1072)" class="i">down&#39;</span> <span class="i">MouseButtons</span><span class="o">.</span><span class="i">Right</span>) (<span class="i">constF</span> <span onmouseout="hideTip(event, 'fs285', 1073)" onmouseover="showTip(event, 'fs285', 1073)" class="i">ClosePolygon</span>)
                               ] 
                      ] <span class="o">|&gt;</span>  <span onmouseout="hideTip(event, 'fs297', 1074)" onmouseover="showTip(event, 'fs297', 1074)" class="i">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs310', 1075)" onmouseover="showTip(event, 'fs310', 1075)" class="i">colored</span> (<span class="i">Mod</span><span class="o">.</span><span class="i">constant</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Gray</span>)
                <span class="k">for</span> <span class="i">p</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs303', 1076)" onmouseover="showTip(event, 'fs303', 1076)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs247', 1077)" onmouseover="showTip(event, 'fs247', 1077)" class="i">mfinished</span> <span class="o">:&gt;</span> <span class="i">aset</span><span class="o">&lt;</span>_<span class="o">&gt;</span> <span class="k">do</span> <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs292', 1078)" onmouseover="showTip(event, 'fs292', 1078)" class="i">viewPolygon</span> <span class="i">p</span>
                <span class="k">let!</span> <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs303', 1079)" onmouseover="showTip(event, 'fs303', 1079)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs248', 1080)" onmouseover="showTip(event, 'fs248', 1080)" class="i">mworking</span>
                <span class="k">match</span> <span class="i">working</span> <span class="k">with</span>
                    | <span onmouseout="hideTip(event, 'fs42', 1081)" onmouseover="showTip(event, 'fs42', 1081)" class="i">Some</span> <span class="i">v</span> <span class="k">when</span> <span class="i">v</span><span class="o">.</span><span class="i">cursor</span><span class="o">.</span><span class="i">IsSome</span> <span class="k">-&gt;</span> 
                        <span class="k">yield</span> 
                            [ <span class="i">Sphere3d</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span class="n">0.1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs311', 1082)" onmouseover="showTip(event, 'fs311', 1082)" class="i">Sphere</span> <span class="o">|&gt;</span>  <span onmouseout="hideTip(event, 'fs297', 1083)" onmouseover="showTip(event, 'fs297', 1083)" class="i">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs298', 1084)" onmouseover="showTip(event, 'fs298', 1084)" class="i">render</span> <span onmouseout="hideTip(event, 'fs299', 1085)" onmouseover="showTip(event, 'fs299', 1085)" class="i">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs300', 1086)" onmouseover="showTip(event, 'fs300', 1086)" class="i">ignore</span> ] 
                                <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1087)" onmouseover="showTip(event, 'fs297', 1087)" class="i">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs310', 1088)" onmouseover="showTip(event, 'fs310', 1088)" class="i">colored</span> (<span class="i">Mod</span><span class="o">.</span><span class="i">constant</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Red</span>)
                                <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1089)" onmouseover="showTip(event, 'fs297', 1089)" class="i">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs312', 1090)" onmouseover="showTip(event, 'fs312', 1090)" class="i">transform&#39;</span> (<span class="i">Mod</span><span class="o">.</span><span class="i">constant</span> <span class="o">&lt;|</span> <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span>(<span class="i">v</span><span class="o">.</span><span class="i">cursor</span><span class="o">.</span><span class="i">Value</span>))
                        <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs292', 1091)" onmouseover="showTip(event, 'fs292', 1091)" class="i">viewPolygon</span> (<span class="i">v</span><span class="o">.</span><span class="i">cursor</span><span class="o">.</span><span class="i">Value</span> <span class="o">::</span> <span class="i">v</span><span class="o">.</span><span class="i">finishedPoints</span>)
                    | _ <span class="k">-&gt;</span> ()
            }
        <span onmouseout="hideTip(event, 'fs297', 1092)" onmouseover="showTip(event, 'fs297', 1092)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs313', 1093)" onmouseover="showTip(event, 'fs313', 1093)" class="f">agroup</span>  <span onmouseout="hideTip(event, 'fs304', 1094)" onmouseover="showTip(event, 'fs304', 1094)" class="i">t</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs314', 1095)" onmouseover="showTip(event, 'fs314', 1095)" class="f">viewScene</span> (<span onmouseout="hideTip(event, 'fs315', 1096)" onmouseover="showTip(event, 'fs315', 1096)" class="i">sizes</span> <span class="o">:</span> <span class="i">IMod</span><span class="o">&lt;</span><span class="i">V2i</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs303', 1097)" onmouseover="showTip(event, 'fs303', 1097)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs245', 1098)" onmouseover="showTip(event, 'fs245', 1098)" class="t">MModel</span>) <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs316', 1099)" onmouseover="showTip(event, 'fs316', 1099)" class="i">cameraView</span> <span class="o">=</span> <span class="i">CameraView</span><span class="o">.</span><span class="i">lookAt</span> (<span class="i">V3d</span><span class="o">.</span><span class="i">III</span> <span class="o">*</span> <span class="n">3.0</span>) <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">constant</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs317', 1100)" onmouseover="showTip(event, 'fs317', 1100)" class="i">frustum</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs315', 1101)" onmouseover="showTip(event, 'fs315', 1101)" class="i">sizes</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">map</span> (<span class="k">fun</span> (<span class="i">b</span> <span class="o">:</span> <span class="i">V2i</span>) <span class="k">-&gt;</span> <span class="i">Frustum</span><span class="o">.</span><span class="i">perspective</span> <span class="n">60.0</span> <span class="n">0.1</span> <span class="n">10.0</span> (<span onmouseout="hideTip(event, 'fs15', 1102)" onmouseover="showTip(event, 'fs15', 1102)" class="i">float</span> <span class="i">b</span><span class="o">.</span><span class="i">X</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs15', 1103)" onmouseover="showTip(event, 'fs15', 1103)" class="i">float</span> <span class="i">b</span><span class="o">.</span><span class="i">Y</span>))
        <span onmouseout="hideTip(event, 'fs302', 1104)" onmouseover="showTip(event, 'fs302', 1104)" class="f">view</span> <span onmouseout="hideTip(event, 'fs303', 1105)" onmouseover="showTip(event, 'fs303', 1105)" class="i">m</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1106)" onmouseover="showTip(event, 'fs297', 1106)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs318', 1107)" onmouseover="showTip(event, 'fs318', 1107)" class="f">camera</span> (<span class="i">Mod</span><span class="o">.</span><span class="i">map2</span> <span class="i">Camera</span><span class="o">.</span><span class="i">create</span> <span onmouseout="hideTip(event, 'fs316', 1108)" onmouseover="showTip(event, 'fs316', 1108)" class="i">cameraView</span> <span onmouseout="hideTip(event, 'fs317', 1109)" onmouseover="showTip(event, 'fs317', 1109)" class="i">frustum</span>)
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1110)" onmouseover="showTip(event, 'fs297', 1110)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs319', 1111)" onmouseover="showTip(event, 'fs319', 1111)" class="f">effect</span> [<span class="i">toEffect</span> <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">trafo</span>; <span class="i">toEffect</span> <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">vertexColor</span>; <span class="i">toEffect</span> <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">simpleLighting</span>]


    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs320', 1112)" onmouseover="showTip(event, 'fs320', 1112)" class="i">initial</span> <span class="o">=</span> { <span class="i">finished</span> <span class="o">=</span> <span class="i">PSet</span><span class="o">.</span><span class="i">empty</span>; <span class="i">working</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 1113)" onmouseover="showTip(event, 'fs41', 1113)" class="p">None</span>; <span class="v">_id</span> <span class="o">=</span> <span class="k">null</span> }

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs321', 1114)" onmouseover="showTip(event, 'fs321', 1114)" class="f">app</span> <span onmouseout="hideTip(event, 'fs322', 1115)" onmouseover="showTip(event, 'fs322', 1115)" class="i">s</span> <span class="o">=</span>
        {
            <span onmouseout="hideTip(event, 'fs320', 1116)" onmouseover="showTip(event, 'fs320', 1116)" class="i">initial</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs320', 1117)" onmouseover="showTip(event, 'fs320', 1117)" class="i">initial</span>
            <span onmouseout="hideTip(event, 'fs288', 1118)" onmouseover="showTip(event, 'fs288', 1118)" class="i">update</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs288', 1119)" onmouseover="showTip(event, 'fs288', 1119)" class="f">update</span>
            <span onmouseout="hideTip(event, 'fs302', 1120)" onmouseover="showTip(event, 'fs302', 1120)" class="i">view</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs314', 1121)" onmouseover="showTip(event, 'fs314', 1121)" class="f">viewScene</span> <span onmouseout="hideTip(event, 'fs322', 1122)" onmouseover="showTip(event, 'fs322', 1122)" class="i">s</span>
            <span class="i">ofPickMsg</span> <span class="o">=</span> <span class="k">fun</span> _ _ <span class="k">-&gt;</span> []
            <span class="i">subscriptions</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs2', 1123)" onmouseover="showTip(event, 'fs2', 1123)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs281', 1124)" onmouseover="showTip(event, 'fs281', 1124)" class="i">Elmish</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs323', 1125)" onmouseover="showTip(event, 'fs323', 1125)" class="t">Subscriptions</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs324', 1126)" onmouseover="showTip(event, 'fs324', 1126)" class="f">none</span>
        }
</code></pre></td>
</tr>
</table>
<h3>Discussion</h3>
<p>We ended up with an API for submitting changes to a domain model and evaluating a view function on that model. For efficiency reasons, we utilized adaptive functional programming in order to write one single view function which is agnostic to changes.
Since the incremental system requires changes at inputs in order to perform necessary recomputations, we, at some point, need to translate changes in immutable data to reference cell mutations.
This procedure can be automated and implemented as a compiler extension.</p>
<p>In other words: Previous work focused on feeding changes into a scene representation efficiently. Incremental evaluation is greatly beneficial (even indispensable) to those procedures. Although this is very efficient, keeping track of incremental computations and adaptive dependencies becomes difficult as complexity increases.
On the other side, working with immutable updates on domain models is easy, but an efficient implementation is not tangible.</p>
<p>In this work we combine the two, and indeed we get the best of both. The immutable update mechanism can be seen as automatic, convenient input changer, while the incremental evaluation backend takes care of mapping updates efficiently to the underlying graphics hardware.</p>
<h2>Refining the Model</h2>
<h3>External events</h3>
<p>So far we only worked with mouse inputs and their interactions with 3D objects. In general, however, we often need to emit messages without user interaction, or due to the occurance of an external event.
Elm extends its application pattern with an additional function. It allows subscriptions to be registered between the current model and sources of events.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">Subscriptions1</span> <span class="o">=</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs325', 1127)" onmouseover="showTip(event, 'fs325', 1127)" class="t">Sub</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span> <span class="o">=</span> 
        | <span onmouseout="hideTip(event, 'fs326', 1128)" onmouseover="showTip(event, 'fs326', 1128)" class="p">TimeSub</span>  <span class="k">of</span> <span onmouseout="hideTip(event, 'fs327', 1129)" onmouseover="showTip(event, 'fs327', 1129)" class="t">TimeSpan</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs327', 1130)" onmouseover="showTip(event, 'fs327', 1130)" class="t">TimeSpan</span> <span class="k">-&gt;</span> <span class="o">&#39;</span><span class="i">msg</span>) 
        | <span onmouseout="hideTip(event, 'fs328', 1131)" onmouseover="showTip(event, 'fs328', 1131)" class="p">KeyPress</span> <span class="k">of</span> (<span class="i">Keys</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs9', 1132)" onmouseover="showTip(event, 'fs9', 1132)" class="t">Option</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>)
        | <span onmouseout="hideTip(event, 'fs329', 1133)" onmouseover="showTip(event, 'fs329', 1133)" class="p">Many</span>     <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 1134)" onmouseover="showTip(event, 'fs5', 1134)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs325', 1135)" onmouseover="showTip(event, 'fs325', 1135)" class="t">Sub</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs330', 1136)" onmouseover="showTip(event, 'fs330', 1136)" class="f">timeSub</span> <span onmouseout="hideTip(event, 'fs331', 1137)" onmouseover="showTip(event, 'fs331', 1137)" class="i">ts</span> <span onmouseout="hideTip(event, 'fs332', 1138)" onmouseover="showTip(event, 'fs332', 1138)" class="f">f</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs326', 1139)" onmouseover="showTip(event, 'fs326', 1139)" class="p">TimeSub</span>(<span onmouseout="hideTip(event, 'fs331', 1140)" onmouseover="showTip(event, 'fs331', 1140)" class="i">ts</span>,<span onmouseout="hideTip(event, 'fs332', 1141)" onmouseover="showTip(event, 'fs332', 1141)" class="f">f</span>)

<span class="c">// todo subscription example</span>

<span class="k">module</span> <span class="t">Animation</span> <span class="o">=</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1142)" onmouseover="showTip(event, 'fs1', 1142)" class="i">System</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1143)" onmouseover="showTip(event, 'fs2', 1143)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs280', 1144)" onmouseover="showTip(event, 'fs280', 1144)" class="i">ImmutableSceneGraph</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1145)" onmouseover="showTip(event, 'fs2', 1145)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs281', 1146)" onmouseover="showTip(event, 'fs281', 1146)" class="i">Elmish</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs282', 1147)" onmouseover="showTip(event, 'fs282', 1147)" class="i">Primitives</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs333', 1148)" onmouseover="showTip(event, 'fs333', 1148)" class="t">Model</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs334', 1149)" onmouseover="showTip(event, 'fs334', 1149)" class="i">rotation</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs15', 1150)" onmouseover="showTip(event, 'fs15', 1150)" class="t">float</span>; <span onmouseout="hideTip(event, 'fs238', 1151)" onmouseover="showTip(event, 'fs238', 1151)" class="i">_id</span> <span class="o">:</span> <span class="i">Id</span> }
    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs335', 1152)" onmouseover="showTip(event, 'fs335', 1152)" class="t">MModel</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs336', 1153)" onmouseover="showTip(event, 'fs336', 1153)" class="i">mrotation</span> <span class="o">:</span> <span class="i">ModRef</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs15', 1154)" onmouseover="showTip(event, 'fs15', 1154)" class="i">float</span><span class="o">&gt;</span>} <span class="c">// mutable model impl skipped</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs337', 1155)" onmouseover="showTip(event, 'fs337', 1155)" class="t">Msg</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs338', 1156)" onmouseover="showTip(event, 'fs338', 1156)" class="p">TimeStep</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs327', 1157)" onmouseover="showTip(event, 'fs327', 1157)" class="t">TimeSpan</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs339', 1158)" onmouseover="showTip(event, 'fs339', 1158)" class="f">update</span> <span onmouseout="hideTip(event, 'fs289', 1159)" onmouseover="showTip(event, 'fs289', 1159)" class="i">e</span> (<span onmouseout="hideTip(event, 'fs290', 1160)" onmouseover="showTip(event, 'fs290', 1160)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs333', 1161)" onmouseover="showTip(event, 'fs333', 1161)" class="t">Model</span>) (<span onmouseout="hideTip(event, 'fs340', 1162)" onmouseover="showTip(event, 'fs340', 1162)" class="i">msg</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs337', 1163)" onmouseover="showTip(event, 'fs337', 1163)" class="t">Msg</span>) <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs340', 1164)" onmouseover="showTip(event, 'fs340', 1164)" class="i">msg</span> <span class="k">with</span>  
            | <span onmouseout="hideTip(event, 'fs338', 1165)" onmouseover="showTip(event, 'fs338', 1165)" class="p">TimeStep</span> <span onmouseout="hideTip(event, 'fs341', 1166)" onmouseover="showTip(event, 'fs341', 1166)" class="i">t</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs290', 1167)" onmouseover="showTip(event, 'fs290', 1167)" class="i">m</span> <span class="k">with</span> <span class="i">rotation</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs290', 1168)" onmouseover="showTip(event, 'fs290', 1168)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs334', 1169)" onmouseover="showTip(event, 'fs334', 1169)" class="i">rotation</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs341', 1170)" onmouseover="showTip(event, 'fs341', 1170)" class="i">t</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs342', 1171)" onmouseover="showTip(event, 'fs342', 1171)" class="i">TotalMilliseconds</span> <span class="o">*</span> <span class="n">0.1</span> }
    
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs343', 1172)" onmouseover="showTip(event, 'fs343', 1172)" class="f">view</span> (<span onmouseout="hideTip(event, 'fs303', 1173)" onmouseover="showTip(event, 'fs303', 1173)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs335', 1174)" onmouseover="showTip(event, 'fs335', 1174)" class="t">MModel</span>) <span class="o">=</span>
         [ <span class="i">Sphere3d</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span class="n">0.1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs311', 1175)" onmouseover="showTip(event, 'fs311', 1175)" class="p">Sphere</span> <span class="o">|&gt;</span>  <span onmouseout="hideTip(event, 'fs297', 1176)" onmouseover="showTip(event, 'fs297', 1176)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs298', 1177)" onmouseover="showTip(event, 'fs298', 1177)" class="f">render</span> <span onmouseout="hideTip(event, 'fs299', 1178)" onmouseover="showTip(event, 'fs299', 1178)" class="t">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs300', 1179)" onmouseover="showTip(event, 'fs300', 1179)" class="i">ignore</span> ]  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs297', 1180)" onmouseover="showTip(event, 'fs297', 1180)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs344', 1181)" onmouseover="showTip(event, 'fs344', 1181)" class="f">transform</span> (<span onmouseout="hideTip(event, 'fs303', 1182)" onmouseover="showTip(event, 'fs303', 1182)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs336', 1183)" onmouseover="showTip(event, 'fs336', 1183)" class="i">mrotation</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">map</span>  <span class="i">Trafo3d</span><span class="o">.</span><span class="i">RotationZ</span>) 

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs345', 1184)" onmouseover="showTip(event, 'fs345', 1184)" class="f">subscriptions</span> (<span onmouseout="hideTip(event, 'fs290', 1185)" onmouseover="showTip(event, 'fs290', 1185)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs333', 1186)" onmouseover="showTip(event, 'fs333', 1186)" class="t">Model</span>) <span class="o">:</span> <span onmouseout="hideTip(event, 'fs346', 1187)" onmouseover="showTip(event, 'fs346', 1187)" class="t">Subscriptions1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs325', 1188)" onmouseover="showTip(event, 'fs325', 1188)" class="t">Sub</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs337', 1189)" onmouseover="showTip(event, 'fs337', 1189)" class="t">Msg</span><span class="o">&gt;</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs346', 1190)" onmouseover="showTip(event, 'fs346', 1190)" class="t">Subscriptions1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs347', 1191)" onmouseover="showTip(event, 'fs347', 1191)" class="f">timeSub</span> (<span onmouseout="hideTip(event, 'fs327', 1192)" onmouseover="showTip(event, 'fs327', 1192)" class="t">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs348', 1193)" onmouseover="showTip(event, 'fs348', 1193)" class="f">FromMilliseconds</span> <span class="n">10.0</span>) <span onmouseout="hideTip(event, 'fs338', 1194)" onmouseover="showTip(event, 'fs338', 1194)" class="p">TimeStep</span>
</code></pre></td>
</tr>
</table>
<p>After each update, we purely functionally recompute the subscription set. Then we compute the difference between the current and the old subscription set. Unnecessary subscriptions can be removed safely, while new subscriptions are added where needed.</p>
<h4>Subscriptions --- The observer pattern's new clothes?</h4>
<p>At first, subscriptions look like a rather imperative pattern.</p>
<p>Traditional subscription-based techniques have severe flaws:</p>
<ul>
<li>
Subscriptions need to be registered, and they need to be unregistered after expiration. 
Subscribe in Rx has type: 'val subscribe : ('a -&gt; unit) -&gt; IDisposable' which already hints at the significant effort required for tracking subscriptions in application code.
</li>
<li>
Classic subscriptions compose by building up subscription networks, through which input events travel.
Observing results from such networks can only be accomplished by registering (mutating) actions. Whenever an input changes, the change propagates through subscription chains. Eventually, actions are triggered to write new values into application state.
Since change propagation in such networks is performed eagerly, the program can be assigned with faithful semantics. But understanding such networks statically, or even debugging their runtime behavior, can be extremely tricky.
</li>
</ul>
<p>In our design pattern, the set of subscriptions is recomputed automatically after each update. This means that the problem of "cleaning up" subscriptions completely disappears.
Secondly, subscriptions in our model are purely functional. They build up lists of messages representing their effects, which in turn are fed back into the update function.
This greatly improves debugging, since the results of external events can be observed at a single point in code instead of various points scattered in the domain logic.</p>
<h3>Depth ordering of Pick Events</h3>
<p>In our original implementation, we always used the frontmost pick and ignored all further hits along the pick ray. Howewer, it is often necessary to compute all pick occurences along the pick ray. The user might want to move polygon corners around by click-dragging. When hovering over control points of a polygon, the pick must go "through" the control point geometry and hit the ground plane below. This can be accomplished by a simple extension to the pick API:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs349', 1195)" onmouseover="showTip(event, 'fs349', 1195)" class="t">Transparency</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs350', 1196)" onmouseover="showTip(event, 'fs350', 1196)" class="p">Solid</span> | <span onmouseout="hideTip(event, 'fs351', 1197)" onmouseover="showTip(event, 'fs351', 1197)" class="p">PickThrough</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs352', 1198)" onmouseover="showTip(event, 'fs352', 1198)" class="t">PickOperation2</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span> <span class="o">=</span> (<span class="i">V3d</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs9', 1199)" onmouseover="showTip(event, 'fs9', 1199)" class="t">Option</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs349', 1200)" onmouseover="showTip(event, 'fs349', 1200)" class="t">Transparency</span>

<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs353', 1201)" onmouseover="showTip(event, 'fs353', 1201)" class="f">depthTest</span> (<span onmouseout="hideTip(event, 'fs354', 1202)" onmouseover="showTip(event, 'fs354', 1202)" class="i">xs</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 1203)" onmouseover="showTip(event, 'fs5', 1203)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs15', 1204)" onmouseover="showTip(event, 'fs15', 1204)" class="t">float</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs352', 1205)" onmouseover="showTip(event, 'fs352', 1205)" class="t">PickOperation2</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">msg</span><span class="o">&gt;</span><span class="o">&gt;</span>) <span class="o">=</span>
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs354', 1206)" onmouseover="showTip(event, 'fs354', 1206)" class="i">xs</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs37', 1207)" onmouseover="showTip(event, 'fs37', 1207)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs159', 1208)" onmouseover="showTip(event, 'fs159', 1208)" class="f">sortBy</span> <span onmouseout="hideTip(event, 'fs160', 1209)" onmouseover="showTip(event, 'fs160', 1209)" class="f">fst</span> <span class="k">with</span> <span class="c">// sort picks by distance</span>
        | [] <span class="k">-&gt;</span> [] <span class="c">// no picks</span>
        | (<span onmouseout="hideTip(event, 'fs355', 1210)" onmouseover="showTip(event, 'fs355', 1210)" class="i">d1</span>,(<span onmouseout="hideTip(event, 'fs356', 1211)" onmouseover="showTip(event, 'fs356', 1211)" class="f">f1</span>,<span onmouseout="hideTip(event, 'fs350', 1212)" onmouseover="showTip(event, 'fs350', 1212)" class="p">Solid</span>))<span class="o">::</span>(<span onmouseout="hideTip(event, 'fs357', 1213)" onmouseover="showTip(event, 'fs357', 1213)" class="i">d2</span>,(<span onmouseout="hideTip(event, 'fs358', 1214)" onmouseover="showTip(event, 'fs358', 1214)" class="f">f2</span>,<span onmouseout="hideTip(event, 'fs350', 1215)" onmouseover="showTip(event, 'fs350', 1215)" class="p">Solid</span>))<span class="o">::</span><span onmouseout="hideTip(event, 'fs359', 1216)" onmouseover="showTip(event, 'fs359', 1216)" class="i">rest</span> <span class="k">when</span> <span class="i">d1</span> <span class="o">=</span> <span class="i">d2</span> <span class="k">-&gt;</span> 
            <span class="c">// two solid picks, equal distance, use both</span>
            (<span class="i">d1</span>,(<span class="f">f1</span>,<span onmouseout="hideTip(event, 'fs350', 1217)" onmouseover="showTip(event, 'fs350', 1217)" class="p">Solid</span>)) <span class="o">::</span>(<span class="i">d2</span>,(<span class="f">f2</span>,<span onmouseout="hideTip(event, 'fs350', 1218)" onmouseover="showTip(event, 'fs350', 1218)" class="p">Solid</span>)) <span class="o">::</span> <span onmouseout="hideTip(event, 'fs353', 1219)" onmouseover="showTip(event, 'fs353', 1219)" class="f">depthTest</span> <span onmouseout="hideTip(event, 'fs359', 1220)" onmouseover="showTip(event, 'fs359', 1220)" class="i">rest</span>
        | (<span onmouseout="hideTip(event, 'fs360', 1221)" onmouseover="showTip(event, 'fs360', 1221)" class="i">d</span>, (<span onmouseout="hideTip(event, 'fs361', 1222)" onmouseover="showTip(event, 'fs361', 1222)" class="f">f</span>,<span onmouseout="hideTip(event, 'fs350', 1223)" onmouseover="showTip(event, 'fs350', 1223)" class="p">Solid</span>))<span class="o">::</span>_ <span class="k">-&gt;</span>      
            <span class="c">// solid pick, stop here</span>
            [<span onmouseout="hideTip(event, 'fs360', 1224)" onmouseover="showTip(event, 'fs360', 1224)" class="i">d</span>, (<span onmouseout="hideTip(event, 'fs361', 1225)" onmouseover="showTip(event, 'fs361', 1225)" class="f">f</span>,<span onmouseout="hideTip(event, 'fs350', 1226)" onmouseover="showTip(event, 'fs350', 1226)" class="p">Solid</span>)]
        | (<span onmouseout="hideTip(event, 'fs360', 1227)" onmouseover="showTip(event, 'fs360', 1227)" class="i">d</span>, (<span onmouseout="hideTip(event, 'fs361', 1228)" onmouseover="showTip(event, 'fs361', 1228)" class="f">f</span>,<span onmouseout="hideTip(event, 'fs351', 1229)" onmouseover="showTip(event, 'fs351', 1229)" class="p">PickThrough</span>))<span class="o">::</span><span onmouseout="hideTip(event, 'fs354', 1230)" onmouseover="showTip(event, 'fs354', 1230)" class="i">xs</span> <span class="k">-&gt;</span> 
            <span class="c">// transparent object, take and pick test further</span>
            (<span onmouseout="hideTip(event, 'fs360', 1231)" onmouseover="showTip(event, 'fs360', 1231)" class="i">d</span>, (<span onmouseout="hideTip(event, 'fs361', 1232)" onmouseover="showTip(event, 'fs361', 1232)" class="f">f</span>,<span onmouseout="hideTip(event, 'fs351', 1233)" onmouseover="showTip(event, 'fs351', 1233)" class="p">PickThrough</span>)) <span class="o">::</span> <span onmouseout="hideTip(event, 'fs353', 1234)" onmouseover="showTip(event, 'fs353', 1234)" class="f">depthTest</span> <span onmouseout="hideTip(event, 'fs354', 1235)" onmouseover="showTip(event, 'fs354', 1235)" class="i">xs</span>
</code></pre></td>
</tr>
</table>
<h3>Asynchronous computations</h3>
<p>One main design guideline when designing the API for pick operations was to have necessary information available at one point in the code.
Considering commands which trigger long-running or computationally intensive tasks, the best place for implementation is in the update function, where the message itself and the immutable domain model are available. However, performing long-running computations in the update function directly stalls the application.
Therefore, to express such operations, we introduce the Cmd type and an additional argument to the update function.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="t">EnvExample</span> <span class="o">=</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1236)" onmouseover="showTip(event, 'fs1', 1236)" class="i">System</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1237)" onmouseover="showTip(event, 'fs2', 1237)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs280', 1238)" onmouseover="showTip(event, 'fs280', 1238)" class="i">ImmutableSceneGraph</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1239)" onmouseover="showTip(event, 'fs2', 1239)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs281', 1240)" onmouseover="showTip(event, 'fs281', 1240)" class="i">Elmish</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs282', 1241)" onmouseover="showTip(event, 'fs282', 1241)" class="i">Primitives</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs362', 1242)" onmouseover="showTip(event, 'fs362', 1242)" class="i">Fablish</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs363', 1243)" onmouseover="showTip(event, 'fs363', 1243)" class="i">CommonTypes</span> <span class="c">// env is defined here</span>

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs364', 1244)" onmouseover="showTip(event, 'fs364', 1244)" class="t">Model</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs365', 1245)" onmouseover="showTip(event, 'fs365', 1245)" class="i">image</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 1246)" onmouseover="showTip(event, 'fs5', 1246)" class="t">list</span><span class="o">&lt;</span><span class="i">PixImage</span><span class="o">&gt;</span>; }

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs366', 1247)" onmouseover="showTip(event, 'fs366', 1247)" class="t">Msg</span> <span class="o">=</span> 
        | <span onmouseout="hideTip(event, 'fs367', 1248)" onmouseover="showTip(event, 'fs367', 1248)" class="p">LoadImages</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 1249)" onmouseover="showTip(event, 'fs5', 1249)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs368', 1250)" onmouseover="showTip(event, 'fs368', 1250)" class="t">string</span><span class="o">&gt;</span>
        | <span onmouseout="hideTip(event, 'fs369', 1251)" onmouseover="showTip(event, 'fs369', 1251)" class="p">ImagesLoaded</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 1252)" onmouseover="showTip(event, 'fs5', 1252)" class="t">list</span><span class="o">&lt;</span><span class="i">PixImage</span><span class="o">&gt;</span> <span class="c">// pixImage is a loaded image</span>
        | <span onmouseout="hideTip(event, 'fs370', 1253)" onmouseover="showTip(event, 'fs370', 1253)" class="p">Progress</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs15', 1254)" onmouseover="showTip(event, 'fs15', 1254)" class="t">float</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs371', 1255)" onmouseover="showTip(event, 'fs371', 1255)" class="f">loadImage</span> (<span onmouseout="hideTip(event, 'fs372', 1256)" onmouseover="showTip(event, 'fs372', 1256)" class="i">p</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs5', 1257)" onmouseover="showTip(event, 'fs5', 1257)" class="t">list</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs368', 1258)" onmouseover="showTip(event, 'fs368', 1258)" class="t">string</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs373', 1259)" onmouseover="showTip(event, 'fs373', 1259)" class="i">e</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs374', 1260)" onmouseover="showTip(event, 'fs374', 1260)" class="t">Env</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs366', 1261)" onmouseover="showTip(event, 'fs366', 1261)" class="t">Msg</span><span class="o">&gt;</span>) <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs375', 1262)" onmouseover="showTip(event, 'fs375', 1262)" class="i">async</span> {
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs376', 1263)" onmouseover="showTip(event, 'fs376', 1263)" class="i">cnt</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs294', 1264)" onmouseover="showTip(event, 'fs294', 1264)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs377', 1265)" onmouseover="showTip(event, 'fs377', 1265)" class="f">length</span> <span onmouseout="hideTip(event, 'fs372', 1266)" onmouseover="showTip(event, 'fs372', 1266)" class="i">p</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs378', 1267)" onmouseover="showTip(event, 'fs378', 1267)" class="i">images</span> <span class="o">=</span>
                <span onmouseout="hideTip(event, 'fs372', 1268)" onmouseover="showTip(event, 'fs372', 1268)" class="i">p</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs294', 1269)" onmouseover="showTip(event, 'fs294', 1269)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs379', 1270)" onmouseover="showTip(event, 'fs379', 1270)" class="f">mapi</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs380', 1271)" onmouseover="showTip(event, 'fs380', 1271)" class="i">i</span> <span onmouseout="hideTip(event, 'fs381', 1272)" onmouseover="showTip(event, 'fs381', 1272)" class="i">p</span> <span class="k">-&gt;</span> 
                    <span onmouseout="hideTip(event, 'fs375', 1273)" onmouseover="showTip(event, 'fs375', 1273)" class="i">async</span> { <span class="k">return</span> <span onmouseout="hideTip(event, 'fs370', 1274)" onmouseover="showTip(event, 'fs370', 1274)" class="p">Progress</span> (<span onmouseout="hideTip(event, 'fs15', 1275)" onmouseover="showTip(event, 'fs15', 1275)" class="f">float</span> <span onmouseout="hideTip(event, 'fs380', 1276)" onmouseover="showTip(event, 'fs380', 1276)" class="i">i</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs15', 1277)" onmouseover="showTip(event, 'fs15', 1277)" class="f">float</span> <span onmouseout="hideTip(event, 'fs376', 1278)" onmouseover="showTip(event, 'fs376', 1278)" class="i">cnt</span>) } <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs382', 1279)" onmouseover="showTip(event, 'fs382', 1279)" class="p">Cmd</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs373', 1280)" onmouseover="showTip(event, 'fs373', 1280)" class="i">e</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs383', 1281)" onmouseover="showTip(event, 'fs383', 1281)" class="i">run</span>
                    <span class="i">PixImage</span><span class="o">.</span><span class="i">Create</span>(<span onmouseout="hideTip(event, 'fs381', 1282)" onmouseover="showTip(event, 'fs381', 1282)" class="i">p</span>)
                )
            <span class="k">return</span> <span onmouseout="hideTip(event, 'fs369', 1283)" onmouseover="showTip(event, 'fs369', 1283)" class="p">ImagesLoaded</span> <span class="i">images</span>
        }
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs384', 1284)" onmouseover="showTip(event, 'fs384', 1284)" class="f">update</span> (<span onmouseout="hideTip(event, 'fs385', 1285)" onmouseover="showTip(event, 'fs385', 1285)" class="i">env</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs374', 1286)" onmouseover="showTip(event, 'fs374', 1286)" class="t">Env</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs366', 1287)" onmouseover="showTip(event, 'fs366', 1287)" class="t">Msg</span><span class="o">&gt;</span>) (<span onmouseout="hideTip(event, 'fs290', 1288)" onmouseover="showTip(event, 'fs290', 1288)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs364', 1289)" onmouseover="showTip(event, 'fs364', 1289)" class="t">Model</span>) (<span onmouseout="hideTip(event, 'fs340', 1290)" onmouseover="showTip(event, 'fs340', 1290)" class="i">msg</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs366', 1291)" onmouseover="showTip(event, 'fs366', 1291)" class="t">Msg</span>) <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs340', 1292)" onmouseover="showTip(event, 'fs340', 1292)" class="i">msg</span> <span class="k">with</span> 
            | <span onmouseout="hideTip(event, 'fs367', 1293)" onmouseover="showTip(event, 'fs367', 1293)" class="p">LoadImages</span> <span onmouseout="hideTip(event, 'fs386', 1294)" onmouseover="showTip(event, 'fs386', 1294)" class="i">paths</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs371', 1295)" onmouseover="showTip(event, 'fs371', 1295)" class="f">loadImage</span> <span onmouseout="hideTip(event, 'fs386', 1296)" onmouseover="showTip(event, 'fs386', 1296)" class="i">paths</span> <span onmouseout="hideTip(event, 'fs385', 1297)" onmouseover="showTip(event, 'fs385', 1297)" class="i">env</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs382', 1298)" onmouseover="showTip(event, 'fs382', 1298)" class="p">Cmd</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs385', 1299)" onmouseover="showTip(event, 'fs385', 1299)" class="i">env</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs383', 1300)" onmouseover="showTip(event, 'fs383', 1300)" class="i">run</span>
                <span onmouseout="hideTip(event, 'fs290', 1301)" onmouseover="showTip(event, 'fs290', 1301)" class="i">m</span>
            | <span onmouseout="hideTip(event, 'fs369', 1302)" onmouseover="showTip(event, 'fs369', 1302)" class="p">ImagesLoaded</span> <span onmouseout="hideTip(event, 'fs387', 1303)" onmouseover="showTip(event, 'fs387', 1303)" class="i">img</span> <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs290', 1304)" onmouseover="showTip(event, 'fs290', 1304)" class="i">m</span> <span class="k">with</span> <span class="i">image</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs387', 1305)" onmouseover="showTip(event, 'fs387', 1305)" class="i">img</span> }
            | <span onmouseout="hideTip(event, 'fs370', 1306)" onmouseover="showTip(event, 'fs370', 1306)" class="p">Progress</span> _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs290', 1307)" onmouseover="showTip(event, 'fs290', 1307)" class="i">m</span>
</code></pre></td>
</tr>
</table>
<h2>Further examples</h2>
<h3>Implementing a transformation controller</h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">  1: </span>
<span class="l">  2: </span>
<span class="l">  3: </span>
<span class="l">  4: </span>
<span class="l">  5: </span>
<span class="l">  6: </span>
<span class="l">  7: </span>
<span class="l">  8: </span>
<span class="l">  9: </span>
<span class="l"> 10: </span>
<span class="l"> 11: </span>
<span class="l"> 12: </span>
<span class="l"> 13: </span>
<span class="l"> 14: </span>
<span class="l"> 15: </span>
<span class="l"> 16: </span>
<span class="l"> 17: </span>
<span class="l"> 18: </span>
<span class="l"> 19: </span>
<span class="l"> 20: </span>
<span class="l"> 21: </span>
<span class="l"> 22: </span>
<span class="l"> 23: </span>
<span class="l"> 24: </span>
<span class="l"> 25: </span>
<span class="l"> 26: </span>
<span class="l"> 27: </span>
<span class="l"> 28: </span>
<span class="l"> 29: </span>
<span class="l"> 30: </span>
<span class="l"> 31: </span>
<span class="l"> 32: </span>
<span class="l"> 33: </span>
<span class="l"> 34: </span>
<span class="l"> 35: </span>
<span class="l"> 36: </span>
<span class="l"> 37: </span>
<span class="l"> 38: </span>
<span class="l"> 39: </span>
<span class="l"> 40: </span>
<span class="l"> 41: </span>
<span class="l"> 42: </span>
<span class="l"> 43: </span>
<span class="l"> 44: </span>
<span class="l"> 45: </span>
<span class="l"> 46: </span>
<span class="l"> 47: </span>
<span class="l"> 48: </span>
<span class="l"> 49: </span>
<span class="l"> 50: </span>
<span class="l"> 51: </span>
<span class="l"> 52: </span>
<span class="l"> 53: </span>
<span class="l"> 54: </span>
<span class="l"> 55: </span>
<span class="l"> 56: </span>
<span class="l"> 57: </span>
<span class="l"> 58: </span>
<span class="l"> 59: </span>
<span class="l"> 60: </span>
<span class="l"> 61: </span>
<span class="l"> 62: </span>
<span class="l"> 63: </span>
<span class="l"> 64: </span>
<span class="l"> 65: </span>
<span class="l"> 66: </span>
<span class="l"> 67: </span>
<span class="l"> 68: </span>
<span class="l"> 69: </span>
<span class="l"> 70: </span>
<span class="l"> 71: </span>
<span class="l"> 72: </span>
<span class="l"> 73: </span>
<span class="l"> 74: </span>
<span class="l"> 75: </span>
<span class="l"> 76: </span>
<span class="l"> 77: </span>
<span class="l"> 78: </span>
<span class="l"> 79: </span>
<span class="l"> 80: </span>
<span class="l"> 81: </span>
<span class="l"> 82: </span>
<span class="l"> 83: </span>
<span class="l"> 84: </span>
<span class="l"> 85: </span>
<span class="l"> 86: </span>
<span class="l"> 87: </span>
<span class="l"> 88: </span>
<span class="l"> 89: </span>
<span class="l"> 90: </span>
<span class="l"> 91: </span>
<span class="l"> 92: </span>
<span class="l"> 93: </span>
<span class="l"> 94: </span>
<span class="l"> 95: </span>
<span class="l"> 96: </span>
<span class="l"> 97: </span>
<span class="l"> 98: </span>
<span class="l"> 99: </span>
<span class="l">100: </span>
<span class="l">101: </span>
<span class="l">102: </span>
<span class="l">103: </span>
<span class="l">104: </span>
<span class="l">105: </span>
<span class="l">106: </span>
<span class="l">107: </span>
<span class="l">108: </span>
<span class="l">109: </span>
<span class="l">110: </span>
<span class="l">111: </span>
<span class="l">112: </span>
<span class="l">113: </span>
<span class="l">114: </span>
<span class="l">115: </span>
<span class="l">116: </span>
<span class="l">117: </span>
<span class="l">118: </span>
<span class="l">119: </span>
<span class="l">120: </span>
<span class="l">121: </span>
<span class="l">122: </span>
<span class="l">123: </span>
<span class="l">124: </span>
<span class="l">125: </span>
<span class="l">126: </span>
<span class="l">127: </span>
<span class="l">128: </span>
<span class="l">129: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span onmouseout="hideTip(event, 'fs388', 1308)" onmouseover="showTip(event, 'fs388', 1308)" class="t">TranslateController</span> <span class="o">=</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1309)" onmouseover="showTip(event, 'fs2', 1309)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs280', 1310)" onmouseover="showTip(event, 'fs280', 1310)" class="i">ImmutableSceneGraph</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1311)" onmouseover="showTip(event, 'fs2', 1311)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs280', 1312)" onmouseover="showTip(event, 'fs280', 1312)" class="i">ImmutableSceneGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs389', 1313)" onmouseover="showTip(event, 'fs389', 1313)" class="i">Scene</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs282', 1314)" onmouseover="showTip(event, 'fs282', 1314)" class="i">Primitives</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 1315)" onmouseover="showTip(event, 'fs2', 1315)" class="i">Aardvark</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs281', 1316)" onmouseover="showTip(event, 'fs281', 1316)" class="i">Elmish</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs390', 1317)" onmouseover="showTip(event, 'fs390', 1317)" class="i">Scratch</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs391', 1318)" onmouseover="showTip(event, 'fs391', 1318)" class="i">DomainTypes</span>

    [&lt;<span onmouseout="hideTip(event, 'fs392', 1319)" onmouseover="showTip(event, 'fs392', 1319)" class="t">CompilationRepresentation</span>(<span onmouseout="hideTip(event, 'fs393', 1320)" onmouseover="showTip(event, 'fs393', 1320)" class="t">CompilationRepresentationFlags</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs394', 1321)" onmouseover="showTip(event, 'fs394', 1321)" class="i">ModuleSuffix</span>)&gt;]
    <span class="k">module</span> <span onmouseout="hideTip(event, 'fs395', 1322)" onmouseover="showTip(event, 'fs395', 1322)" class="t">Axis</span> <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs396', 1323)" onmouseover="showTip(event, 'fs396', 1323)" class="f">dir</span> <span class="o">=</span> <span class="k">function</span> | <span onmouseout="hideTip(event, 'fs397', 1324)" onmouseover="showTip(event, 'fs397', 1324)" class="p">X</span> <span class="k">-&gt;</span> <span class="i">V3d</span><span class="o">.</span><span class="i">XAxis</span> | <span onmouseout="hideTip(event, 'fs398', 1325)" onmouseover="showTip(event, 'fs398', 1325)" class="p">Y</span> <span class="k">-&gt;</span> <span class="i">V3d</span><span class="o">.</span><span class="i">YAxis</span> | <span onmouseout="hideTip(event, 'fs399', 1326)" onmouseover="showTip(event, 'fs399', 1326)" class="p">Z</span> <span class="k">-&gt;</span> <span class="i">V3d</span><span class="o">.</span><span class="i">ZAxis</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs400', 1327)" onmouseover="showTip(event, 'fs400', 1327)" class="f">moveAxis</span> (<span onmouseout="hideTip(event, 'fs135', 1328)" onmouseover="showTip(event, 'fs135', 1328)" class="i">trafo</span> <span class="o">:</span> <span class="i">Trafo3d</span>) <span class="o">=</span> <span class="k">function</span>
            | <span onmouseout="hideTip(event, 'fs397', 1329)" onmouseover="showTip(event, 'fs397', 1329)" class="p">X</span> <span class="k">-&gt;</span> <span class="i">Plane3d</span>(<span onmouseout="hideTip(event, 'fs135', 1330)" onmouseover="showTip(event, 'fs135', 1330)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformDir</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span>, <span onmouseout="hideTip(event, 'fs135', 1331)" onmouseover="showTip(event, 'fs135', 1331)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>)
            | <span onmouseout="hideTip(event, 'fs398', 1332)" onmouseover="showTip(event, 'fs398', 1332)" class="p">Y</span> <span class="k">-&gt;</span> <span class="i">Plane3d</span>(<span onmouseout="hideTip(event, 'fs135', 1333)" onmouseover="showTip(event, 'fs135', 1333)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformDir</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span>, <span onmouseout="hideTip(event, 'fs135', 1334)" onmouseover="showTip(event, 'fs135', 1334)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>)
            | <span onmouseout="hideTip(event, 'fs399', 1335)" onmouseover="showTip(event, 'fs399', 1335)" class="p">Z</span> <span class="k">-&gt;</span> <span class="i">Plane3d</span>(<span onmouseout="hideTip(event, 'fs135', 1336)" onmouseover="showTip(event, 'fs135', 1336)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformDir</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OIO</span>, <span onmouseout="hideTip(event, 'fs135', 1337)" onmouseover="showTip(event, 'fs135', 1337)" class="i">trafo</span><span class="o">.</span><span class="i">Forward</span><span class="o">.</span><span class="i">TransformPos</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>)

    <span class="k">type</span> <span onmouseout="hideTip(event, 'fs401', 1338)" onmouseover="showTip(event, 'fs401', 1338)" class="t">Action</span> <span class="o">=</span> 

        <span class="c">// hover overs</span>
        | <span onmouseout="hideTip(event, 'fs402', 1339)" onmouseover="showTip(event, 'fs402', 1339)" class="p">Hover</span>           <span class="k">of</span> <span onmouseout="hideTip(event, 'fs403', 1340)" onmouseover="showTip(event, 'fs403', 1340)" class="t">Axis</span> <span class="o">*</span> <span class="i">V3d</span>
        | <span onmouseout="hideTip(event, 'fs404', 1341)" onmouseover="showTip(event, 'fs404', 1341)" class="p">NoHit</span>       
        | <span onmouseout="hideTip(event, 'fs405', 1342)" onmouseover="showTip(event, 'fs405', 1342)" class="p">MoveRay</span>         <span class="k">of</span> <span class="i">Ray3d</span>

        <span class="c">// translations    </span>
        | <span onmouseout="hideTip(event, 'fs406', 1343)" onmouseover="showTip(event, 'fs406', 1343)" class="p">Translate</span>       <span class="k">of</span> <span onmouseout="hideTip(event, 'fs403', 1344)" onmouseover="showTip(event, 'fs403', 1344)" class="t">Axis</span> <span class="o">*</span> <span class="i">V3d</span>
        | <span onmouseout="hideTip(event, 'fs407', 1345)" onmouseover="showTip(event, 'fs407', 1345)" class="p">EndTranslation</span> 

        | <span onmouseout="hideTip(event, 'fs408', 1346)" onmouseover="showTip(event, 'fs408', 1346)" class="p">ResetTrafo</span>

    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs409', 1347)" onmouseover="showTip(event, 'fs409', 1347)" class="i">TranslateController</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs410', 1348)" onmouseover="showTip(event, 'fs410', 1348)" class="f">hasEnded</span> <span onmouseout="hideTip(event, 'fs411', 1349)" onmouseover="showTip(event, 'fs411', 1349)" class="i">a</span> <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs411', 1350)" onmouseover="showTip(event, 'fs411', 1350)" class="i">a</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs407', 1351)" onmouseover="showTip(event, 'fs407', 1351)" class="p">EndTranslation</span> <span class="k">-&gt;</span> <span class="k">true</span>
            | _ <span class="k">-&gt;</span> <span class="k">false</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs412', 1352)" onmouseover="showTip(event, 'fs412', 1352)" class="f">hover</span>      <span class="o">=</span> <span class="i">curry</span> <span onmouseout="hideTip(event, 'fs402', 1353)" onmouseover="showTip(event, 'fs402', 1353)" class="i">Hover</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs413', 1354)" onmouseover="showTip(event, 'fs413', 1354)" class="f">translate_</span> <span class="o">=</span> <span class="i">curry</span> <span onmouseout="hideTip(event, 'fs406', 1355)" onmouseover="showTip(event, 'fs406', 1355)" class="i">Translate</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs414', 1356)" onmouseover="showTip(event, 'fs414', 1356)" class="i">initalModel</span> <span class="o">=</span> { <span class="i">hovered</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 1357)" onmouseover="showTip(event, 'fs41', 1357)" class="p">None</span>; <span class="i">activeTranslation</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 1358)" onmouseover="showTip(event, 'fs41', 1358)" class="p">None</span>; <span class="i">trafo</span> <span class="o">=</span> <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Identity</span>; <span class="v">_id</span> <span class="o">=</span> <span class="k">null</span> }

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs415', 1359)" onmouseover="showTip(event, 'fs415', 1359)" class="i">initial</span> <span class="o">=</span>  { 
            <span onmouseout="hideTip(event, 'fs24', 1360)" onmouseover="showTip(event, 'fs24', 1360)" class="i">scene</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs414', 1361)" onmouseover="showTip(event, 'fs414', 1361)" class="i">initalModel</span>
            <span onmouseout="hideTip(event, 'fs318', 1362)" onmouseover="showTip(event, 'fs318', 1362)" class="i">camera</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs416', 1363)" onmouseover="showTip(event, 'fs416', 1363)" class="i">Camera</span><span class="o">.</span><span class="i">create</span> ( <span class="i">CameraView</span><span class="o">.</span><span class="i">lookAt</span> (<span class="i">V3d</span><span class="o">.</span><span class="i">III</span><span class="o">*</span><span class="n">3.0</span>) <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span> ) (<span class="i">Frustum</span><span class="o">.</span><span class="i">perspective</span> <span class="n">60.0</span> <span class="n">0.1</span> <span class="n">10.0</span> <span class="n">1.0</span>)
            <span class="v">_id</span> <span class="o">=</span> <span class="k">null</span>
        }


    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs417', 1364)" onmouseover="showTip(event, 'fs417', 1364)" class="f">updateModel</span> (<span onmouseout="hideTip(event, 'fs418', 1365)" onmouseover="showTip(event, 'fs418', 1365)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs419', 1366)" onmouseover="showTip(event, 'fs419', 1366)" class="t">TModel</span>) (<span onmouseout="hideTip(event, 'fs411', 1367)" onmouseover="showTip(event, 'fs411', 1367)" class="i">a</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs401', 1368)" onmouseover="showTip(event, 'fs401', 1368)" class="t">Action</span>) <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs411', 1369)" onmouseover="showTip(event, 'fs411', 1369)" class="i">a</span>, <span onmouseout="hideTip(event, 'fs418', 1370)" onmouseover="showTip(event, 'fs418', 1370)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs420', 1371)" onmouseover="showTip(event, 'fs420', 1371)" class="i">activeTranslation</span> <span class="k">with</span>
            | <span onmouseout="hideTip(event, 'fs404', 1372)" onmouseover="showTip(event, 'fs404', 1372)" class="p">NoHit</span>, _             <span class="k">-&gt;</span>  { <span onmouseout="hideTip(event, 'fs418', 1373)" onmouseover="showTip(event, 'fs418', 1373)" class="i">m</span> <span class="k">with</span> <span class="i">hovered</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 1374)" onmouseover="showTip(event, 'fs41', 1374)" class="p">None</span>; }
            | <span onmouseout="hideTip(event, 'fs402', 1375)" onmouseover="showTip(event, 'fs402', 1375)" class="p">Hover</span> (<span onmouseout="hideTip(event, 'fs421', 1376)" onmouseover="showTip(event, 'fs421', 1376)" class="i">v</span>,_), _       <span class="k">-&gt;</span>  { <span onmouseout="hideTip(event, 'fs418', 1377)" onmouseover="showTip(event, 'fs418', 1377)" class="i">m</span> <span class="k">with</span> <span class="i">hovered</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1378)" onmouseover="showTip(event, 'fs42', 1378)" class="p">Some</span> <span onmouseout="hideTip(event, 'fs421', 1379)" onmouseover="showTip(event, 'fs421', 1379)" class="i">v</span>}
            | <span onmouseout="hideTip(event, 'fs406', 1380)" onmouseover="showTip(event, 'fs406', 1380)" class="p">Translate</span> (<span onmouseout="hideTip(event, 'fs422', 1381)" onmouseover="showTip(event, 'fs422', 1381)" class="i">dir</span>,<span onmouseout="hideTip(event, 'fs92', 1382)" onmouseover="showTip(event, 'fs92', 1382)" class="i">s</span>), _ <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs418', 1383)" onmouseover="showTip(event, 'fs418', 1383)" class="i">m</span> <span class="k">with</span> <span class="i">activeTranslation</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs42', 1384)" onmouseover="showTip(event, 'fs42', 1384)" class="p">Some</span> (<span onmouseout="hideTip(event, 'fs403', 1385)" onmouseover="showTip(event, 'fs403', 1385)" class="i">Axis</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs400', 1386)" onmouseover="showTip(event, 'fs400', 1386)" class="i">moveAxis</span> <span onmouseout="hideTip(event, 'fs418', 1387)" onmouseover="showTip(event, 'fs418', 1387)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs423', 1388)" onmouseover="showTip(event, 'fs423', 1388)" class="i">trafo</span> <span onmouseout="hideTip(event, 'fs422', 1389)" onmouseover="showTip(event, 'fs422', 1389)" class="i">dir</span>, <span onmouseout="hideTip(event, 'fs418', 1390)" onmouseover="showTip(event, 'fs418', 1390)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs423', 1391)" onmouseover="showTip(event, 'fs423', 1391)" class="i">trafo</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs424', 1392)" onmouseover="showTip(event, 'fs424', 1392)" class="i">Backward</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs425', 1393)" onmouseover="showTip(event, 'fs425', 1393)" class="i">TransformPos</span> <span onmouseout="hideTip(event, 'fs92', 1394)" onmouseover="showTip(event, 'fs92', 1394)" class="i">s</span>) }
            | <span onmouseout="hideTip(event, 'fs407', 1395)" onmouseover="showTip(event, 'fs407', 1395)" class="p">EndTranslation</span>, _    <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs418', 1396)" onmouseover="showTip(event, 'fs418', 1396)" class="i">m</span> <span class="k">with</span> <span class="i">activeTranslation</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs41', 1397)" onmouseover="showTip(event, 'fs41', 1397)" class="p">None</span>;  }
            | <span onmouseout="hideTip(event, 'fs405', 1398)" onmouseover="showTip(event, 'fs405', 1398)" class="i">MoveRay</span> <span class="i">r</span>, <span onmouseout="hideTip(event, 'fs42', 1399)" onmouseover="showTip(event, 'fs42', 1399)" class="i">Some</span> (<span class="i">t</span>,<span class="i">start</span>) <span class="k">-&gt;</span> 
                <span class="k">let</span> <span class="k">mutable</span> <span class="i">ha</span> <span class="o">=</span> <span class="i">RayHit3d</span><span class="o">.</span><span class="i">MaxRange</span>
                <span class="k">if</span> <span class="i">r</span><span class="o">.</span><span class="i">HitsPlane</span>(<span class="i">t</span>,<span class="n">0.0</span>,<span onmouseout="hideTip(event, 'fs140', 1400)" onmouseover="showTip(event, 'fs140', 1400)" class="i">Double</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs143', 1401)" onmouseover="showTip(event, 'fs143', 1401)" class="i">MaxValue</span>,<span class="o">&amp;</span><span class="i">ha</span>) <span class="k">then</span>
                    <span class="k">let</span> <span class="i">v</span> <span class="o">=</span> (<span class="i">ha</span><span class="o">.</span><span class="i">Point</span> <span class="o">-</span> <span class="i">start</span>)<span class="o">.</span><span class="i">XOO</span>
                    { <span onmouseout="hideTip(event, 'fs418', 1402)" onmouseover="showTip(event, 'fs418', 1402)" class="i">m</span> <span class="k">with</span> <span class="i">trafo</span> <span class="o">=</span> <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Translation</span> (<span class="i">ha</span><span class="o">.</span><span class="i">Point</span> <span class="o">-</span> <span class="i">start</span>) }
                <span class="k">else</span> <span onmouseout="hideTip(event, 'fs418', 1403)" onmouseover="showTip(event, 'fs418', 1403)" class="i">m</span>
            | <span onmouseout="hideTip(event, 'fs405', 1404)" onmouseover="showTip(event, 'fs405', 1404)" class="i">MoveRay</span> <span class="i">r</span>, <span onmouseout="hideTip(event, 'fs41', 1405)" onmouseover="showTip(event, 'fs41', 1405)" class="i">None</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs418', 1406)" onmouseover="showTip(event, 'fs418', 1406)" class="i">m</span>
            | <span onmouseout="hideTip(event, 'fs408', 1407)" onmouseover="showTip(event, 'fs408', 1407)" class="i">ResetTrafo</span>, _ <span class="k">-&gt;</span> { <span onmouseout="hideTip(event, 'fs418', 1408)" onmouseover="showTip(event, 'fs418', 1408)" class="i">m</span> <span class="k">with</span> <span class="i">trafo</span> <span class="o">=</span> <span class="i">Trafo3d</span><span class="o">.</span><span class="i">Identity</span> }

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs426', 1409)" onmouseover="showTip(event, 'fs426', 1409)" class="f">update</span> <span onmouseout="hideTip(event, 'fs289', 1410)" onmouseover="showTip(event, 'fs289', 1410)" class="i">e</span> (<span onmouseout="hideTip(event, 'fs427', 1411)" onmouseover="showTip(event, 'fs427', 1411)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs428', 1412)" onmouseover="showTip(event, 'fs428', 1412)" class="t">Scene</span>) (<span onmouseout="hideTip(event, 'fs411', 1413)" onmouseover="showTip(event, 'fs411', 1413)" class="i">a</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs401', 1414)" onmouseover="showTip(event, 'fs401', 1414)" class="t">Action</span>) <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs429', 1415)" onmouseover="showTip(event, 'fs429', 1415)" class="i">scene</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs417', 1416)" onmouseover="showTip(event, 'fs417', 1416)" class="f">updateModel</span> <span onmouseout="hideTip(event, 'fs427', 1417)" onmouseover="showTip(event, 'fs427', 1417)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs430', 1418)" onmouseover="showTip(event, 'fs430', 1418)" class="i">scene</span> <span onmouseout="hideTip(event, 'fs411', 1419)" onmouseover="showTip(event, 'fs411', 1419)" class="i">a</span>
        { <span onmouseout="hideTip(event, 'fs427', 1420)" onmouseover="showTip(event, 'fs427', 1420)" class="i">m</span> <span class="k">with</span> <span onmouseout="hideTip(event, 'fs429', 1421)" onmouseover="showTip(event, 'fs429', 1421)" class="i">scene</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs429', 1422)" onmouseover="showTip(event, 'fs429', 1422)" class="i">scene</span> }

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs431', 1423)" onmouseover="showTip(event, 'fs431', 1423)" class="f">viewModel</span> (<span onmouseout="hideTip(event, 'fs432', 1424)" onmouseover="showTip(event, 'fs432', 1424)" class="i">m</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs433', 1425)" onmouseover="showTip(event, 'fs433', 1425)" class="t">MTModel</span>) <span class="o">=</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs434', 1426)" onmouseover="showTip(event, 'fs434', 1426)" class="f">arrow</span> <span onmouseout="hideTip(event, 'fs435', 1427)" onmouseover="showTip(event, 'fs435', 1427)" class="i">dir</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs436', 1428)" onmouseover="showTip(event, 'fs436', 1428)" class="p">Cone</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span onmouseout="hideTip(event, 'fs435', 1429)" onmouseover="showTip(event, 'fs435', 1429)" class="i">dir</span>,<span class="n">0.3</span>,<span class="n">0.1</span>)

        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs437', 1430)" onmouseover="showTip(event, 'fs437', 1430)" class="f">ifHit</span> (<span onmouseout="hideTip(event, 'fs438', 1431)" onmouseover="showTip(event, 'fs438', 1431)" class="i">a</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs403', 1432)" onmouseover="showTip(event, 'fs403', 1432)" class="t">Axis</span>) (<span onmouseout="hideTip(event, 'fs439', 1433)" onmouseover="showTip(event, 'fs439', 1433)" class="i">selection</span> <span class="o">:</span> <span class="i">C4b</span>) (<span onmouseout="hideTip(event, 'fs440', 1434)" onmouseover="showTip(event, 'fs440', 1434)" class="i">defaultColor</span> <span class="o">:</span> <span class="i">C4b</span>) <span class="o">=</span>
            <span class="i">adaptive</span> {
                <span class="k">let!</span> <span class="i">hovered</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs432', 1435)" onmouseover="showTip(event, 'fs432', 1435)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs441', 1436)" onmouseover="showTip(event, 'fs441', 1436)" class="i">mhovered</span>
                <span class="k">match</span> <span class="i">hovered</span> <span class="k">with</span>
                    | <span onmouseout="hideTip(event, 'fs42', 1437)" onmouseover="showTip(event, 'fs42', 1437)" class="i">Some</span> <span class="i">v</span> <span class="k">when</span> <span class="i">v</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs438', 1438)" onmouseover="showTip(event, 'fs438', 1438)" class="i">a</span> <span class="k">-&gt;</span> <span class="k">return</span> <span onmouseout="hideTip(event, 'fs439', 1439)" onmouseover="showTip(event, 'fs439', 1439)" class="i">selection</span>
                    | _ <span class="k">-&gt;</span> <span class="k">return</span> <span onmouseout="hideTip(event, 'fs440', 1440)" onmouseover="showTip(event, 'fs440', 1440)" class="i">defaultColor</span>
            }
            
        <span onmouseout="hideTip(event, 'fs344', 1441)" onmouseover="showTip(event, 'fs344', 1441)" class="f">transform</span> <span onmouseout="hideTip(event, 'fs432', 1442)" onmouseover="showTip(event, 'fs432', 1442)" class="i">m</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs442', 1443)" onmouseover="showTip(event, 'fs442', 1443)" class="i">mtrafo</span> [
                <span onmouseout="hideTip(event, 'fs443', 1444)" onmouseover="showTip(event, 'fs443', 1444)" class="f">translate</span> <span class="n">1.0</span> <span class="n">0.0</span> <span class="n">0.0</span> [
                    [ <span onmouseout="hideTip(event, 'fs434', 1445)" onmouseover="showTip(event, 'fs434', 1445)" class="f">arrow</span> <span class="i">V3d</span><span class="o">.</span><span class="i">IOO</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1446)" onmouseover="showTip(event, 'fs298', 1446)" class="f">render</span> [<span onmouseout="hideTip(event, 'fs306', 1447)" onmouseover="showTip(event, 'fs306', 1447)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1448)" onmouseover="showTip(event, 'fs307', 1448)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1449)" onmouseover="showTip(event, 'fs308', 1449)" class="f">move</span> (<span onmouseout="hideTip(event, 'fs412', 1450)" onmouseover="showTip(event, 'fs412', 1450)" class="f">hover</span> <span onmouseout="hideTip(event, 'fs397', 1451)" onmouseover="showTip(event, 'fs397', 1451)" class="p">X</span>); <span onmouseout="hideTip(event, 'fs306', 1452)" onmouseover="showTip(event, 'fs306', 1452)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1453)" onmouseover="showTip(event, 'fs307', 1453)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs444', 1454)" onmouseover="showTip(event, 'fs444', 1454)" class="f">down</span> (<span onmouseout="hideTip(event, 'fs413', 1455)" onmouseover="showTip(event, 'fs413', 1455)" class="f">translate_</span> <span onmouseout="hideTip(event, 'fs397', 1456)" onmouseover="showTip(event, 'fs397', 1456)" class="p">X</span>)] ] 
                        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1457)" onmouseover="showTip(event, 'fs310', 1457)" class="f">colored</span> (<span onmouseout="hideTip(event, 'fs437', 1458)" onmouseover="showTip(event, 'fs437', 1458)" class="f">ifHit</span> <span onmouseout="hideTip(event, 'fs397', 1459)" onmouseover="showTip(event, 'fs397', 1459)" class="p">X</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> <span class="i">C4b</span><span class="o">.</span><span class="i">DarkRed</span>)
                ]
                <span onmouseout="hideTip(event, 'fs443', 1460)" onmouseover="showTip(event, 'fs443', 1460)" class="f">translate</span> <span class="n">0.0</span> <span class="n">1.0</span> <span class="n">0.0</span> [
                    [ <span onmouseout="hideTip(event, 'fs434', 1461)" onmouseover="showTip(event, 'fs434', 1461)" class="f">arrow</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OIO</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1462)" onmouseover="showTip(event, 'fs298', 1462)" class="f">render</span> [<span onmouseout="hideTip(event, 'fs306', 1463)" onmouseover="showTip(event, 'fs306', 1463)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1464)" onmouseover="showTip(event, 'fs307', 1464)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1465)" onmouseover="showTip(event, 'fs308', 1465)" class="f">move</span> (<span onmouseout="hideTip(event, 'fs412', 1466)" onmouseover="showTip(event, 'fs412', 1466)" class="f">hover</span> <span onmouseout="hideTip(event, 'fs398', 1467)" onmouseover="showTip(event, 'fs398', 1467)" class="p">Y</span>); <span onmouseout="hideTip(event, 'fs306', 1468)" onmouseover="showTip(event, 'fs306', 1468)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1469)" onmouseover="showTip(event, 'fs307', 1469)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs444', 1470)" onmouseover="showTip(event, 'fs444', 1470)" class="f">down</span> (<span onmouseout="hideTip(event, 'fs413', 1471)" onmouseover="showTip(event, 'fs413', 1471)" class="f">translate_</span> <span onmouseout="hideTip(event, 'fs398', 1472)" onmouseover="showTip(event, 'fs398', 1472)" class="p">Y</span>)] ] 
                        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1473)" onmouseover="showTip(event, 'fs310', 1473)" class="f">colored</span> (<span onmouseout="hideTip(event, 'fs437', 1474)" onmouseover="showTip(event, 'fs437', 1474)" class="f">ifHit</span> <span onmouseout="hideTip(event, 'fs398', 1475)" onmouseover="showTip(event, 'fs398', 1475)" class="p">Y</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> <span class="i">C4b</span><span class="o">.</span><span class="i">DarkBlue</span>)
                ]
                <span onmouseout="hideTip(event, 'fs443', 1476)" onmouseover="showTip(event, 'fs443', 1476)" class="f">translate</span> <span class="n">0.0</span> <span class="n">0.0</span> <span class="n">1.0</span> [
                    [ <span onmouseout="hideTip(event, 'fs434', 1477)" onmouseover="showTip(event, 'fs434', 1477)" class="f">arrow</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1478)" onmouseover="showTip(event, 'fs298', 1478)" class="f">render</span> [<span onmouseout="hideTip(event, 'fs306', 1479)" onmouseover="showTip(event, 'fs306', 1479)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1480)" onmouseover="showTip(event, 'fs307', 1480)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1481)" onmouseover="showTip(event, 'fs308', 1481)" class="f">move</span> (<span onmouseout="hideTip(event, 'fs412', 1482)" onmouseover="showTip(event, 'fs412', 1482)" class="f">hover</span> <span onmouseout="hideTip(event, 'fs399', 1483)" onmouseover="showTip(event, 'fs399', 1483)" class="p">Z</span>); <span onmouseout="hideTip(event, 'fs306', 1484)" onmouseover="showTip(event, 'fs306', 1484)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1485)" onmouseover="showTip(event, 'fs307', 1485)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs444', 1486)" onmouseover="showTip(event, 'fs444', 1486)" class="f">down</span> (<span onmouseout="hideTip(event, 'fs413', 1487)" onmouseover="showTip(event, 'fs413', 1487)" class="f">translate_</span> <span onmouseout="hideTip(event, 'fs399', 1488)" onmouseover="showTip(event, 'fs399', 1488)" class="p">Z</span>)] ] 
                        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1489)" onmouseover="showTip(event, 'fs310', 1489)" class="f">colored</span> (<span onmouseout="hideTip(event, 'fs437', 1490)" onmouseover="showTip(event, 'fs437', 1490)" class="f">ifHit</span> <span onmouseout="hideTip(event, 'fs399', 1491)" onmouseover="showTip(event, 'fs399', 1491)" class="p">Z</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> <span class="i">C4b</span><span class="o">.</span><span class="i">DarkGreen</span>)
                ]

                [ <span onmouseout="hideTip(event, 'fs296', 1492)" onmouseover="showTip(event, 'fs296', 1492)" class="f">cylinder</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">IOO</span> <span class="n">1.0</span> <span class="n">0.05</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1493)" onmouseover="showTip(event, 'fs298', 1493)" class="f">render</span> [ <span onmouseout="hideTip(event, 'fs306', 1494)" onmouseover="showTip(event, 'fs306', 1494)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1495)" onmouseover="showTip(event, 'fs307', 1495)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1496)" onmouseover="showTip(event, 'fs308', 1496)" class="f">move</span> (<span onmouseout="hideTip(event, 'fs412', 1497)" onmouseover="showTip(event, 'fs412', 1497)" class="f">hover</span> <span onmouseout="hideTip(event, 'fs397', 1498)" onmouseover="showTip(event, 'fs397', 1498)" class="p">X</span>); <span onmouseout="hideTip(event, 'fs306', 1499)" onmouseover="showTip(event, 'fs306', 1499)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1500)" onmouseover="showTip(event, 'fs307', 1500)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs444', 1501)" onmouseover="showTip(event, 'fs444', 1501)" class="f">down</span> (<span onmouseout="hideTip(event, 'fs413', 1502)" onmouseover="showTip(event, 'fs413', 1502)" class="f">translate_</span> <span onmouseout="hideTip(event, 'fs397', 1503)" onmouseover="showTip(event, 'fs397', 1503)" class="p">X</span>) ] ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1504)" onmouseover="showTip(event, 'fs310', 1504)" class="f">colored</span> (<span onmouseout="hideTip(event, 'fs437', 1505)" onmouseover="showTip(event, 'fs437', 1505)" class="f">ifHit</span> <span onmouseout="hideTip(event, 'fs397', 1506)" onmouseover="showTip(event, 'fs397', 1506)" class="p">X</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> <span class="i">C4b</span><span class="o">.</span><span class="i">DarkRed</span>)
                [ <span onmouseout="hideTip(event, 'fs296', 1507)" onmouseover="showTip(event, 'fs296', 1507)" class="f">cylinder</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OIO</span> <span class="n">1.0</span> <span class="n">0.05</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1508)" onmouseover="showTip(event, 'fs298', 1508)" class="f">render</span> [ <span onmouseout="hideTip(event, 'fs306', 1509)" onmouseover="showTip(event, 'fs306', 1509)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1510)" onmouseover="showTip(event, 'fs307', 1510)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1511)" onmouseover="showTip(event, 'fs308', 1511)" class="f">move</span> (<span onmouseout="hideTip(event, 'fs412', 1512)" onmouseover="showTip(event, 'fs412', 1512)" class="f">hover</span> <span onmouseout="hideTip(event, 'fs398', 1513)" onmouseover="showTip(event, 'fs398', 1513)" class="p">Y</span>); <span onmouseout="hideTip(event, 'fs306', 1514)" onmouseover="showTip(event, 'fs306', 1514)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1515)" onmouseover="showTip(event, 'fs307', 1515)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs444', 1516)" onmouseover="showTip(event, 'fs444', 1516)" class="f">down</span> (<span onmouseout="hideTip(event, 'fs413', 1517)" onmouseover="showTip(event, 'fs413', 1517)" class="f">translate_</span> <span onmouseout="hideTip(event, 'fs398', 1518)" onmouseover="showTip(event, 'fs398', 1518)" class="p">Y</span>) ] ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1519)" onmouseover="showTip(event, 'fs310', 1519)" class="f">colored</span> (<span onmouseout="hideTip(event, 'fs437', 1520)" onmouseover="showTip(event, 'fs437', 1520)" class="f">ifHit</span> <span onmouseout="hideTip(event, 'fs398', 1521)" onmouseover="showTip(event, 'fs398', 1521)" class="p">Y</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> <span class="i">C4b</span><span class="o">.</span><span class="i">DarkBlue</span>)
                [ <span onmouseout="hideTip(event, 'fs296', 1522)" onmouseover="showTip(event, 'fs296', 1522)" class="f">cylinder</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span> <span class="n">1.0</span> <span class="n">0.05</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1523)" onmouseover="showTip(event, 'fs298', 1523)" class="f">render</span> [ <span onmouseout="hideTip(event, 'fs306', 1524)" onmouseover="showTip(event, 'fs306', 1524)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1525)" onmouseover="showTip(event, 'fs307', 1525)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1526)" onmouseover="showTip(event, 'fs308', 1526)" class="f">move</span> (<span onmouseout="hideTip(event, 'fs412', 1527)" onmouseover="showTip(event, 'fs412', 1527)" class="f">hover</span> <span onmouseout="hideTip(event, 'fs399', 1528)" onmouseover="showTip(event, 'fs399', 1528)" class="p">Z</span>); <span onmouseout="hideTip(event, 'fs306', 1529)" onmouseover="showTip(event, 'fs306', 1529)" class="f">on</span> <span onmouseout="hideTip(event, 'fs307', 1530)" onmouseover="showTip(event, 'fs307', 1530)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs444', 1531)" onmouseover="showTip(event, 'fs444', 1531)" class="f">down</span> (<span onmouseout="hideTip(event, 'fs413', 1532)" onmouseover="showTip(event, 'fs413', 1532)" class="f">translate_</span> <span onmouseout="hideTip(event, 'fs399', 1533)" onmouseover="showTip(event, 'fs399', 1533)" class="p">Z</span>) ] ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1534)" onmouseover="showTip(event, 'fs310', 1534)" class="f">colored</span> (<span onmouseout="hideTip(event, 'fs437', 1535)" onmouseover="showTip(event, 'fs437', 1535)" class="f">ifHit</span> <span onmouseout="hideTip(event, 'fs399', 1536)" onmouseover="showTip(event, 'fs399', 1536)" class="p">Z</span> <span class="i">C4b</span><span class="o">.</span><span class="i">White</span> <span class="i">C4b</span><span class="o">.</span><span class="i">DarkGreen</span>)
                
                <span onmouseout="hideTip(event, 'fs443', 1537)" onmouseover="showTip(event, 'fs443', 1537)" class="f">translate</span> <span class="n">0.0</span> <span class="n">0.0</span> <span class="n">0.0</span> [
                    [ <span class="i">Sphere3d</span>(<span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span>,<span class="n">0.1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs311', 1538)" onmouseover="showTip(event, 'fs311', 1538)" class="p">Sphere</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1539)" onmouseover="showTip(event, 'fs298', 1539)" class="f">render</span> <span onmouseout="hideTip(event, 'fs299', 1540)" onmouseover="showTip(event, 'fs299', 1540)" class="t">Pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs300', 1541)" onmouseover="showTip(event, 'fs300', 1541)" class="i">ignore</span> ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs310', 1542)" onmouseover="showTip(event, 'fs310', 1542)" class="f">colored</span> (<span class="i">Mod</span><span class="o">.</span><span class="i">constant</span> <span class="i">C4b</span><span class="o">.</span><span class="i">Gray</span>)
                ]

                <span onmouseout="hideTip(event, 'fs445', 1543)" onmouseover="showTip(event, 'fs445', 1543)" class="p">Everything</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs298', 1544)" onmouseover="showTip(event, 'fs298', 1544)" class="f">render</span> [<span onmouseout="hideTip(event, 'fs446', 1545)" onmouseover="showTip(event, 'fs446', 1545)" class="f">whenever</span> <span onmouseout="hideTip(event, 'fs307', 1546)" onmouseover="showTip(event, 'fs307', 1546)" class="t">Mouse</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs308', 1547)" onmouseover="showTip(event, 'fs308', 1547)" class="f">move</span> <span onmouseout="hideTip(event, 'fs405', 1548)" onmouseover="showTip(event, 'fs405', 1548)" class="p">MoveRay</span>]
        ]

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs447', 1549)" onmouseover="showTip(event, 'fs447', 1549)" class="f">viewScene</span> (<span onmouseout="hideTip(event, 'fs315', 1550)" onmouseover="showTip(event, 'fs315', 1550)" class="i">sizes</span> <span class="o">:</span> <span class="i">IMod</span><span class="o">&lt;</span><span class="i">V2i</span><span class="o">&gt;</span>) <span onmouseout="hideTip(event, 'fs448', 1551)" onmouseover="showTip(event, 'fs448', 1551)" class="i">s</span> <span class="o">=</span>   
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs316', 1552)" onmouseover="showTip(event, 'fs316', 1552)" class="i">cameraView</span> <span class="o">=</span> <span class="i">CameraView</span><span class="o">.</span><span class="i">lookAt</span> (<span class="i">V3d</span><span class="o">.</span><span class="i">III</span> <span class="o">*</span> <span class="n">3.0</span>) <span class="i">V3d</span><span class="o">.</span><span class="i">OOO</span> <span class="i">V3d</span><span class="o">.</span><span class="i">OOI</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span class="i">constant</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs317', 1553)" onmouseover="showTip(event, 'fs317', 1553)" class="i">frustum</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs315', 1554)" onmouseover="showTip(event, 'fs315', 1554)" class="i">sizes</span> <span class="o">|&gt;</span> <span class="i">Mod</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs449', 1555)" onmouseover="showTip(event, 'fs449', 1555)" class="i">map</span> (<span class="k">fun</span> (<span class="i">b</span> <span class="o">:</span> <span class="i">V2i</span>) <span class="k">-&gt;</span> <span class="i">Frustum</span><span class="o">.</span><span class="i">perspective</span> <span class="n">60.0</span> <span class="n">0.1</span> <span class="n">10.0</span> (<span onmouseout="hideTip(event, 'fs15', 1556)" onmouseover="showTip(event, 'fs15', 1556)" class="i">float</span> <span class="i">b</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs397', 1557)" onmouseover="showTip(event, 'fs397', 1557)" class="i">X</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs15', 1558)" onmouseover="showTip(event, 'fs15', 1558)" class="i">float</span> <span class="i">b</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs398', 1559)" onmouseover="showTip(event, 'fs398', 1559)" class="i">Y</span>))
        <span onmouseout="hideTip(event, 'fs431', 1560)" onmouseover="showTip(event, 'fs431', 1560)" class="f">viewModel</span> <span onmouseout="hideTip(event, 'fs448', 1561)" onmouseover="showTip(event, 'fs448', 1561)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs450', 1562)" onmouseover="showTip(event, 'fs450', 1562)" class="i">mscene</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs428', 1563)" onmouseover="showTip(event, 'fs428', 1563)" class="t">Scene</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs318', 1564)" onmouseover="showTip(event, 'fs318', 1564)" class="f">camera</span> (<span class="i">Mod</span><span class="o">.</span><span class="i">map2</span> <span onmouseout="hideTip(event, 'fs416', 1565)" onmouseover="showTip(event, 'fs416', 1565)" class="i">Camera</span><span class="o">.</span><span class="i">create</span> <span onmouseout="hideTip(event, 'fs316', 1566)" onmouseover="showTip(event, 'fs316', 1566)" class="i">cameraView</span> <span onmouseout="hideTip(event, 'fs317', 1567)" onmouseover="showTip(event, 'fs317', 1567)" class="i">frustum</span>)
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs319', 1568)" onmouseover="showTip(event, 'fs319', 1568)" class="f">effect</span> [<span class="i">toEffect</span> <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">trafo</span>; <span class="i">toEffect</span> <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">vertexColor</span>; <span class="i">toEffect</span> <span class="i">DefaultSurfaces</span><span class="o">.</span><span class="i">simpleLighting</span>]

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs451', 1569)" onmouseover="showTip(event, 'fs451', 1569)" class="f">ofPickMsgModel</span> (<span onmouseout="hideTip(event, 'fs452', 1570)" onmouseover="showTip(event, 'fs452', 1570)" class="i">model</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs419', 1571)" onmouseover="showTip(event, 'fs419', 1571)" class="t">TModel</span>) (<span onmouseout="hideTip(event, 'fs453', 1572)" onmouseover="showTip(event, 'fs453', 1572)" class="i">pick</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs454', 1573)" onmouseover="showTip(event, 'fs454', 1573)" class="t">GlobalPick</span>) <span class="o">=</span>
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs453', 1574)" onmouseover="showTip(event, 'fs453', 1574)" class="i">pick</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs455', 1575)" onmouseover="showTip(event, 'fs455', 1575)" class="i">mouseEvent</span> <span class="k">with</span>   
            | <span onmouseout="hideTip(event, 'fs456', 1576)" onmouseover="showTip(event, 'fs456', 1576)" class="t">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs457', 1577)" onmouseover="showTip(event, 'fs457', 1577)" class="p">Click</span> _ | <span onmouseout="hideTip(event, 'fs456', 1578)" onmouseover="showTip(event, 'fs456', 1578)" class="t">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs458', 1579)" onmouseover="showTip(event, 'fs458', 1579)" class="p">Down</span> _  <span class="k">-&gt;</span> []
            | <span onmouseout="hideTip(event, 'fs456', 1580)" onmouseover="showTip(event, 'fs456', 1580)" class="t">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs459', 1581)" onmouseover="showTip(event, 'fs459', 1581)" class="p">Move</span> <span class="k">when</span> <span onmouseout="hideTip(event, 'fs9', 1582)" onmouseover="showTip(event, 'fs9', 1582)" class="t">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs460', 1583)" onmouseover="showTip(event, 'fs460', 1583)" class="f">isNone</span> <span onmouseout="hideTip(event, 'fs452', 1584)" onmouseover="showTip(event, 'fs452', 1584)" class="i">model</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs420', 1585)" onmouseover="showTip(event, 'fs420', 1585)" class="i">activeTranslation</span> <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs404', 1586)" onmouseover="showTip(event, 'fs404', 1586)" class="p">NoHit</span>]
            | <span onmouseout="hideTip(event, 'fs456', 1587)" onmouseover="showTip(event, 'fs456', 1587)" class="t">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs459', 1588)" onmouseover="showTip(event, 'fs459', 1588)" class="p">Move</span> <span class="k">-&gt;</span>  []
            | <span onmouseout="hideTip(event, 'fs456', 1589)" onmouseover="showTip(event, 'fs456', 1589)" class="t">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs461', 1590)" onmouseover="showTip(event, 'fs461', 1590)" class="p">Up</span> _   <span class="k">-&gt;</span> [<span onmouseout="hideTip(event, 'fs407', 1591)" onmouseover="showTip(event, 'fs407', 1591)" class="p">EndTranslation</span>]
            | <span onmouseout="hideTip(event, 'fs456', 1592)" onmouseover="showTip(event, 'fs456', 1592)" class="t">MouseEvent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs462', 1593)" onmouseover="showTip(event, 'fs462', 1593)" class="p">NoEvent</span> <span class="k">-&gt;</span> []

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs463', 1594)" onmouseover="showTip(event, 'fs463', 1594)" class="f">ofPickMsg</span> (<span onmouseout="hideTip(event, 'fs464', 1595)" onmouseover="showTip(event, 'fs464', 1595)" class="i">model</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs428', 1596)" onmouseover="showTip(event, 'fs428', 1596)" class="t">Scene</span>) <span onmouseout="hideTip(event, 'fs465', 1597)" onmouseover="showTip(event, 'fs465', 1597)" class="i">noPick</span> <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs451', 1598)" onmouseover="showTip(event, 'fs451', 1598)" class="f">ofPickMsgModel</span> <span onmouseout="hideTip(event, 'fs464', 1599)" onmouseover="showTip(event, 'fs464', 1599)" class="i">model</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs430', 1600)" onmouseover="showTip(event, 'fs430', 1600)" class="i">scene</span> <span onmouseout="hideTip(event, 'fs465', 1601)" onmouseover="showTip(event, 'fs465', 1601)" class="i">noPick</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs466', 1602)" onmouseover="showTip(event, 'fs466', 1602)" class="f">app</span> (<span onmouseout="hideTip(event, 'fs315', 1603)" onmouseover="showTip(event, 'fs315', 1603)" class="i">sizes</span> <span class="o">:</span> <span class="i">IMod</span><span class="o">&lt;</span><span class="i">V2i</span><span class="o">&gt;</span>) <span class="o">=</span> {
        <span onmouseout="hideTip(event, 'fs415', 1604)" onmouseover="showTip(event, 'fs415', 1604)" class="i">initial</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs415', 1605)" onmouseover="showTip(event, 'fs415', 1605)" class="i">initial</span>
        <span onmouseout="hideTip(event, 'fs426', 1606)" onmouseover="showTip(event, 'fs426', 1606)" class="i">update</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs426', 1607)" onmouseover="showTip(event, 'fs426', 1607)" class="f">update</span>
        <span class="i">view</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs447', 1608)" onmouseover="showTip(event, 'fs447', 1608)" class="f">viewScene</span> <span onmouseout="hideTip(event, 'fs315', 1609)" onmouseover="showTip(event, 'fs315', 1609)" class="i">sizes</span>
        <span onmouseout="hideTip(event, 'fs463', 1610)" onmouseover="showTip(event, 'fs463', 1610)" class="i">ofPickMsg</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs463', 1611)" onmouseover="showTip(event, 'fs463', 1611)" class="f">ofPickMsg</span>
        <span class="i">subscriptions</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs323', 1612)" onmouseover="showTip(event, 'fs323', 1612)" class="t">Subscriptions</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs324', 1613)" onmouseover="showTip(event, 'fs324', 1613)" class="f">none</span>
    }
</code></pre></td>
</tr>
</table>
<h3>Composing translation controller and polygon drawing</h3>
<h2>Related Work</h2>
<h2>Conclusions</h2>
<p>In this work we used the ELM architecture in the context of 3D graphics. We developed a DSL for specifying
3D scenes and user interaction with graphical elements in a purely functional manner.
When rendering UI elements, the resulting scene description can be efficiently rendered using
HTML virtual dom diffing. This approach is not feasable for data intensive 3D applications.
In this paper we show how to compute changes of immutable data structures in order to use those changes
in the incremental rendering engine provided by the aardvark platform.</p>

                <div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace Aardvark</div>
<div class="tip" id="fs3">namespace Aardvark.Base</div>
<div class="tip" id="fs4">type Polygon = obj<br /><br />Full name: Elmish.Polygon</div>
<div class="tip" id="fs5">type &#39;T list = List&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.list&lt;_&gt;</div>
<div class="tip" id="fs6">type OpenPolygon =<br />&#160;&#160;{finishedPoints: obj;<br />&#160;&#160;&#160;cursor: obj;}<br /><br />Full name: Elmish.OpenPolygon</div>
<div class="tip" id="fs7">OpenPolygon.finishedPoints: obj</div>
<div class="tip" id="fs8">OpenPolygon.cursor: obj</div>
<div class="tip" id="fs9">module Option<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs10">type DrawingModel =<br />&#160;&#160;{finished: Polygon list;<br />&#160;&#160;&#160;working: Option&lt;OpenPolygon&gt;;}<br /><br />Full name: Elmish.DrawingModel</div>
<div class="tip" id="fs11">DrawingModel.finished: Polygon list</div>
<div class="tip" id="fs12">DrawingModel.working: Option&lt;OpenPolygon&gt;</div>
<div class="tip" id="fs13">type Primitive =<br />&#160;&#160;| Sphere of center: obj * radius: float<br />&#160;&#160;| Cone of center: obj * dir: obj * height: float * radius: float<br />&#160;&#160;| Cylinder of center: obj * dir: obj * height: float * radius: float<br />&#160;&#160;| Quad of obj<br /><br />Full name: Elmish.Primitive</div>
<div class="tip" id="fs14">union case Primitive.Sphere: center: obj * radius: float -&gt; Primitive</div>
<div class="tip" id="fs15">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs16">union case Primitive.Cone: center: obj * dir: obj * height: float * radius: float -&gt; Primitive</div>
<div class="tip" id="fs17">union case Primitive.Cylinder: center: obj * dir: obj * height: float * radius: float -&gt; Primitive</div>
<div class="tip" id="fs18">union case Primitive.Quad: obj -&gt; Primitive</div>
<div class="tip" id="fs19">type Scene1 =<br />&#160;&#160;| Transform of obj * Scene1 list<br />&#160;&#160;| Colored of obj * Scene1 list<br />&#160;&#160;| Render of Primitive<br />&#160;&#160;| Group of Scene1 list<br /><br />Full name: Elmish.Scene1</div>
<div class="tip" id="fs20">union case Scene1.Transform: obj * Scene1 list -&gt; Scene1</div>
<div class="tip" id="fs21">union case Scene1.Colored: obj * Scene1 list -&gt; Scene1</div>
<div class="tip" id="fs22">union case Scene1.Render: Primitive -&gt; Scene1</div>
<div class="tip" id="fs23">union case Scene1.Group: Scene1 list -&gt; Scene1</div>
<div class="tip" id="fs24">val scene : Scene1<br /><br />Full name: Elmish.scene</div>
<div class="tip" id="fs25">val colored1 : c:&#39;a -&gt; xs:Scene1 list -&gt; Scene1<br /><br />Full name: Elmish.colored1</div>
<div class="tip" id="fs26">val c : &#39;a</div>
<div class="tip" id="fs27">val xs : Scene1 list</div>
<div class="tip" id="fs28">val transformed1 : t:&#39;a -&gt; x:Scene1 -&gt; Scene1<br /><br />Full name: Elmish.transformed1</div>
<div class="tip" id="fs29">val t : &#39;a</div>
<div class="tip" id="fs30">val x : Scene1</div>
<div class="tip" id="fs31">val view1 : m:DrawingModel -&gt; Scene1<br /><br />Full name: Elmish.view1</div>
<div class="tip" id="fs32">val m : DrawingModel</div>
<div class="tip" id="fs33">val groundPlane : Scene1</div>
<div class="tip" id="fs34">val viewPolygon : (&#39;a -&gt; Scene1)</div>
<div class="tip" id="fs35">val p : &#39;a</div>
<div class="tip" id="fs36">val edge : obj</div>
<div class="tip" id="fs37">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs38">val toSeq : list:&#39;T list -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.List.toSeq</div>
<div class="tip" id="fs39">val v : obj</div>
<div class="tip" id="fs40">val openPolygon : Scene1 list</div>
<div class="tip" id="fs41">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs42">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs43">val v : OpenPolygon</div>
<div class="tip" id="fs44">val cursor : Scene1 list</div>
<div class="tip" id="fs45">val isSome : option:&#39;T option -&gt; bool<br /><br />Full name: Microsoft.FSharp.Core.Option.isSome</div>
<div class="tip" id="fs46">val polygons : Scene1 list</div>
<div class="tip" id="fs47">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs48">type DrawCommand =<br />&#160;&#160;| ClosePolygon<br />&#160;&#160;| AddPoint of obj<br />&#160;&#160;| MoveCursor of obj<br /><br />Full name: Elmish.DrawCommand</div>
<div class="tip" id="fs49">union case DrawCommand.ClosePolygon: DrawCommand</div>
<div class="tip" id="fs50">union case DrawCommand.AddPoint: obj -&gt; DrawCommand</div>
<div class="tip" id="fs51">union case DrawCommand.MoveCursor: obj -&gt; DrawCommand</div>
<div class="tip" id="fs52">val updateDrawing : m:DrawingModel -&gt; cmd:DrawCommand -&gt; DrawingModel<br /><br />Full name: Elmish.updateDrawing</div>
<div class="tip" id="fs53">val cmd : DrawCommand</div>
<div class="tip" id="fs54">val p : obj</div>
<div class="tip" id="fs55">val p : OpenPolygon</div>
<div class="tip" id="fs56">val groundPlane : Scene1<br /><br />Full name: Elmish.groundPlane</div>
<div class="tip" id="fs57">namespace Aardvark.Application</div>
<div class="tip" id="fs58">type MouseEvent =<br />&#160;&#160;| Move of obj<br />&#160;&#160;| Down of obj * obj<br /><br />Full name: Elmish.MouseEvent</div>
<div class="tip" id="fs59">union case MouseEvent.Move: obj -&gt; MouseEvent</div>
<div class="tip" id="fs60">union case MouseEvent.Down: obj * obj -&gt; MouseEvent</div>
<div class="tip" id="fs61">type PickOperation&lt;&#39;msg&gt; = MouseEvent -&gt; Option&lt;&#39;msg&gt;<br /><br />Full name: Elmish.PickOperation&lt;_&gt;</div>
<div class="tip" id="fs62">type Scene&lt;&#39;msg&gt; =<br />&#160;&#160;| Transform of obj * seq&lt;Scene&lt;&#39;msg&gt;&gt;<br />&#160;&#160;| Colored of obj * seq&lt;Scene&lt;&#39;msg&gt;&gt;<br />&#160;&#160;| Render of PickOperation&lt;&#39;msg&gt; list * Primitive<br />&#160;&#160;| Group of seq&lt;Scene&lt;&#39;msg&gt;&gt;<br /><br />Full name: Elmish.Scene&lt;_&gt;</div>
<div class="tip" id="fs63">union case Scene.Transform: obj * seq&lt;Scene&lt;&#39;msg&gt;&gt; -&gt; Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs64">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs65">union case Scene.Colored: obj * seq&lt;Scene&lt;&#39;msg&gt;&gt; -&gt; Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs66">union case Scene.Render: PickOperation&lt;&#39;msg&gt; list * Primitive -&gt; Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs67">union case Scene.Group: seq&lt;Scene&lt;&#39;msg&gt;&gt; -&gt; Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs68">val transform : t:&#39;a -&gt; xs:seq&lt;Scene&lt;&#39;b&gt;&gt; -&gt; Scene&lt;&#39;b&gt;<br /><br />Full name: Elmish.transform</div>
<div class="tip" id="fs69">val xs : seq&lt;Scene&lt;&#39;a&gt;&gt;</div>
<div class="tip" id="fs70">val transform&#39; : t:&#39;a -&gt; x:Scene&lt;&#39;b&gt; -&gt; Scene&lt;&#39;b&gt;<br /><br />Full name: Elmish.transform&#39;</div>
<div class="tip" id="fs71">val x : Scene&lt;&#39;a&gt;</div>
<div class="tip" id="fs72">val translate : x:&#39;a -&gt; y:&#39;b -&gt; z:&#39;c -&gt; xs:seq&lt;Scene&lt;&#39;d&gt;&gt; -&gt; Scene&lt;&#39;d&gt;<br /><br />Full name: Elmish.translate</div>
<div class="tip" id="fs73">val x : &#39;a</div>
<div class="tip" id="fs74">val y : &#39;a</div>
<div class="tip" id="fs75">val z : &#39;a</div>
<div class="tip" id="fs76">val colored : c:&#39;a -&gt; xs:seq&lt;Scene&lt;&#39;b&gt;&gt; -&gt; Scene&lt;&#39;b&gt;<br /><br />Full name: Elmish.colored</div>
<div class="tip" id="fs77">val render : picks:PickOperation&lt;&#39;a&gt; list -&gt; primitive:Primitive -&gt; Scene&lt;&#39;a&gt;<br /><br />Full name: Elmish.render</div>
<div class="tip" id="fs78">val picks : PickOperation&lt;&#39;a&gt; list</div>
<div class="tip" id="fs79">val primitive : Primitive</div>
<div class="tip" id="fs80">val group : xs:seq&lt;Scene&lt;&#39;a&gt;&gt; -&gt; Scene&lt;&#39;a&gt;<br /><br />Full name: Elmish.group</div>
<div class="tip" id="fs81">val drawGroundPlane : Scene&lt;DrawCommand&gt;<br /><br />Full name: Elmish.drawGroundPlane</div>
<div class="tip" id="fs82">val evt : MouseEvent</div>
<div class="tip" id="fs83">Multiple items<br />module Event<br /><br />from Microsoft.FSharp.Control<br /><br />--------------------<br />type Event&lt;&#39;T&gt; =<br />&#160;&#160;new : unit -&gt; Event&lt;&#39;T&gt;<br />&#160;&#160;member Trigger : arg:&#39;T -&gt; unit<br />&#160;&#160;member Publish : IEvent&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Event&lt;_&gt;<br /><br />--------------------<br />type Event&lt;&#39;Delegate,&#39;Args (requires delegate and &#39;Delegate :&gt; Delegate)&gt; =<br />&#160;&#160;new : unit -&gt; Event&lt;&#39;Delegate,&#39;Args&gt;<br />&#160;&#160;member Trigger : sender:obj * args:&#39;Args -&gt; unit<br />&#160;&#160;member Publish : IEvent&lt;&#39;Delegate,&#39;Args&gt;<br /><br />Full name: Microsoft.FSharp.Control.Event&lt;_,_&gt;<br /><br />--------------------<br />new : unit -&gt; Event&lt;&#39;T&gt;<br /><br />--------------------<br />new : unit -&gt; Event&lt;&#39;Delegate,&#39;Args&gt;</div>
<div class="tip" id="fs84">val move : _arg1:MouseEvent -&gt; bool<br /><br />Full name: Elmish.Event.move</div>
<div class="tip" id="fs85">type bool = Boolean<br /><br />Full name: Microsoft.FSharp.Core.bool</div>
<div class="tip" id="fs86">val down : _arg1:MouseEvent -&gt; bool<br /><br />Full name: Elmish.Event.down</div>
<div class="tip" id="fs87">val down&#39; : p:obj -&gt; _arg1:MouseEvent -&gt; bool<br /><br />Full name: Elmish.Event.down&#39;</div>
<div class="tip" id="fs88">val p&#39; : obj</div>
<div class="tip" id="fs89">val leftDown : (MouseEvent -&gt; bool)<br /><br />Full name: Elmish.Event.leftDown</div>
<div class="tip" id="fs90">val rightDown : (MouseEvent -&gt; bool)<br /><br />Full name: Elmish.Event.rightDown</div>
<div class="tip" id="fs91">val position : _arg1:MouseEvent -&gt; obj<br /><br />Full name: Elmish.Event.position</div>
<div class="tip" id="fs92">val s : obj</div>
<div class="tip" id="fs93">val on : p:(MouseEvent -&gt; bool) -&gt; r:(obj -&gt; &#39;msg) -&gt; k:MouseEvent -&gt; &#39;msg option<br /><br />Full name: Elmish.on</div>
<div class="tip" id="fs94">val p : (MouseEvent -&gt; bool)</div>
<div class="tip" id="fs95">val r : (obj -&gt; &#39;msg)</div>
<div class="tip" id="fs96">val k : MouseEvent</div>
<div class="tip" id="fs97">Multiple items<br />module Event<br /><br />from Elmish<br /><br />--------------------<br />module Event<br /><br />from Microsoft.FSharp.Control<br /><br />--------------------<br />type Event&lt;&#39;T&gt; =<br />&#160;&#160;new : unit -&gt; Event&lt;&#39;T&gt;<br />&#160;&#160;member Trigger : arg:&#39;T -&gt; unit<br />&#160;&#160;member Publish : IEvent&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Event&lt;_&gt;<br /><br />--------------------<br />type Event&lt;&#39;Delegate,&#39;Args (requires delegate and &#39;Delegate :&gt; Delegate)&gt; =<br />&#160;&#160;new : unit -&gt; Event&lt;&#39;Delegate,&#39;Args&gt;<br />&#160;&#160;member Trigger : sender:obj * args:&#39;Args -&gt; unit<br />&#160;&#160;member Publish : IEvent&lt;&#39;Delegate,&#39;Args&gt;<br /><br />Full name: Microsoft.FSharp.Control.Event&lt;_,_&gt;<br /><br />--------------------<br />new : unit -&gt; Event&lt;&#39;T&gt;<br /><br />--------------------<br />new : unit -&gt; Event&lt;&#39;Delegate,&#39;Args&gt;</div>
<div class="tip" id="fs98">val drawGroundPlane2 : Scene&lt;DrawCommand&gt;<br /><br />Full name: Elmish.drawGroundPlane2</div>
<div class="tip" id="fs99">val drawGroundPlane3 : Scene&lt;DrawCommand&gt;<br /><br />Full name: Elmish.drawGroundPlane3</div>
<div class="tip" id="fs100">type App&lt;&#39;model,&#39;msg,&#39;view&gt; =<br />&#160;&#160;{initial: &#39;model;<br />&#160;&#160;&#160;update: &#39;model -&gt; &#39;msg -&gt; &#39;model;<br />&#160;&#160;&#160;view: &#39;model -&gt; &#39;view;}<br /><br />Full name: Elmish.App&lt;_,_,_&gt;</div>
<div class="tip" id="fs101">App.initial: &#39;model</div>
<div class="tip" id="fs102">App.update: &#39;model -&gt; &#39;msg -&gt; &#39;model</div>
<div class="tip" id="fs103">App.view: &#39;model -&gt; &#39;view</div>
<div class="tip" id="fs104">type ThreeDApp&lt;&#39;model,&#39;msg&gt; = App&lt;&#39;model,&#39;msg,Scene&lt;&#39;msg&gt;&gt;<br /><br />Full name: Elmish.ThreeDApp&lt;_,_&gt;</div>
<div class="tip" id="fs105">val ignore : &#39;a list<br /><br />Full name: Elmish.Pick.ignore</div>
<div class="tip" id="fs106">val viewDrawing : m:DrawingModel -&gt; Scene&lt;DrawCommand&gt;<br /><br />Full name: Elmish.viewDrawing</div>
<div class="tip" id="fs107">val viewPolygon : (&#39;a -&gt; Scene&lt;&#39;b&gt;)</div>
<div class="tip" id="fs108">module Pick<br /><br />from Elmish</div>
<div class="tip" id="fs109">val p : Polygon</div>
<div class="tip" id="fs110">val drawingApp : App&lt;DrawingModel,DrawCommand,Scene&lt;DrawCommand&gt;&gt;<br /><br />Full name: Elmish.drawingApp</div>
<div class="tip" id="fs111">Multiple items<br />type AutoOpenAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; AutoOpenAttribute<br />&#160;&#160;new : path:string -&gt; AutoOpenAttribute<br />&#160;&#160;member Path : string<br /><br />Full name: Microsoft.FSharp.Core.AutoOpenAttribute<br /><br />--------------------<br />new : unit -&gt; AutoOpenAttribute<br />new : path:string -&gt; AutoOpenAttribute</div>
<div class="tip" id="fs112">namespace Aardvark.SceneGraph</div>
<div class="tip" id="fs113">type State =<br />&#160;&#160;{trafo: obj;<br />&#160;&#160;&#160;color: obj;}<br /><br />Full name: Elmish.ConvertToSceneGraph.State</div>
<div class="tip" id="fs114">State.trafo: obj</div>
<div class="tip" id="fs115">State.color: obj</div>
<div class="tip" id="fs116">val toSg : scene:Scene&lt;&#39;msg&gt; -&gt; &#39;a<br /><br />Full name: Elmish.ConvertToSceneGraph.toSg</div>
<div class="tip" id="fs117">val scene : Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs118">val toSg : (State -&gt; Scene&lt;&#39;msg&gt; -&gt; &#39;a)</div>
<div class="tip" id="fs119">val s : State</div>
<div class="tip" id="fs120">val t : obj</div>
<div class="tip" id="fs121">val children : seq&lt;Scene&lt;&#39;msg&gt;&gt;</div>
<div class="tip" id="fs122">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs123">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs124">val c : obj</div>
<div class="tip" id="fs125">val center : obj</div>
<div class="tip" id="fs126">val dir : obj</div>
<div class="tip" id="fs127">val height : float</div>
<div class="tip" id="fs128">val radius : float</div>
<div class="tip" id="fs129">val toArray : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs130">type Array =<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CopyTo : array:Array * index:int -&gt; unit + 1 overload<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator<br />&#160;&#160;member GetLength : dimension:int -&gt; int<br />&#160;&#160;member GetLongLength : dimension:int -&gt; int64<br />&#160;&#160;member GetLowerBound : dimension:int -&gt; int<br />&#160;&#160;member GetUpperBound : dimension:int -&gt; int<br />&#160;&#160;member GetValue : [&lt;ParamArray&gt;] indices:int[] -&gt; obj + 7 overloads<br />&#160;&#160;member Initialize : unit -&gt; unit<br />&#160;&#160;member IsFixedSize : bool<br />&#160;&#160;...<br /><br />Full name: System.Array</div>
<div class="tip" id="fs131">val replicate : count:int -&gt; initial:&#39;T -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Array.replicate</div>
<div class="tip" id="fs132">val xs : seq&lt;Scene&lt;&#39;msg&gt;&gt;</div>
<div class="tip" id="fs133">val hitPrimitive : p:Primitive -&gt; trafo:&#39;a -&gt; ray:&#39;b -&gt; action:&#39;c -&gt; (&#39;d * &#39;c) list<br /><br />Full name: Elmish.Picking.hitPrimitive</div>
<div class="tip" id="fs134">val p : Primitive</div>
<div class="tip" id="fs135">val trafo : &#39;a</div>
<div class="tip" id="fs136">val ray : &#39;a</div>
<div class="tip" id="fs137">val action : &#39;a</div>
<div class="tip" id="fs138">val mutable ha : obj</div>
<div class="tip" id="fs139">val transformed : obj</div>
<div class="tip" id="fs140">type Double =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Equals : obj:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member GetTypeCode : unit -&gt; TypeCode<br />&#160;&#160;&#160;&#160;member ToString : unit -&gt; string + 3 overloads<br />&#160;&#160;&#160;&#160;static val MinValue : float<br />&#160;&#160;&#160;&#160;static val MaxValue : float<br />&#160;&#160;&#160;&#160;static val Epsilon : float<br />&#160;&#160;&#160;&#160;static val NegativeInfinity : float<br />&#160;&#160;&#160;&#160;static val PositiveInfinity : float<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.Double</div>
<div class="tip" id="fs141">field float.PositiveInfinity = Infinity</div>
<div class="tip" id="fs142">val cylinder : obj</div>
<div class="tip" id="fs143">field float.MaxValue = 1.79769313486e+308</div>
<div class="tip" id="fs144">val q : obj</div>
<div class="tip" id="fs145">val pick : r:&#39;a -&gt; s:Scene&lt;&#39;msg&gt; -&gt; (&#39;b * PickOperation&lt;&#39;msg&gt; list) list (requires comparison)<br /><br />Full name: Elmish.Picking.pick</div>
<div class="tip" id="fs146">val r : &#39;a</div>
<div class="tip" id="fs147">val s : Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs148">val go : (State -&gt; Scene&lt;&#39;a&gt; -&gt; (&#39;b * PickOperation&lt;&#39;a&gt; list) list)</div>
<div class="tip" id="fs149">val state : State</div>
<div class="tip" id="fs150">val s : Scene&lt;&#39;a&gt;</div>
<div class="tip" id="fs151">val toList : source:seq&lt;&#39;T&gt; -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs152">val collect : mapping:(&#39;T -&gt; &#39;U list) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.collect</div>
<div class="tip" id="fs153">val action : PickOperation&lt;&#39;a&gt; list</div>
<div class="tip" id="fs154">val xs : (&#39;a * PickOperation&lt;&#39;msg&gt; list) list (requires comparison)</div>
<div class="tip" id="fs155">val filter : predicate:(&#39;T -&gt; bool) -&gt; list:&#39;T list -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.filter</div>
<div class="tip" id="fs156">val not : value:bool -&gt; bool<br /><br />Full name: Microsoft.FSharp.Core.Operators.not</div>
<div class="tip" id="fs157">val isEmpty : list:&#39;T list -&gt; bool<br /><br />Full name: Microsoft.FSharp.Collections.List.isEmpty</div>
<div class="tip" id="fs158">val snd : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T2<br /><br />Full name: Microsoft.FSharp.Core.Operators.snd</div>
<div class="tip" id="fs159">val sortBy : projection:(&#39;T -&gt; &#39;Key) -&gt; list:&#39;T list -&gt; &#39;T list (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.List.sortBy</div>
<div class="tip" id="fs160">val fst : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T1<br /><br />Full name: Microsoft.FSharp.Core.Operators.fst</div>
<div class="tip" id="fs161">namespace Aardvark.Base.Incremental</div>
<div class="tip" id="fs162">val createApp : ctrl:&#39;a -&gt; camera:&#39;b -&gt; app:App&lt;&#39;model,&#39;msg,Scene&lt;&#39;msg&gt;&gt; -&gt; &#39;c<br /><br />Full name: Elmish.createApp</div>
<div class="tip" id="fs163">val ctrl : &#39;a</div>
<div class="tip" id="fs164">val camera : &#39;a</div>
<div class="tip" id="fs165">val app : App&lt;&#39;model,&#39;msg,Scene&lt;&#39;msg&gt;&gt;</div>
<div class="tip" id="fs166">val mutable model : &#39;model</div>
<div class="tip" id="fs167">val view : &#39;a</div>
<div class="tip" id="fs168">App.view: &#39;model -&gt; Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs169">val sceneGraph : &#39;a</div>
<div class="tip" id="fs170">module ConvertToSceneGraph<br /><br />from Elmish</div>
<div class="tip" id="fs171">val updateScene : (&#39;model -&gt; &#39;a)</div>
<div class="tip" id="fs172">val m : &#39;model</div>
<div class="tip" id="fs173">val newView : Scene&lt;&#39;msg&gt;</div>
<div class="tip" id="fs174">val handleMouseEvent : ((&#39;a -&gt; MouseEvent) -&gt; &#39;b)</div>
<div class="tip" id="fs175">val createEvent : (&#39;a -&gt; MouseEvent)</div>
<div class="tip" id="fs176">module Picking<br /><br />from Elmish</div>
<div class="tip" id="fs177">val d : &#39;a (requires comparison)</div>
<div class="tip" id="fs178">val f : PickOperation&lt;&#39;msg&gt; list</div>
<div class="tip" id="fs179">val msg : PickOperation&lt;&#39;msg&gt;</div>
<div class="tip" id="fs180">val r : &#39;msg</div>
<div class="tip" id="fs181">namespace Aardvark.Base.Rendering</div>
<div class="tip" id="fs182">namespace Aardvark.Application.WinForms</div>
<div class="tip" id="fs183">val app : &#39;a<br /><br />Full name: Elmish.app</div>
<div class="tip" id="fs184">val win : &#39;a<br /><br />Full name: Elmish.win</div>
<div class="tip" id="fs185">val frustum : &#39;a<br /><br />Full name: Elmish.frustum</div>
<div class="tip" id="fs186">val cameraView : &#39;a<br /><br />Full name: Elmish.cameraView</div>
<div class="tip" id="fs187">val camera : &#39;a<br /><br />Full name: Elmish.camera</div>
<div class="tip" id="fs188">val sg : &#39;a<br /><br />Full name: Elmish.sg</div>
<div class="tip" id="fs189">namespace System.Runtime</div>
<div class="tip" id="fs190">val cursorGeometry : hasCursor:&#39;a -&gt; &#39;b<br /><br />Full name: Elmish.cursorGeometry</div>
<div class="tip" id="fs191">val hasCursor : &#39;a</div>
<div class="tip" id="fs192">val hasCursor : &#39;a<br /><br />Full name: Elmish.hasCursor</div>
<div class="tip" id="fs193">val adaptiveScene : &#39;a<br /><br />Full name: Elmish.adaptiveScene</div>
<div class="tip" id="fs194">val sceneWithDisabledCursor : &#39;a<br /><br />Full name: Elmish.sceneWithDisabledCursor</div>
<div class="tip" id="fs195">val sceneWithCursor : &#39;a<br /><br />Full name: Elmish.sceneWithCursor</div>
<div class="tip" id="fs196">type ImmutableData1 =<br />&#160;&#160;{value: int;}<br /><br />Full name: Elmish.ImmutableData1</div>
<div class="tip" id="fs197">ImmutableData1.value: int</div>
<div class="tip" id="fs198">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs199">type MutableData1 =<br />&#160;&#160;{mvalue: obj;}<br /><br />Full name: Elmish.MutableData1</div>
<div class="tip" id="fs200">MutableData1.mvalue: obj</div>
<div class="tip" id="fs201">namespace System.Threading</div>
<div class="tip" id="fs202">Multiple items<br />type AllowNullLiteralAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; AllowNullLiteralAttribute<br />&#160;&#160;new : value:bool -&gt; AllowNullLiteralAttribute<br />&#160;&#160;member Value : bool<br /><br />Full name: Microsoft.FSharp.Core.AllowNullLiteralAttribute<br /><br />--------------------<br />new : unit -&gt; AllowNullLiteralAttribute<br />new : value:bool -&gt; AllowNullLiteralAttribute</div>
<div class="tip" id="fs203">Multiple items<br />type Id =<br />&#160;&#160;new : unit -&gt; Id<br />&#160;&#160;override ToString : unit -&gt; string<br />&#160;&#160;static member New : Id<br /><br />Full name: Elmish.IDs.Id<br /><br />--------------------<br />new : unit -&gt; Id</div>
<div class="tip" id="fs204">val mutable current : int</div>
<div class="tip" id="fs205">val id : int</div>
<div class="tip" id="fs206">type Interlocked =<br />&#160;&#160;static member Add : location1:int * value:int -&gt; int + 1 overload<br />&#160;&#160;static member CompareExchange : location1:int * value:int * comparand:int -&gt; int + 6 overloads<br />&#160;&#160;static member Decrement : location:int -&gt; int + 1 overload<br />&#160;&#160;static member Exchange : location1:int * value:int -&gt; int + 6 overloads<br />&#160;&#160;static member Increment : location:int -&gt; int + 1 overload<br />&#160;&#160;static member Read : location:int64 -&gt; int64<br /><br />Full name: System.Threading.Interlocked</div>
<div class="tip" id="fs207">Interlocked.Increment(location: byref&lt;int64&gt;) : int64<br />Interlocked.Increment(location: byref&lt;int&gt;) : int</div>
<div class="tip" id="fs208">static member Id.New : Id<br /><br />Full name: Elmish.IDs.Id.New</div>
<div class="tip" id="fs209">val x : Id</div>
<div class="tip" id="fs210">override Id.ToString : unit -&gt; string<br /><br />Full name: Elmish.IDs.Id.ToString</div>
<div class="tip" id="fs211">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs212">type OpenPolygon2 =<br />&#160;&#160;{finishedPolys: obj;<br />&#160;&#160;&#160;cursor: obj;}<br /><br />Full name: Elmish.OpenPolygon2</div>
<div class="tip" id="fs213">OpenPolygon2.finishedPolys: obj</div>
<div class="tip" id="fs214">OpenPolygon2.cursor: obj</div>
<div class="tip" id="fs215">type DrawingModel2 =<br />&#160;&#160;{id: obj;<br />&#160;&#160;&#160;finished: obj;<br />&#160;&#160;&#160;working: Option&lt;OpenPolygon&gt;;}<br /><br />Full name: Elmish.DrawingModel2</div>
<div class="tip" id="fs216">DrawingModel2.id: obj</div>
<div class="tip" id="fs217">DrawingModel2.finished: obj</div>
<div class="tip" id="fs218">DrawingModel2.working: Option&lt;OpenPolygon&gt;</div>
<div class="tip" id="fs219">type MDrawingModel2 =<br />&#160;&#160;{original: DrawingModel2;<br />&#160;&#160;&#160;finished: obj;<br />&#160;&#160;&#160;working: obj;}<br /><br />Full name: Elmish.MDrawingModel2</div>
<div class="tip" id="fs220">MDrawingModel2.original: DrawingModel2</div>
<div class="tip" id="fs221">MDrawingModel2.finished: obj</div>
<div class="tip" id="fs222">MDrawingModel2.working: obj</div>
<div class="tip" id="fs223">val unpersist : m:DrawingModel2 -&gt; MDrawingModel2<br /><br />Full name: Elmish.unpersist</div>
<div class="tip" id="fs224">val m : DrawingModel2</div>
<div class="tip" id="fs225">val apply : m:MDrawingModel2 -&gt; newModel:DrawingModel2 -&gt; &#39;a<br /><br />Full name: Elmish.apply</div>
<div class="tip" id="fs226">val m : MDrawingModel2</div>
<div class="tip" id="fs227">val newModel : DrawingModel2</div>
<div class="tip" id="fs228">val filter : predicate:(&#39;T -&gt; bool) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.filter</div>
<div class="tip" id="fs229">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs230">type Polygon = obj<br /><br />Full name: Elmish.SimpleDrawingApp.Polygon</div>
<div class="tip" id="fs231">type OpenPolygon =<br />&#160;&#160;{cursor: obj;<br />&#160;&#160;&#160;finishedPoints: obj;}<br /><br />Full name: Elmish.SimpleDrawingApp.OpenPolygon</div>
<div class="tip" id="fs232">type Model =<br />&#160;&#160;{finished: obj;<br />&#160;&#160;&#160;working: Option&lt;OpenPolygon&gt;;}<br /><br />Full name: Elmish.SimpleDrawingApp.Model</div>
<div class="tip" id="fs233">Model.finished: obj</div>
<div class="tip" id="fs234">Model.working: Option&lt;OpenPolygon&gt;</div>
<div class="tip" id="fs235">type Polygon = obj<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.Polygon</div>
<div class="tip" id="fs236">type OpenPolygon =<br />&#160;&#160;{cursor: obj;<br />&#160;&#160;&#160;finishedPoints: obj;}<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.OpenPolygon</div>
<div class="tip" id="fs237">type Model =<br />&#160;&#160;{mutable _id: obj;<br />&#160;&#160;&#160;finished: obj;<br />&#160;&#160;&#160;working: Option&lt;OpenPolygon&gt;;}<br />&#160;&#160;interface obj<br />&#160;&#160;member ToMod : reuseCache:&#39;a0 -&gt; MModel<br />&#160;&#160;override Id : obj<br />&#160;&#160;override Id : &#39;a with set<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.Model</div>
<div class="tip" id="fs238">Model._id: obj</div>
<div class="tip" id="fs239">val x : Model</div>
<div class="tip" id="fs240">member Model.ToMod : reuseCache:&#39;a0 -&gt; MModel<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.Model.ToMod</div>
<div class="tip" id="fs241">val reuseCache : &#39;a</div>
<div class="tip" id="fs242">override Model.Id : obj<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.Model.Id</div>
<div class="tip" id="fs243">val set : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt; (requires comparison)<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.set</div>
<div class="tip" id="fs244">val v : &#39;a</div>
<div class="tip" id="fs245">type MModel =<br />&#160;&#160;{mutable _original: Model;<br />&#160;&#160;&#160;mfinished: obj;<br />&#160;&#160;&#160;mworking: obj;}<br />&#160;&#160;member Apply : arg0:Model * reuseCache:&#39;a0 -&gt; unit<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.MModel</div>
<div class="tip" id="fs246">MModel._original: Model</div>
<div class="tip" id="fs247">MModel.mfinished: obj</div>
<div class="tip" id="fs248">MModel.mworking: obj</div>
<div class="tip" id="fs249">val x : MModel</div>
<div class="tip" id="fs250">member MModel.Apply : arg0:Model * reuseCache:&#39;a0 -&gt; unit<br /><br />Full name: Elmish.SimpleDrawingAppGenerated.MModel.Apply</div>
<div class="tip" id="fs251">val arg0 : Model</div>
<div class="tip" id="fs252">Multiple items<br />type Object =<br />&#160;&#160;new : unit -&gt; obj<br />&#160;&#160;member Equals : obj:obj -&gt; bool<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member GetType : unit -&gt; Type<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;static member Equals : objA:obj * objB:obj -&gt; bool<br />&#160;&#160;static member ReferenceEquals : objA:obj * objB:obj -&gt; bool<br /><br />Full name: System.Object<br /><br />--------------------<br />Object() : unit</div>
<div class="tip" id="fs253">Object.ReferenceEquals(objA: obj, objB: obj) : bool</div>
<div class="tip" id="fs254">type Scene2 =<br />&#160;&#160;| Transform of obj * obj<br />&#160;&#160;| Colored of obj * obj<br />&#160;&#160;| Render of Primitive<br />&#160;&#160;| Group of obj<br /><br />Full name: Elmish.Scene2</div>
<div class="tip" id="fs255">union case Scene2.Transform: obj * obj -&gt; Scene2</div>
<div class="tip" id="fs256">union case Scene2.Colored: obj * obj -&gt; Scene2</div>
<div class="tip" id="fs257">union case Scene2.Render: Primitive -&gt; Scene2</div>
<div class="tip" id="fs258">union case Scene2.Group: obj -&gt; Scene2</div>
<div class="tip" id="fs259">type ISg&lt;&#39;msg&gt; =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit obj<br />&#160;&#160;end<br /><br />Full name: Elmish.AdaptiveScene.ISg&lt;_&gt;</div>
<div class="tip" id="fs260">Multiple items<br />type Group&lt;&#39;msg&gt; =<br />&#160;&#160;interface obj<br />&#160;&#160;interface ISg&lt;&#39;msg&gt;<br />&#160;&#160;new : xs:&#39;a -&gt; Group&lt;&#39;msg&gt;<br />&#160;&#160;member Children : &#39;a<br />&#160;&#160;override Children : &#39;a<br /><br />Full name: Elmish.AdaptiveScene.Group&lt;_&gt;<br /><br />--------------------<br />new : xs:&#39;a -&gt; Group&lt;&#39;msg&gt;</div>
<div class="tip" id="fs261">val xs : &#39;a</div>
<div class="tip" id="fs262">val x : Group&lt;&#39;msg&gt;</div>
<div class="tip" id="fs263">override Group.Children : &#39;a<br /><br />Full name: Elmish.AdaptiveScene.Group`1.Children</div>
<div class="tip" id="fs264">member Group.Children : &#39;a<br /><br />Full name: Elmish.AdaptiveScene.Group`1.Children</div>
<div class="tip" id="fs265">Multiple items<br />type Render&lt;&#39;msg&gt; =<br />&#160;&#160;interface ISg&lt;&#39;msg&gt;<br />&#160;&#160;new : xs:Primitive -&gt; Render&lt;&#39;msg&gt;<br />&#160;&#160;member Primitive : Primitive<br /><br />Full name: Elmish.AdaptiveScene.Render&lt;_&gt;<br /><br />--------------------<br />new : xs:Primitive -&gt; Render&lt;&#39;msg&gt;</div>
<div class="tip" id="fs266">val xs : Primitive</div>
<div class="tip" id="fs267">val x : Render&lt;&#39;msg&gt;</div>
<div class="tip" id="fs268">Multiple items<br />member Render.Primitive : Primitive<br /><br />Full name: Elmish.AdaptiveScene.Render`1.Primitive<br /><br />--------------------<br />type Primitive =<br />&#160;&#160;| Sphere of center: obj * radius: float<br />&#160;&#160;| Cone of center: obj * dir: obj * height: float * radius: float<br />&#160;&#160;| Cylinder of center: obj * dir: obj * height: float * radius: float<br />&#160;&#160;| Quad of obj<br /><br />Full name: Elmish.Primitive</div>
<div class="tip" id="fs269">module Ag<br /><br />from Aardvark.Base</div>
<div class="tip" id="fs270">namespace Aardvark.SceneGraph.Semantics</div>
<div class="tip" id="fs271">module AdaptiveScene<br /><br />from Elmish</div>
<div class="tip" id="fs272">Multiple items<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.ActiveSemantics<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.AttributeExtensions<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.BoundingBoxes<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.ModeSemantics<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.RenderObjectSemantics<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.SurfaceSemantics<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.TrafoExtensions<br /><br />--------------------<br />module Semantic<br /><br />from Aardvark.SceneGraph.Semantics.UniformSemantics<br /><br />--------------------<br />type Semantic =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : unit -&gt; Semantic<br /><br />Full name: Aardvark.Base.Ag.Semantic<br /><br />--------------------<br />new : unit -&gt; Semantic</div>
<div class="tip" id="fs273">Multiple items<br />type LeafSemantics =<br />&#160;&#160;new : unit -&gt; LeafSemantics<br />&#160;&#160;member RenderObjects : l:Render&lt;&#39;msg&gt; -&gt; aset&lt;IRenderObject&gt;<br /><br />Full name: Elmish.AgExtension.LeafSemantics<br /><br />--------------------<br />new : unit -&gt; LeafSemantics</div>
<div class="tip" id="fs274">val x : LeafSemantics</div>
<div class="tip" id="fs275">member LeafSemantics.RenderObjects : l:Render&lt;&#39;msg&gt; -&gt; Aardvark.Base.Incremental.aset&lt;Aardvark.Base.IRenderObject&gt;<br /><br />Full name: Elmish.AgExtension.LeafSemantics.RenderObjects</div>
<div class="tip" id="fs276">val l : Render&lt;&#39;msg&gt;</div>
<div class="tip" id="fs277">property Render.Primitive: Primitive</div>
<div class="tip" id="fs278">val renderObjects : s:Aardvark.SceneGraph.ISg -&gt; Aardvark.Base.Incremental.aset&lt;Aardvark.Base.IRenderObject&gt;<br /><br />Full name: Aardvark.SceneGraph.Semantics.RenderObjectSemantics.Semantic.renderObjects</div>
<div class="tip" id="fs279">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs280">namespace Aardvark.ImmutableSceneGraph</div>
<div class="tip" id="fs281">namespace Aardvark.Elmish</div>
<div class="tip" id="fs282">module Primitives<br /><br />from Aardvark.ImmutableSceneGraph.PickStuff</div>
<div class="tip" id="fs283">module SimpleDrawingAppGenerated<br /><br />from Elmish</div>
<div class="tip" id="fs284">Multiple items<br />type Action =<br />&#160;&#160;| ClosePolygon<br />&#160;&#160;| AddPoint of obj<br />&#160;&#160;| MoveCursor of obj<br /><br />Full name: Elmish.FinalDrawingApp.Action<br /><br />--------------------<br />type Action&lt;&#39;T&gt; =<br />&#160;&#160;delegate of &#39;T -&gt; unit<br /><br />Full name: System.Action&lt;_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 -&gt; unit<br /><br />Full name: System.Action&lt;_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13,&#39;T14&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 * &#39;T14 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13,&#39;T14,&#39;T15&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 * &#39;T14 * &#39;T15 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13,&#39;T14,&#39;T15,&#39;T16&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 * &#39;T14 * &#39;T15 * &#39;T16 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_&gt;</div>
<div class="tip" id="fs285">union case Action.ClosePolygon: Action</div>
<div class="tip" id="fs286">union case Action.AddPoint: obj -&gt; Action</div>
<div class="tip" id="fs287">union case Action.MoveCursor: obj -&gt; Action</div>
<div class="tip" id="fs288">val update : e:&#39;a -&gt; m:Model -&gt; cmd:Action -&gt; Model<br /><br />Full name: Elmish.FinalDrawingApp.update</div>
<div class="tip" id="fs289">val e : &#39;a</div>
<div class="tip" id="fs290">val m : Model</div>
<div class="tip" id="fs291">val cmd : Action</div>
<div class="tip" id="fs292">val viewPolygon : p:&#39;a -&gt; ISg&lt;&#39;b&gt;<br /><br />Full name: Elmish.FinalDrawingApp.viewPolygon</div>
<div class="tip" id="fs293">val edge : &#39;a</div>
<div class="tip" id="fs294">Multiple items<br />module List<br /><br />from Aardvark.ImmutableSceneGraph.PickStuff<br /><br />--------------------<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs295">val v : &#39;a (requires member ( - ))</div>
<div class="tip" id="fs296">val cylinder : c:Aardvark.Base.V3d -&gt; d:Aardvark.Base.V3d -&gt; h:float -&gt; r:float -&gt; Primitive<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.Primitives.cylinder</div>
<div class="tip" id="fs297">Multiple items<br />module Scene<br /><br />from Aardvark.ImmutableSceneGraph<br /><br />--------------------<br />type Scene&lt;&#39;msg&gt; =<br />&#160;&#160;| Transform of obj * seq&lt;Scene&lt;&#39;msg&gt;&gt;<br />&#160;&#160;| Colored of obj * seq&lt;Scene&lt;&#39;msg&gt;&gt;<br />&#160;&#160;| Render of PickOperation&lt;&#39;msg&gt; list * Primitive<br />&#160;&#160;| Group of seq&lt;Scene&lt;&#39;msg&gt;&gt;<br /><br />Full name: Elmish.Scene&lt;_&gt;</div>
<div class="tip" id="fs298">val render : picks:PickOperation&lt;&#39;a&gt; list -&gt; p:Primitive -&gt; ISg&lt;&#39;a&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.render</div>
<div class="tip" id="fs299">Multiple items<br />module Pick<br /><br />from Aardvark.ImmutableSceneGraph.PickStuff<br /><br />--------------------<br />module Pick<br /><br />from Aardvark.ImmutableSceneGraph<br /><br />--------------------<br />module Pick<br /><br />from Elmish</div>
<div class="tip" id="fs300">Multiple items<br />val ignore : &#39;a list<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.Pick.ignore<br /><br />--------------------<br />val ignore : &#39;a list<br /><br />Full name: Elmish.Pick.ignore</div>
<div class="tip" id="fs301">val group : xs:ISg&lt;&#39;msg&gt; list -&gt; ISg&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.group</div>
<div class="tip" id="fs302">val view : m:MModel -&gt; ISg&lt;&#39;a&gt;<br /><br />Full name: Elmish.FinalDrawingApp.view</div>
<div class="tip" id="fs303">val m : MModel</div>
<div class="tip" id="fs304">val t : &#39;a (requires &#39;a :&gt; Aardvark.Base.Incremental.aset&lt;ISg&lt;&#39;b&gt;&gt;)</div>
<div class="tip" id="fs305">union case Primitive.Quad: Aardvark.Base.Quad3d -&gt; Primitive</div>
<div class="tip" id="fs306">val on : p:(PickOccurance -&gt; bool) -&gt; r:(Aardvark.Base.V3d -&gt; &#39;msg) -&gt; PickOperation&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.on</div>
<div class="tip" id="fs307">Multiple items<br />union case Sub.Mouse: (Direction -&gt; Aardvark.Application.MouseButtons -&gt; Aardvark.Base.PixelPosition -&gt; Option&lt;&#39;msg&gt;) -&gt; Sub&lt;&#39;msg&gt;<br /><br />--------------------<br />module Mouse<br /><br />from Aardvark.ImmutableSceneGraph.PickStuff</div>
<div class="tip" id="fs308">val move : p:PickOccurance -&gt; bool<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.Mouse.move</div>
<div class="tip" id="fs309">val down&#39; : button:Aardvark.Application.MouseButtons -&gt; p:PickOccurance -&gt; bool<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.Mouse.down&#39;</div>
<div class="tip" id="fs310">val colored : c:Aardvark.Base.Incremental.IMod&lt;Aardvark.Base.C4b&gt; -&gt; xs:ISg&lt;&#39;msg&gt; list -&gt; ISg&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.colored</div>
<div class="tip" id="fs311">union case Primitive.Sphere: Aardvark.Base.Sphere3d -&gt; Primitive</div>
<div class="tip" id="fs312">val transform&#39; : t:Aardvark.Base.Incremental.IMod&lt;Aardvark.Base.Trafo3d&gt; -&gt; x:ISg&lt;&#39;msg&gt; -&gt; ISg&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.transform&#39;</div>
<div class="tip" id="fs313">val agroup : xs:Aardvark.Base.Incremental.aset&lt;ISg&lt;&#39;msg&gt;&gt; -&gt; ISg&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.agroup</div>
<div class="tip" id="fs314">val viewScene : sizes:&#39;a -&gt; m:MModel -&gt; ISg&lt;&#39;b&gt;<br /><br />Full name: Elmish.FinalDrawingApp.viewScene</div>
<div class="tip" id="fs315">val sizes : &#39;a</div>
<div class="tip" id="fs316">val cameraView : &#39;a</div>
<div class="tip" id="fs317">val frustum : &#39;a</div>
<div class="tip" id="fs318">val camera : camera:Aardvark.Base.Incremental.IMod&lt;Aardvark.Base.Camera&gt; -&gt; xs:ISg&lt;&#39;a&gt; -&gt; ISg&lt;&#39;a&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.camera</div>
<div class="tip" id="fs319">val effect : effects:seq&lt;Aardvark.Base.Rendering.FShadeEffect&gt; -&gt; xs:ISg&lt;&#39;a&gt; -&gt; ISg&lt;&#39;a&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.effect</div>
<div class="tip" id="fs320">val initial : Model<br /><br />Full name: Elmish.FinalDrawingApp.initial</div>
<div class="tip" id="fs321">val app : s:&#39;a -&gt; App&lt;Model,MModel,Action,ISg&lt;&#39;b&gt;&gt;<br /><br />Full name: Elmish.FinalDrawingApp.app</div>
<div class="tip" id="fs322">val s : &#39;a</div>
<div class="tip" id="fs323">module Subscriptions<br /><br />from Aardvark.Elmish</div>
<div class="tip" id="fs324">val none : &#39;a -&gt; Sub&lt;&#39;b&gt;<br /><br />Full name: Aardvark.Elmish.Subscriptions.none</div>
<div class="tip" id="fs325">type Sub&lt;&#39;msg&gt; =<br />&#160;&#160;| TimeSub of TimeSpan * (TimeSpan -&gt; &#39;msg)<br />&#160;&#160;| KeyPress of (obj -&gt; Option&lt;&#39;msg&gt;)<br />&#160;&#160;| Many of Sub&lt;&#39;msg&gt; list<br /><br />Full name: Elmish.Subscriptions1.Sub&lt;_&gt;</div>
<div class="tip" id="fs326">union case Sub.TimeSub: TimeSpan * (TimeSpan -&gt; &#39;msg) -&gt; Sub&lt;&#39;msg&gt;</div>
<div class="tip" id="fs327">Multiple items<br />type TimeSpan =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; TimeSpan + 3 overloads<br />&#160;&#160;&#160;&#160;member Add : ts:TimeSpan -&gt; TimeSpan<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Days : int<br />&#160;&#160;&#160;&#160;member Duration : unit -&gt; TimeSpan<br />&#160;&#160;&#160;&#160;member Equals : value:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member Hours : int<br />&#160;&#160;&#160;&#160;member Milliseconds : int<br />&#160;&#160;&#160;&#160;member Minutes : int<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.TimeSpan<br /><br />--------------------<br />TimeSpan()<br />TimeSpan(ticks: int64) : unit<br />TimeSpan(hours: int, minutes: int, seconds: int) : unit<br />TimeSpan(days: int, hours: int, minutes: int, seconds: int) : unit<br />TimeSpan(days: int, hours: int, minutes: int, seconds: int, milliseconds: int) : unit</div>
<div class="tip" id="fs328">union case Sub.KeyPress: (obj -&gt; Option&lt;&#39;msg&gt;) -&gt; Sub&lt;&#39;msg&gt;</div>
<div class="tip" id="fs329">union case Sub.Many: Sub&lt;&#39;msg&gt; list -&gt; Sub&lt;&#39;msg&gt;</div>
<div class="tip" id="fs330">val timeSub : ts:TimeSpan -&gt; f:(TimeSpan -&gt; &#39;a) -&gt; Sub&lt;&#39;a&gt;<br /><br />Full name: Elmish.Subscriptions1.timeSub</div>
<div class="tip" id="fs331">val ts : TimeSpan</div>
<div class="tip" id="fs332">val f : (TimeSpan -&gt; &#39;a)</div>
<div class="tip" id="fs333">type Model =<br />&#160;&#160;{rotation: float;<br />&#160;&#160;&#160;_id: obj;}<br /><br />Full name: Elmish.Animation.Model</div>
<div class="tip" id="fs334">Model.rotation: float</div>
<div class="tip" id="fs335">type MModel =<br />&#160;&#160;{mrotation: obj;}<br /><br />Full name: Elmish.Animation.MModel</div>
<div class="tip" id="fs336">MModel.mrotation: obj</div>
<div class="tip" id="fs337">type Msg = | TimeStep of TimeSpan<br /><br />Full name: Elmish.Animation.Msg</div>
<div class="tip" id="fs338">union case Msg.TimeStep: TimeSpan -&gt; Msg</div>
<div class="tip" id="fs339">val update : e:&#39;a -&gt; m:Model -&gt; msg:Msg -&gt; Model<br /><br />Full name: Elmish.Animation.update</div>
<div class="tip" id="fs340">val msg : Msg</div>
<div class="tip" id="fs341">val t : TimeSpan</div>
<div class="tip" id="fs342">property TimeSpan.TotalMilliseconds: float</div>
<div class="tip" id="fs343">val view : m:MModel -&gt; ISg&lt;&#39;a&gt;<br /><br />Full name: Elmish.Animation.view</div>
<div class="tip" id="fs344">val transform : t:Aardvark.Base.Incremental.IMod&lt;Aardvark.Base.Trafo3d&gt; -&gt; xs:ISg&lt;&#39;msg&gt; list -&gt; ISg&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.transform</div>
<div class="tip" id="fs345">val subscriptions : m:Model -&gt; Subscriptions1.Sub&lt;Msg&gt;<br /><br />Full name: Elmish.Animation.subscriptions</div>
<div class="tip" id="fs346">module Subscriptions1<br /><br />from Elmish</div>
<div class="tip" id="fs347">val timeSub : ts:TimeSpan -&gt; f:(TimeSpan -&gt; &#39;a) -&gt; Subscriptions1.Sub&lt;&#39;a&gt;<br /><br />Full name: Elmish.Subscriptions1.timeSub</div>
<div class="tip" id="fs348">TimeSpan.FromMilliseconds(value: float) : TimeSpan</div>
<div class="tip" id="fs349">type Transparency =<br />&#160;&#160;| Solid<br />&#160;&#160;| PickThrough<br /><br />Full name: Elmish.Transparency</div>
<div class="tip" id="fs350">union case Transparency.Solid: Transparency</div>
<div class="tip" id="fs351">union case Transparency.PickThrough: Transparency</div>
<div class="tip" id="fs352">type PickOperation2&lt;&#39;msg&gt; = (obj -&gt; Option&lt;&#39;msg&gt;) * Transparency<br /><br />Full name: Elmish.PickOperation2&lt;_&gt;</div>
<div class="tip" id="fs353">val depthTest : xs:(float * PickOperation2&lt;&#39;msg&gt;) list -&gt; (float * ((&#39;a -&gt; Option&lt;&#39;msg&gt;) * Transparency)) list<br /><br />Full name: Elmish.depthTest</div>
<div class="tip" id="fs354">val xs : (float * PickOperation2&lt;&#39;msg&gt;) list</div>
<div class="tip" id="fs355">val d1 : float</div>
<div class="tip" id="fs356">val f1 : (obj -&gt; Option&lt;&#39;msg&gt;)</div>
<div class="tip" id="fs357">val d2 : float</div>
<div class="tip" id="fs358">val f2 : (obj -&gt; Option&lt;&#39;msg&gt;)</div>
<div class="tip" id="fs359">val rest : (float * PickOperation2&lt;&#39;msg&gt;) list</div>
<div class="tip" id="fs360">val d : float</div>
<div class="tip" id="fs361">val f : (obj -&gt; Option&lt;&#39;msg&gt;)</div>
<div class="tip" id="fs362">namespace Fablish</div>
<div class="tip" id="fs363">module CommonTypes<br /><br />from Fablish</div>
<div class="tip" id="fs364">type Model =<br />&#160;&#160;{image: obj;}<br /><br />Full name: Elmish.EnvExample.Model</div>
<div class="tip" id="fs365">Model.image: obj</div>
<div class="tip" id="fs366">type Msg =<br />&#160;&#160;| LoadImages of string list<br />&#160;&#160;| ImagesLoaded of obj<br />&#160;&#160;| Progress of float<br /><br />Full name: Elmish.EnvExample.Msg</div>
<div class="tip" id="fs367">union case Msg.LoadImages: string list -&gt; Msg</div>
<div class="tip" id="fs368">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs369">union case Msg.ImagesLoaded: obj -&gt; Msg</div>
<div class="tip" id="fs370">union case Msg.Progress: float -&gt; Msg</div>
<div class="tip" id="fs371">val loadImage : p:string list -&gt; e:Env&lt;Msg&gt; -&gt; Async&lt;Msg&gt;<br /><br />Full name: Elmish.EnvExample.loadImage</div>
<div class="tip" id="fs372">val p : string list</div>
<div class="tip" id="fs373">val e : Env&lt;Msg&gt;</div>
<div class="tip" id="fs374">Multiple items<br />module Env<br /><br />from Fablish.CommonTypes<br /><br />--------------------<br />type Env&lt;&#39;msg&gt; =<br />&#160;&#160;{run: Cmd&lt;&#39;msg&gt; -&gt; unit;}<br /><br />Full name: Fablish.CommonTypes.Env&lt;_&gt;</div>
<div class="tip" id="fs375">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs376">val cnt : int</div>
<div class="tip" id="fs377">val length : list:&#39;T list -&gt; int<br /><br />Full name: Microsoft.FSharp.Collections.List.length</div>
<div class="tip" id="fs378">val images : &#39;a list</div>
<div class="tip" id="fs379">val mapi : mapping:(int -&gt; &#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.mapi</div>
<div class="tip" id="fs380">val i : int</div>
<div class="tip" id="fs381">val p : string</div>
<div class="tip" id="fs382">Multiple items<br />union case Cmd.Cmd: Async&lt;&#39;msg&gt; -&gt; Cmd&lt;&#39;msg&gt;<br /><br />--------------------<br />module Cmd<br /><br />from Fablish.CommonTypes<br /><br />--------------------<br />type Cmd&lt;&#39;msg&gt; =<br />&#160;&#160;| NoCmd<br />&#160;&#160;| Cmd of Async&lt;&#39;msg&gt;<br /><br />Full name: Fablish.CommonTypes.Cmd&lt;_&gt;</div>
<div class="tip" id="fs383">Env.run: Cmd&lt;Msg&gt; -&gt; unit</div>
<div class="tip" id="fs384">val update : env:Env&lt;Msg&gt; -&gt; m:Model -&gt; msg:Msg -&gt; Model<br /><br />Full name: Elmish.EnvExample.update</div>
<div class="tip" id="fs385">val env : Env&lt;Msg&gt;</div>
<div class="tip" id="fs386">val paths : string list</div>
<div class="tip" id="fs387">val img : obj</div>
<div class="tip" id="fs388">module TranslateController<br /><br />from Elmish</div>
<div class="tip" id="fs389">module Scene<br /><br />from Aardvark.ImmutableSceneGraph</div>
<div class="tip" id="fs390">namespace Scratch</div>
<div class="tip" id="fs391">namespace Scratch.DomainTypes</div>
<div class="tip" id="fs392">Multiple items<br />type CompilationRepresentationAttribute =<br />&#160;&#160;inherit Attribute<br />&#160;&#160;new : flags:CompilationRepresentationFlags -&gt; CompilationRepresentationAttribute<br />&#160;&#160;member Flags : CompilationRepresentationFlags<br /><br />Full name: Microsoft.FSharp.Core.CompilationRepresentationAttribute<br /><br />--------------------<br />new : flags:CompilationRepresentationFlags -&gt; CompilationRepresentationAttribute</div>
<div class="tip" id="fs393">type CompilationRepresentationFlags =<br />&#160;&#160;|  None  =  0<br />&#160;&#160;|  Static  =  1<br />&#160;&#160;|  Instance  =  2<br />&#160;&#160;|  ModuleSuffix  =  4<br />&#160;&#160;|  UseNullAsTrueValue  =  8<br />&#160;&#160;|  Event  =  16<br /><br />Full name: Microsoft.FSharp.Core.CompilationRepresentationFlags</div>
<div class="tip" id="fs394">CompilationRepresentationFlags.ModuleSuffix: CompilationRepresentationFlags = 4</div>
<div class="tip" id="fs395">type Axis =<br />&#160;&#160;| X<br />&#160;&#160;| Y<br />&#160;&#160;| Z<br /><br />Full name: Scratch.DomainTypes.Generated.Axis</div>
<div class="tip" id="fs396">val dir : _arg1:Axis -&gt; &#39;a<br /><br />Full name: Elmish.TranslateController.AxisModule.dir</div>
<div class="tip" id="fs397">union case Axis.X: Axis</div>
<div class="tip" id="fs398">union case Axis.Y: Axis</div>
<div class="tip" id="fs399">union case Axis.Z: Axis</div>
<div class="tip" id="fs400">val moveAxis : trafo:&#39;a -&gt; _arg1:Axis -&gt; &#39;b<br /><br />Full name: Elmish.TranslateController.AxisModule.moveAxis</div>
<div class="tip" id="fs401">Multiple items<br />type Action =<br />&#160;&#160;| Hover of Axis * obj<br />&#160;&#160;| NoHit<br />&#160;&#160;| MoveRay of obj<br />&#160;&#160;| Translate of Axis * obj<br />&#160;&#160;| EndTranslation<br />&#160;&#160;| ResetTrafo<br /><br />Full name: Elmish.TranslateController.Action<br /><br />--------------------<br />type Action&lt;&#39;T&gt; =<br />&#160;&#160;delegate of &#39;T -&gt; unit<br /><br />Full name: System.Action&lt;_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 -&gt; unit<br /><br />Full name: System.Action&lt;_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13,&#39;T14&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 * &#39;T14 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13,&#39;T14,&#39;T15&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 * &#39;T14 * &#39;T15 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_,_,_&gt;<br /><br />--------------------<br />type Action&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4,&#39;T5,&#39;T6,&#39;T7,&#39;T8,&#39;T9,&#39;T10,&#39;T11,&#39;T12,&#39;T13,&#39;T14,&#39;T15,&#39;T16&gt; =<br />&#160;&#160;delegate of &#39;T1 * &#39;T2 * &#39;T3 * &#39;T4 * &#39;T5 * &#39;T6 * &#39;T7 * &#39;T8 * &#39;T9 * &#39;T10 * &#39;T11 * &#39;T12 * &#39;T13 * &#39;T14 * &#39;T15 * &#39;T16 -&gt; unit<br /><br />Full name: System.Action&lt;_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_&gt;</div>
<div class="tip" id="fs402">union case Action.Hover: Axis * obj -&gt; Action</div>
<div class="tip" id="fs403">Multiple items<br />module Axis<br /><br />from Elmish.TranslateController<br /><br />--------------------<br />type Axis =<br />&#160;&#160;| X<br />&#160;&#160;| Y<br />&#160;&#160;| Z<br /><br />Full name: Scratch.DomainTypes.Generated.Axis</div>
<div class="tip" id="fs404">union case Action.NoHit: Action</div>
<div class="tip" id="fs405">union case Action.MoveRay: obj -&gt; Action</div>
<div class="tip" id="fs406">union case Action.Translate: Axis * obj -&gt; Action</div>
<div class="tip" id="fs407">union case Action.EndTranslation: Action</div>
<div class="tip" id="fs408">union case Action.ResetTrafo: Action</div>
<div class="tip" id="fs409">Multiple items<br />module TranslateController<br /><br />from Scratch.DomainTypes.Generated<br /><br />--------------------<br />module TranslateController<br /><br />from Scratch.DomainTypes</div>
<div class="tip" id="fs410">val hasEnded : a:Action -&gt; bool<br /><br />Full name: Elmish.TranslateController.hasEnded</div>
<div class="tip" id="fs411">val a : Action</div>
<div class="tip" id="fs412">val hover : (Axis -&gt; Aardvark.Base.V3d -&gt; &#39;a)<br /><br />Full name: Elmish.TranslateController.hover</div>
<div class="tip" id="fs413">val translate_ : (Axis -&gt; Aardvark.Base.V3d -&gt; &#39;a)<br /><br />Full name: Elmish.TranslateController.translate_</div>
<div class="tip" id="fs414">val initalModel : TModel<br /><br />Full name: Elmish.TranslateController.initalModel</div>
<div class="tip" id="fs415">val initial : Scene<br /><br />Full name: Elmish.TranslateController.initial</div>
<div class="tip" id="fs416">Multiple items<br />module Camera<br /><br />from Scratch.DomainTypes.Generated<br /><br />--------------------<br />module Camera<br /><br />from Scratch.DomainTypes</div>
<div class="tip" id="fs417">val updateModel : m:TModel -&gt; a:Action -&gt; TModel<br /><br />Full name: Elmish.TranslateController.updateModel</div>
<div class="tip" id="fs418">val m : TModel</div>
<div class="tip" id="fs419">type TModel =<br />&#160;&#160;{mutable _id: Id;<br />&#160;&#160;&#160;hovered: Option&lt;Axis&gt;;<br />&#160;&#160;&#160;activeTranslation: Option&lt;Axis * Plane3d * V3d&gt;;<br />&#160;&#160;&#160;trafo: Trafo3d;<br />&#160;&#160;&#160;editTrafo: Trafo3d;}<br />&#160;&#160;interface IUnique<br />&#160;&#160;member ToMod : reuseCache:ReuseCache -&gt; MTModel<br /><br />Full name: Scratch.DomainTypes.Generated.TranslateController.TModel</div>
<div class="tip" id="fs420">TModel.activeTranslation: Option&lt;Axis * Aardvark.Base.Plane3d * Aardvark.Base.V3d&gt;</div>
<div class="tip" id="fs421">val v : Axis</div>
<div class="tip" id="fs422">val dir : Axis</div>
<div class="tip" id="fs423">TModel.trafo: Aardvark.Base.Trafo3d</div>
<div class="tip" id="fs424">field Aardvark.Base.Trafo3d.Backward</div>
<div class="tip" id="fs425">Aardvark.Base.M44d.TransformPos(p: Aardvark.Base.V3d) : Aardvark.Base.V3d</div>
<div class="tip" id="fs426">val update : e:&#39;a -&gt; m:Scene -&gt; a:Action -&gt; Scene<br /><br />Full name: Elmish.TranslateController.update</div>
<div class="tip" id="fs427">val m : Scene</div>
<div class="tip" id="fs428">Multiple items<br />module Scene<br /><br />from Aardvark.ImmutableSceneGraph<br /><br />--------------------<br />type Scene =<br />&#160;&#160;{mutable _id: Id;<br />&#160;&#160;&#160;camera: Camera;<br />&#160;&#160;&#160;scene: TModel;}<br />&#160;&#160;interface IUnique<br />&#160;&#160;member ToMod : reuseCache:ReuseCache -&gt; MScene<br /><br />Full name: Scratch.DomainTypes.Generated.TranslateController.Scene<br /><br />--------------------<br />type Scene&lt;&#39;msg&gt; =<br />&#160;&#160;| Transform of obj * seq&lt;Scene&lt;&#39;msg&gt;&gt;<br />&#160;&#160;| Colored of obj * seq&lt;Scene&lt;&#39;msg&gt;&gt;<br />&#160;&#160;| Render of PickOperation&lt;&#39;msg&gt; list * Primitive<br />&#160;&#160;| Group of seq&lt;Scene&lt;&#39;msg&gt;&gt;<br /><br />Full name: Elmish.Scene&lt;_&gt;</div>
<div class="tip" id="fs429">val scene : TModel</div>
<div class="tip" id="fs430">Scene.scene: TModel</div>
<div class="tip" id="fs431">val viewModel : m:MTModel -&gt; ISg&lt;&#39;a&gt;<br /><br />Full name: Elmish.TranslateController.viewModel</div>
<div class="tip" id="fs432">val m : MTModel</div>
<div class="tip" id="fs433">type MTModel =<br />&#160;&#160;{mutable _original: TModel;<br />&#160;&#160;&#160;mhovered: ModRef&lt;Option&lt;Axis&gt;&gt;;<br />&#160;&#160;&#160;mactiveTranslation: ModRef&lt;Option&lt;Axis * Plane3d * V3d&gt;&gt;;<br />&#160;&#160;&#160;mtrafo: ModRef&lt;Trafo3d&gt;;<br />&#160;&#160;&#160;meditTrafo: ModRef&lt;Trafo3d&gt;;}<br />&#160;&#160;member Apply : arg0:TModel * reuseCache:ReuseCache -&gt; unit<br /><br />Full name: Scratch.DomainTypes.Generated.TranslateController.MTModel</div>
<div class="tip" id="fs434">val arrow : (Aardvark.Base.V3d -&gt; Primitive)</div>
<div class="tip" id="fs435">val dir : Aardvark.Base.V3d</div>
<div class="tip" id="fs436">union case Primitive.Cone: center: Aardvark.Base.V3d * dir: Aardvark.Base.V3d * height: float * radius: float -&gt; Primitive</div>
<div class="tip" id="fs437">val ifHit : (Axis -&gt; &#39;a -&gt; &#39;b -&gt; &#39;c)</div>
<div class="tip" id="fs438">val a : Axis</div>
<div class="tip" id="fs439">val selection : &#39;a</div>
<div class="tip" id="fs440">val defaultColor : &#39;a</div>
<div class="tip" id="fs441">MTModel.mhovered: Aardvark.Base.Incremental.ModRef&lt;Option&lt;Axis&gt;&gt;</div>
<div class="tip" id="fs442">MTModel.mtrafo: Aardvark.Base.Incremental.ModRef&lt;Aardvark.Base.Trafo3d&gt;</div>
<div class="tip" id="fs443">val translate : x:float -&gt; y:float -&gt; z:float -&gt; xs:ISg&lt;&#39;msg&gt; list -&gt; ISg&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.translate</div>
<div class="tip" id="fs444">val down : p:PickOccurance -&gt; bool<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.Mouse.down</div>
<div class="tip" id="fs445">union case Primitive.Everything: Primitive</div>
<div class="tip" id="fs446">val whenever : p:(PickOccurance -&gt; bool) -&gt; r:(Aardvark.Base.Ray3d -&gt; &#39;msg) -&gt; PickOperation&lt;&#39;msg&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.whenever</div>
<div class="tip" id="fs447">val viewScene : sizes:&#39;a -&gt; s:MScene -&gt; ISg&lt;&#39;b&gt;<br /><br />Full name: Elmish.TranslateController.viewScene</div>
<div class="tip" id="fs448">val s : MScene</div>
<div class="tip" id="fs449">val map : f:(&#39;a -&gt; &#39;b) -&gt; a:ISg&lt;&#39;a&gt; -&gt; ISg&lt;&#39;b&gt;<br /><br />Full name: Aardvark.ImmutableSceneGraph.Scene.map</div>
<div class="tip" id="fs450">MScene.mscene: MTModel</div>
<div class="tip" id="fs451">val ofPickMsgModel : model:TModel -&gt; pick:GlobalPick -&gt; Action list<br /><br />Full name: Elmish.TranslateController.ofPickMsgModel</div>
<div class="tip" id="fs452">val model : TModel</div>
<div class="tip" id="fs453">val pick : GlobalPick</div>
<div class="tip" id="fs454">type GlobalPick =<br />&#160;&#160;{mouseEvent: MouseEvent;<br />&#160;&#160;&#160;hits: bool;<br />&#160;&#160;&#160;keyEvent: KeyEvent;}<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.GlobalPick</div>
<div class="tip" id="fs455">GlobalPick.mouseEvent: MouseEvent</div>
<div class="tip" id="fs456">type MouseEvent =<br />&#160;&#160;| Down of MouseButtons<br />&#160;&#160;| Move<br />&#160;&#160;| Click of MouseButtons<br />&#160;&#160;| Up of MouseButtons<br />&#160;&#160;| NoEvent<br /><br />Full name: Aardvark.ImmutableSceneGraph.PickStuff.MouseEvent</div>
<div class="tip" id="fs457">union case MouseEvent.Click: Aardvark.Application.MouseButtons -&gt; MouseEvent</div>
<div class="tip" id="fs458">Multiple items<br />union case MouseEvent.Down: Aardvark.Application.MouseButtons -&gt; MouseEvent<br /><br />--------------------<br />union case MouseEvent.Down: obj * obj -&gt; MouseEvent</div>
<div class="tip" id="fs459">Multiple items<br />union case MouseEvent.Move: MouseEvent<br /><br />--------------------<br />union case MouseEvent.Move: obj -&gt; MouseEvent</div>
<div class="tip" id="fs460">val isNone : option:&#39;T option -&gt; bool<br /><br />Full name: Microsoft.FSharp.Core.Option.isNone</div>
<div class="tip" id="fs461">union case MouseEvent.Up: Aardvark.Application.MouseButtons -&gt; MouseEvent</div>
<div class="tip" id="fs462">union case MouseEvent.NoEvent: MouseEvent</div>
<div class="tip" id="fs463">val ofPickMsg : model:Scene -&gt; noPick:GlobalPick -&gt; Action list<br /><br />Full name: Elmish.TranslateController.ofPickMsg</div>
<div class="tip" id="fs464">val model : Scene</div>
<div class="tip" id="fs465">val noPick : GlobalPick</div>
<div class="tip" id="fs466">val app : sizes:&#39;a -&gt; App&lt;Scene,MScene,Action,ISg&lt;&#39;b&gt;&gt;<br /><br />Full name: Elmish.TranslateController.app</div>

            </div>
            <div class="span1"></div>
        </div>
    </div>
</body>
</html>